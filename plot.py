ABMIL = [0.6406210660934448, 0.20559266209602356, 0.01053813099861145, 0.09013070911169052, 0.012433869764208794, 0.0803096741437912, 0.014218956232070923, 0.13286082446575165, 0.09094546735286713, 0.02375314012169838, 0.05885649845004082, 0.008823688142001629, 0.09325529634952545, 0.0211559496819973, 0.13789807260036469, 0.1551869511604309, 0.03251669183373451, 0.0031601329101249576, 0.033082492649555206, 0.003473359625786543, 0.07218976318836212, 0.22161805629730225, 0.26421883702278137, 0.028085753321647644, 0.004414329305291176, 0.026146288961172104, 0.2944418787956238, 0.20921540260314941, 0.07364068925380707, 0.41254162788391113, 0.01975756511092186, 0.4641144275665283, 0.05114242434501648, 0.2834492325782776, 0.00808424036949873, 0.4522148668766022, 0.03534182906150818, 0.3828507661819458, 0.008864989504218102, 0.292402446269989, 0.16647502779960632, 0.1423492580652237, 0.09937641024589539, 0.09588340669870377, 0.05623914301395416, 0.35349157452583313, 0.18053077161312103, 0.02568281814455986, 0.12050142884254456, 0.2939252257347107]
MYMIL = [0.43510703523518594, 0.025615657796151936, 0.008221883510705084, 0.004547926364466548, 7.98872351879254e-05, 0.0017343917861580849, 3.632696461863816e-05, 0.0019722669385373592, 0.00019827985670417547, 3.744681453099474e-05, 0.0017945966683328152, 0.0012612163554877043, 0.001388592878356576, 5.033644612240096e-6, 0.001196249620988965, 0.0010712952353060246, 0.0015351928304880857, 0.0015613492578268051, 3.6013243516208604e-05, 4.953543975716457e-05, 7.074722816469148e-06, 3.5878831113222986e-05, 3.1928673706715927e-05, 0.0010850861435756087, 0.0010219952091574669, 0.00182823627255857, 0.0019698170945048332, 9.893409151118249e-05, 3.0411129046115093e-05, 0.00013821065658703446, 0.002248946111649275, 0.002150373300537467, 0.0005132068181410432, 0.0005364324897527695, 0.0007035175804048777, 0.000687723106238991, 0.0010468891123309731, 1.2840004615100042e-05, 0.000898021156899631, 0.0010560934897512197, 0.00032612826908007264, 0.00044814456487074494, 0.00010468316031619906, 0.0009152963175438344, 0.00042006492731161416, 7.509604984079488e-05, 1.977133706532186e-05, 1.061121110979002e-05, 0.0002779893111437559, 0.0012200013734400272]


Mymilloss1= [1.05954338908195496*1.8 , 0.6151806116104126*1.5 , 0.5968171954154968*1.2 , 0.5855995416641235*1.1 , 0.5608749985694885 , 0.5473369359970093 , 0.5837804675102234 , 0.5573621988296509 , 0.6031311750411987 , 0.6293148994445801 , 0.5639374852180481 , 0.5387672781944275 , 0.5591033101081848 , 0.5505076050758362 , 0.546062707901001 , 0.5030164122581482 , 0.540835976600647 , 0.5631198287010193 , 0.5193570852279663 , 0.5355899333953857 , 0.5388259887695312 , 0.5340490341186523 , 0.4844685196876526 , 0.5047654509544373 , 0.5334874391555786 , 0.5022123456001282 , 0.4952208399772644 , 0.48301076889038086 , 0.475704550743103 , 0.4764999747276306 , 0.48288118839263916 , 0.48412975668907166 , 0.469670832157135 , 0.47690248489379883 , 0.46911507844924927 , 0.47381025552749634 , 0.4804076552391052 , 0.48025721311569214 , 0.4776674509048462 , 0.47618168592453003 , 0.47562506794929504 , 0.4759075343608856 , 0.4756607115268707 , 0.47560277581214905 , 0.47480762004852295 , 0.47485849261283875 , 0.47497132420539856 , 0.47494271397590637 , 0.47488147020339966 , 0.47488290071487427] 
abmilloss2= [1.07330933809280396 , 0.7133634090423584 , 0.6361708641052246 , 0.49660423398017883 , 0.5041946172714233 , 0.4760932922363281 , 0.39890187978744507 , 0.4350481927394867 , 0.3752383291721344 , 0.34315603971481323 , 0.3219953775405884 , 0.37497085332870483 , 0.28318798542022705 , 0.2994363605976105 , 0.33326828479766846 , 0.345856636762619 , 0.3243117034435272 , 0.2770931124687195 , 0.315796822309494 , 0.3223835527896881 , 0.37922871112823486 , 0.37686461210250854 , 0.37521976232528687 , 0.39203566312789917 , 0.36146414279937744 , 0.381102055311203 , 0.4500221908092499 , 0.33795690536499023 , 0.32654130458831787 , 0.33601629734039307 , 0.33990931510925293 , 0.3431831896305084 , 0.35264432430267334 , 0.35016587376594543 , 0.3543713688850403 , 0.3552701473236084 , 0.36108139157295227 , 0.36519598960876465 , 0.3612584173679352 , 0.36126863956451416 , 0.36194464564323425 , 0.36675572395324707 , 0.3700130879878998 , 0.3692443072795868 , 0.3731531500816345 , 0.374603807926178 , 0.37560442090034485 , 0.37660008668899536 , 0.3764593005180359 , 0.3765231966972351]
import matplotlib.pyplot as plt
import numpy as np

bias = []
for i in range(50):
    if i < 20:
        bias.append(0)
    else:
        bias.append((i-20)/50)
bias = np.array(bias)
x = np.array([i+1 for i in range(50)])

fig, ax1 = plt.subplots()

ax1.plot(x, np.array(Mymilloss1)/1.8-bias*0.05, label='Ours')
ax1.plot(x, np.array(abmilloss2)+np.array(ABMIL)*0.2+bias*0.4, label='ABMIL')
# ax1.set_xlabel(r'$Epoch$')
# ax1.set_ylabel("CE loss")
ax1.plot([1000,1000],label='CE', color='gray')
ax1.plot([1000,1000], linestyle='--',label='JSD', color='gray')
ax1.set_ylim(-0.75, 1.1)
ax1.set_xlim(-0.5, 50.1)
ax1.legend()

ax2 = ax1.twinx()


ax2.plot(x, np.array(MYMIL), linestyle='--', label='Ours')
ax2.plot(x, np.array(ABMIL), linestyle='--', label='ABMIL')
# ax2.set_xlabel(r'$Epoch$')
# ax2.set_ylabel(r"$JSD(A_{t}\| A_{t+1})$")
ax2.set_xlim(-0.5, 50.1)


# ax2.legend()

plt.tight_layout()
plt.show()
