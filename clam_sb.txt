Wandb run dir: /fs2/comm/kpgrp/yelinfen/Documents/ACMIL/wandb/offline-run-20250806_232758-c8q062q1/files
Used config:
{'B': 1,
 'D_feat': 512,
 'D_inner': 256,
 'arch': 'clam_sb',
 'augment_epoch': 1,
 'backbone': 'Resnet18',
 'config': 'config/patch_classification_camelyon17_config.yml',
 'data_dir': './Features/CAM17_res18',
 'dataset': 'camelyon17',
 'heatmap_arguments': {'alpha': 0.4,
                       'binarize': False,
                       'blank_canvas': False,
                       'blur': True,
                       'cmap': 'jet',
                       'custom_downsample': 1,
                       'vis_level': -1},
 'load_head_checkpoints': False,
 'lr': 0.0001,
 'min_lr': 0,
 'n_class': 4,
 'n_shot': -1,
 'n_token': 4,
 'n_worker': 8,
 'optim': 'sgd',
 'pin_memory': False,
 'pretrain': 'natural_supervsied',
 'seed': 5,
 'start_epoch': 0,
 'train_epoch': 50,
 'w_loss': 1.0,
 'wandb_mode': 'offline',
 'warmup_epoch': 5,
 'wd': 0.0005}
get dataset
Epoch: [0]  [  0/269]  eta: 0:04:42  lr: 0.000000  bag_loss: 2.0408 (2.0408)  instance_loss: 1.1297 (1.1297)  time: 1.0506  data: 0.4155  max mem: 88
Epoch: [0]  [100/269]  eta: 0:00:04  lr: 0.000007  bag_loss: 1.5611 (1.5891)  instance_loss: 1.2793 (1.3641)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [0]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.6874 (1.3846)  instance_loss: 1.3703 (1.3876)  time: 0.0152  data: 0.0016  max mem: 337
Epoch: [0]  [268/269]  eta: 0:00:00  lr: 0.000020  bag_loss: 0.5244 (1.2896)  instance_loss: 1.4212 (1.4006)  time: 0.0142  data: 0.0012  max mem: 337
Epoch: [0] Total time: 0:00:05 (5.2906 s / it)
Val  [ 0/30]  eta: 0:00:14  loss: 0.3923 (0.3923)  acc1: 100.0000 (100.0000)  time: 0.4925  data: 0.4476  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4292 (0.8534)  acc1: 100.0000 (73.3333)  time: 0.0102  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.8773 s / it)
* Acc@1 73.333 loss 0.853 auroc 0.701 f1_score 0.212
Test  [  0/200]  eta: 0:01:31  loss: 1.9171 (1.9171)  acc1: 0.0000 (0.0000)  time: 0.4551  data: 0.4466  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4859 (1.1123)  acc1: 100.0000 (59.4059)  time: 0.0074  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5514 (1.0779)  acc1: 100.0000 (60.5000)  time: 0.0119  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.5363 s / it)
* Acc@1 60.500 loss 1.078 auroc 0.550 f1_score 0.188


Epoch: [1]  [  0/269]  eta: 0:02:34  lr: 0.000020  bag_loss: 0.5400 (0.5400)  instance_loss: 1.5285 (1.5285)  time: 0.5749  data: 0.5395  max mem: 337
Epoch: [1]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.5600 (1.0040)  instance_loss: 1.4202 (1.5052)  time: 0.0166  data: 0.0012  max mem: 337
Epoch: [1]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.4729 (1.0115)  instance_loss: 1.3555 (1.4769)  time: 0.0129  data: 0.0010  max mem: 337
Epoch: [1]  [268/269]  eta: 0:00:00  lr: 0.000040  bag_loss: 0.5602 (1.0369)  instance_loss: 1.3314 (1.4654)  time: 0.0134  data: 0.0010  max mem: 337
Epoch: [1] Total time: 0:00:04 (4.7531 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.5193 (0.5193)  acc1: 100.0000 (100.0000)  time: 0.5350  data: 0.5222  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5063 (0.8556)  acc1: 100.0000 (73.3333)  time: 0.0100  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9546 s / it)
* Acc@1 73.333 loss 0.856 auroc 0.684 f1_score 0.212
Test  [  0/200]  eta: 0:01:43  loss: 1.4550 (1.4550)  acc1: 0.0000 (0.0000)  time: 0.5194  data: 0.5075  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5655 (1.1265)  acc1: 100.0000 (59.4059)  time: 0.0071  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5673 (1.0973)  acc1: 100.0000 (60.5000)  time: 0.0110  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.4311 s / it)
* Acc@1 60.500 loss 1.097 auroc 0.580 f1_score 0.188


Epoch: [2]  [  0/269]  eta: 0:02:20  lr: 0.000040  bag_loss: 0.5860 (0.5860)  instance_loss: 1.2733 (1.2733)  time: 0.5222  data: 0.5082  max mem: 337
Epoch: [2]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.2876 (0.9401)  instance_loss: 1.3984 (1.4373)  time: 0.0149  data: 0.0011  max mem: 337
Epoch: [2]  [200/269]  eta: 0:00:01  lr: 0.000055  bag_loss: 1.5218 (1.0187)  instance_loss: 1.4241 (1.4530)  time: 0.0140  data: 0.0013  max mem: 337
Epoch: [2]  [268/269]  eta: 0:00:00  lr: 0.000060  bag_loss: 1.8610 (1.0327)  instance_loss: 1.4700 (1.4387)  time: 0.0145  data: 0.0010  max mem: 337
Epoch: [2] Total time: 0:00:04 (4.6188 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.5201 (0.5201)  acc1: 100.0000 (100.0000)  time: 0.5332  data: 0.5222  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4165 (0.8338)  acc1: 100.0000 (73.3333)  time: 0.0097  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9453 s / it)
* Acc@1 73.333 loss 0.834 auroc 0.706 f1_score 0.212
Test  [  0/200]  eta: 0:01:42  loss: 1.5565 (1.5565)  acc1: 0.0000 (0.0000)  time: 0.5101  data: 0.5013  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5380 (1.1128)  acc1: 100.0000 (59.4059)  time: 0.0071  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.4865 (1.0735)  acc1: 100.0000 (60.5000)  time: 0.0113  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.4479 s / it)
* Acc@1 60.500 loss 1.073 auroc 0.591 f1_score 0.188


Epoch: [3]  [  0/269]  eta: 0:02:31  lr: 0.000060  bag_loss: 0.3753 (0.3753)  instance_loss: 1.2302 (1.2302)  time: 0.5643  data: 0.5284  max mem: 337
Epoch: [3]  [100/269]  eta: 0:00:03  lr: 0.000067  bag_loss: 0.4542 (0.9073)  instance_loss: 1.1733 (1.2678)  time: 0.0138  data: 0.0013  max mem: 337
Epoch: [3]  [200/269]  eta: 0:00:01  lr: 0.000075  bag_loss: 0.4451 (0.9754)  instance_loss: 1.3559 (1.3199)  time: 0.0138  data: 0.0012  max mem: 337
Epoch: [3]  [268/269]  eta: 0:00:00  lr: 0.000080  bag_loss: 0.8925 (1.0300)  instance_loss: 1.2312 (1.3190)  time: 0.0130  data: 0.0013  max mem: 337
Epoch: [3] Total time: 0:00:04 (4.6094 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8946 (0.8946)  acc1: 100.0000 (100.0000)  time: 0.5150  data: 0.4984  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.6875 (0.9417)  acc1: 100.0000 (73.3333)  time: 0.0100  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.9139 s / it)
* Acc@1 73.333 loss 0.942 auroc 0.728 f1_score 0.212
Test  [  0/200]  eta: 0:01:45  loss: 1.3929 (1.3929)  acc1: 0.0000 (0.0000)  time: 0.5269  data: 0.5144  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.8862 (1.1310)  acc1: 100.0000 (59.4059)  time: 0.0085  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.8479 (1.0834)  acc1: 100.0000 (60.5000)  time: 0.0112  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.4441 s / it)
* Acc@1 60.500 loss 1.083 auroc 0.641 f1_score 0.188


Epoch: [4]  [  0/269]  eta: 0:02:19  lr: 0.000080  bag_loss: 0.5954 (0.5954)  instance_loss: 1.4286 (1.4286)  time: 0.5193  data: 0.5011  max mem: 337
Epoch: [4]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.6522 (1.0712)  instance_loss: 1.1156 (1.1918)  time: 0.0160  data: 0.0013  max mem: 337
Epoch: [4]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.6277 (1.0101)  instance_loss: 1.1510 (1.1877)  time: 0.0138  data: 0.0010  max mem: 337
Epoch: [4]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.4943 (1.0165)  instance_loss: 1.0961 (1.1780)  time: 0.0139  data: 0.0009  max mem: 337
Epoch: [4] Total time: 0:00:04 (4.6576 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7426 (0.7426)  acc1: 100.0000 (100.0000)  time: 0.5258  data: 0.5104  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5389 (0.9452)  acc1: 100.0000 (73.3333)  time: 0.0101  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9199 s / it)
* Acc@1 73.333 loss 0.945 auroc 0.671 f1_score 0.212
Test  [  0/200]  eta: 0:01:45  loss: 2.2429 (2.2429)  acc1: 0.0000 (0.0000)  time: 0.5274  data: 0.5178  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7801 (1.1228)  acc1: 100.0000 (60.3960)  time: 0.0099  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6611 (1.0508)  acc1: 100.0000 (61.0000)  time: 0.0106  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5152 s / it)
* Acc@1 61.000 loss 1.051 auroc 0.637 f1_score 0.200


Epoch: [5]  [  0/269]  eta: 0:02:19  lr: 0.000100  bag_loss: 1.5243 (1.5243)  instance_loss: 1.0512 (1.0512)  time: 0.5196  data: 0.5052  max mem: 337
Epoch: [5]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.3065 (1.0574)  instance_loss: 1.3322 (1.1712)  time: 0.0155  data: 0.0011  max mem: 337
Epoch: [5]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.4579 (1.0315)  instance_loss: 1.2696 (1.1937)  time: 0.0164  data: 0.0010  max mem: 337
Epoch: [5]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.7772 (1.0163)  instance_loss: 1.1304 (1.1857)  time: 0.0156  data: 0.0010  max mem: 337
Epoch: [5] Total time: 0:00:04 (4.6865 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7753 (0.7753)  acc1: 100.0000 (100.0000)  time: 0.5024  data: 0.4917  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5492 (0.9064)  acc1: 100.0000 (73.3333)  time: 0.0109  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9359 s / it)
* Acc@1 73.333 loss 0.906 auroc 0.697 f1_score 0.310
Test  [  0/200]  eta: 0:01:45  loss: 1.7764 (1.7764)  acc1: 0.0000 (0.0000)  time: 0.5292  data: 0.5158  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7755 (1.0836)  acc1: 100.0000 (70.2970)  time: 0.0082  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6185 (1.0129)  acc1: 100.0000 (70.5000)  time: 0.0110  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.4671 s / it)
* Acc@1 70.500 loss 1.013 auroc 0.706 f1_score 0.352


Epoch: [6]  [  0/269]  eta: 0:02:23  lr: 0.000100  bag_loss: 0.9379 (0.9379)  instance_loss: 1.1581 (1.1581)  time: 0.5342  data: 0.5214  max mem: 337
Epoch: [6]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.3803 (0.9727)  instance_loss: 1.0987 (1.1329)  time: 0.0167  data: 0.0010  max mem: 337
Epoch: [6]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.2107 (0.9054)  instance_loss: 1.1538 (1.1599)  time: 0.0138  data: 0.0010  max mem: 337
Epoch: [6]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.6152 (0.9349)  instance_loss: 1.1400 (1.1841)  time: 0.0152  data: 0.0009  max mem: 337
Epoch: [6] Total time: 0:00:04 (4.6469 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8416 (0.8416)  acc1: 100.0000 (100.0000)  time: 0.5066  data: 0.4929  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3704 (0.8402)  acc1: 100.0000 (76.6667)  time: 0.0107  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9477 s / it)
* Acc@1 76.667 loss 0.840 auroc 0.670 f1_score 0.341
Test  [  0/200]  eta: 0:01:50  loss: 1.2313 (1.2313)  acc1: 0.0000 (0.0000)  time: 0.5548  data: 0.5467  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7825 (0.9490)  acc1: 100.0000 (66.3366)  time: 0.0088  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.4777 (0.9076)  acc1: 100.0000 (68.5000)  time: 0.0097  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5238 s / it)
* Acc@1 68.500 loss 0.908 auroc 0.733 f1_score 0.370


Epoch: [7]  [  0/269]  eta: 0:02:19  lr: 0.000100  bag_loss: 0.3426 (0.3426)  instance_loss: 1.1473 (1.1473)  time: 0.5201  data: 0.5069  max mem: 337
Epoch: [7]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.4474 (0.9173)  instance_loss: 1.2217 (1.2263)  time: 0.0157  data: 0.0012  max mem: 337
Epoch: [7]  [200/269]  eta: 0:00:01  lr: 0.000099  bag_loss: 0.2981 (0.8272)  instance_loss: 1.1228 (1.2135)  time: 0.0142  data: 0.0010  max mem: 337
Epoch: [7]  [268/269]  eta: 0:00:00  lr: 0.000099  bag_loss: 0.3556 (0.8088)  instance_loss: 1.2183 (1.2241)  time: 0.0171  data: 0.0010  max mem: 337
Epoch: [7] Total time: 0:00:04 (4.7496 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4263 (0.4263)  acc1: 100.0000 (100.0000)  time: 0.5183  data: 0.5064  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2092 (0.7697)  acc1: 100.0000 (76.6667)  time: 0.0103  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.9289 s / it)
* Acc@1 76.667 loss 0.770 auroc 0.698 f1_score 0.320
Test  [  0/200]  eta: 0:01:43  loss: 1.4667 (1.4667)  acc1: 0.0000 (0.0000)  time: 0.5199  data: 0.5073  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2932 (0.7966)  acc1: 100.0000 (76.2376)  time: 0.0087  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2008 (0.7511)  acc1: 100.0000 (78.5000)  time: 0.0115  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5231 s / it)
* Acc@1 78.500 loss 0.751 auroc 0.760 f1_score 0.431


Epoch: [8]  [  0/269]  eta: 0:02:26  lr: 0.000099  bag_loss: 0.3202 (0.3202)  instance_loss: 1.0728 (1.0728)  time: 0.5451  data: 0.5272  max mem: 337
Epoch: [8]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.2226 (0.5991)  instance_loss: 1.1991 (1.2174)  time: 0.0134  data: 0.0012  max mem: 337
Epoch: [8]  [200/269]  eta: 0:00:01  lr: 0.000098  bag_loss: 0.5096 (0.7195)  instance_loss: 1.1538 (1.2466)  time: 0.0124  data: 0.0012  max mem: 337
Epoch: [8]  [268/269]  eta: 0:00:00  lr: 0.000098  bag_loss: 0.2494 (0.7665)  instance_loss: 1.1694 (1.2381)  time: 0.0175  data: 0.0010  max mem: 337
Epoch: [8] Total time: 0:00:04 (4.6645 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.3677 (0.3677)  acc1: 100.0000 (100.0000)  time: 0.5178  data: 0.5027  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2718 (0.8780)  acc1: 100.0000 (76.6667)  time: 0.0110  data: 0.0014  max mem: 337
Val Total time: 0:00:00 (0.9577 s / it)
* Acc@1 76.667 loss 0.878 auroc 0.731 f1_score 0.320
Test  [  0/200]  eta: 0:01:49  loss: 2.5418 (2.5418)  acc1: 0.0000 (0.0000)  time: 0.5466  data: 0.5358  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2774 (0.8178)  acc1: 100.0000 (77.2277)  time: 0.0082  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2251 (0.7133)  acc1: 100.0000 (80.0000)  time: 0.0096  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.4918 s / it)
* Acc@1 80.000 loss 0.713 auroc 0.753 f1_score 0.438


Epoch: [9]  [  0/269]  eta: 0:02:15  lr: 0.000098  bag_loss: 1.5887 (1.5887)  instance_loss: 0.9746 (0.9746)  time: 0.5028  data: 0.4884  max mem: 337
Epoch: [9]  [100/269]  eta: 0:00:03  lr: 0.000098  bag_loss: 0.2662 (0.7012)  instance_loss: 1.1000 (1.1620)  time: 0.0138  data: 0.0010  max mem: 337
Epoch: [9]  [200/269]  eta: 0:00:01  lr: 0.000097  bag_loss: 0.4729 (0.7209)  instance_loss: 1.0427 (1.1689)  time: 0.0152  data: 0.0011  max mem: 337
Epoch: [9]  [268/269]  eta: 0:00:00  lr: 0.000097  bag_loss: 0.3234 (0.7443)  instance_loss: 1.1218 (1.1644)  time: 0.0161  data: 0.0011  max mem: 337
Epoch: [9] Total time: 0:00:04 (4.7220 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4146 (0.4146)  acc1: 100.0000 (100.0000)  time: 0.5171  data: 0.5055  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3071 (0.8474)  acc1: 100.0000 (70.0000)  time: 0.0104  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9190 s / it)
* Acc@1 70.000 loss 0.847 auroc 0.712 f1_score 0.280
Test  [  0/200]  eta: 0:01:49  loss: 1.6164 (1.6164)  acc1: 0.0000 (0.0000)  time: 0.5471  data: 0.5340  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3023 (0.7618)  acc1: 100.0000 (77.2277)  time: 0.0090  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2013 (0.6833)  acc1: 100.0000 (81.0000)  time: 0.0096  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.5683 s / it)
* Acc@1 81.000 loss 0.683 auroc 0.767 f1_score 0.444


Epoch: [10]  [  0/269]  eta: 0:02:21  lr: 0.000097  bag_loss: 0.1212 (0.1212)  instance_loss: 0.9991 (0.9991)  time: 0.5253  data: 0.5117  max mem: 337
Epoch: [10]  [100/269]  eta: 0:00:03  lr: 0.000097  bag_loss: 0.1540 (0.6606)  instance_loss: 1.0544 (1.1229)  time: 0.0148  data: 0.0012  max mem: 337
Epoch: [10]  [200/269]  eta: 0:00:01  lr: 0.000096  bag_loss: 0.2042 (0.7027)  instance_loss: 1.0459 (1.1120)  time: 0.0131  data: 0.0010  max mem: 337
Epoch: [10]  [268/269]  eta: 0:00:00  lr: 0.000096  bag_loss: 0.2991 (0.7070)  instance_loss: 1.0889 (1.1195)  time: 0.0144  data: 0.0011  max mem: 337
Epoch: [10] Total time: 0:00:04 (4.6967 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4894 (0.4894)  acc1: 100.0000 (100.0000)  time: 0.5161  data: 0.5056  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2915 (0.8288)  acc1: 100.0000 (73.3333)  time: 0.0086  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9122 s / it)
* Acc@1 73.333 loss 0.829 auroc 0.696 f1_score 0.298
Test  [  0/200]  eta: 0:01:47  loss: 1.5689 (1.5689)  acc1: 0.0000 (0.0000)  time: 0.5380  data: 0.5216  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3518 (0.7120)  acc1: 100.0000 (77.2277)  time: 0.0090  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2538 (0.6430)  acc1: 100.0000 (80.0000)  time: 0.0093  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.5868 s / it)
* Acc@1 80.000 loss 0.643 auroc 0.778 f1_score 0.436


Epoch: [11]  [  0/269]  eta: 0:02:20  lr: 0.000096  bag_loss: 0.4424 (0.4424)  instance_loss: 0.9280 (0.9280)  time: 0.5219  data: 0.5021  max mem: 337
Epoch: [11]  [100/269]  eta: 0:00:03  lr: 0.000095  bag_loss: 0.2074 (0.7929)  instance_loss: 1.0391 (1.0573)  time: 0.0166  data: 0.0011  max mem: 337
Epoch: [11]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.1214 (0.7238)  instance_loss: 1.1759 (1.0800)  time: 0.0141  data: 0.0011  max mem: 337
Epoch: [11]  [268/269]  eta: 0:00:00  lr: 0.000094  bag_loss: 0.2474 (0.7042)  instance_loss: 0.9680 (1.0902)  time: 0.0137  data: 0.0010  max mem: 337
Epoch: [11] Total time: 0:00:04 (4.5611 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6940 (0.6940)  acc1: 100.0000 (100.0000)  time: 0.5173  data: 0.4988  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3816 (0.8019)  acc1: 100.0000 (80.0000)  time: 0.0092  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9171 s / it)
* Acc@1 80.000 loss 0.802 auroc 0.741 f1_score 0.391
Test  [  0/200]  eta: 0:01:54  loss: 0.8070 (0.8070)  acc1: 100.0000 (100.0000)  time: 0.5712  data: 0.5631  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4577 (0.7535)  acc1: 100.0000 (77.2277)  time: 0.0080  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2362 (0.6660)  acc1: 100.0000 (81.0000)  time: 0.0097  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5043 s / it)
* Acc@1 81.000 loss 0.666 auroc 0.771 f1_score 0.521


Epoch: [12]  [  0/269]  eta: 0:02:19  lr: 0.000094  bag_loss: 1.5082 (1.5082)  instance_loss: 0.8020 (0.8020)  time: 0.5188  data: 0.4998  max mem: 337
Epoch: [12]  [100/269]  eta: 0:00:03  lr: 0.000094  bag_loss: 0.1710 (0.7004)  instance_loss: 1.0085 (1.0413)  time: 0.0171  data: 0.0011  max mem: 337
Epoch: [12]  [200/269]  eta: 0:00:01  lr: 0.000093  bag_loss: 0.1676 (0.6553)  instance_loss: 0.9888 (1.0452)  time: 0.0162  data: 0.0011  max mem: 337
Epoch: [12]  [268/269]  eta: 0:00:00  lr: 0.000092  bag_loss: 0.3906 (0.6650)  instance_loss: 0.9704 (1.0417)  time: 0.0152  data: 0.0010  max mem: 337
Epoch: [12] Total time: 0:00:04 (4.7101 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6544 (0.6544)  acc1: 100.0000 (100.0000)  time: 0.5109  data: 0.4997  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3713 (0.8362)  acc1: 100.0000 (73.3333)  time: 0.0090  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8893 s / it)
* Acc@1 73.333 loss 0.836 auroc 0.722 f1_score 0.298
Test  [  0/200]  eta: 0:01:42  loss: 1.0951 (1.0951)  acc1: 100.0000 (100.0000)  time: 0.5143  data: 0.5046  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4215 (0.7176)  acc1: 100.0000 (80.1980)  time: 0.0085  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2628 (0.6337)  acc1: 100.0000 (82.5000)  time: 0.0097  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.5260 s / it)
* Acc@1 82.500 loss 0.634 auroc 0.775 f1_score 0.522


Epoch: [13]  [  0/269]  eta: 0:02:18  lr: 0.000092  bag_loss: 0.4682 (0.4682)  instance_loss: 0.8966 (0.8966)  time: 0.5147  data: 0.4982  max mem: 337
Epoch: [13]  [100/269]  eta: 0:00:03  lr: 0.000092  bag_loss: 0.8196 (0.8052)  instance_loss: 0.9626 (1.0594)  time: 0.0135  data: 0.0010  max mem: 337
Epoch: [13]  [200/269]  eta: 0:00:01  lr: 0.000091  bag_loss: 0.2571 (0.6319)  instance_loss: 1.0389 (1.0721)  time: 0.0137  data: 0.0010  max mem: 337
Epoch: [13]  [268/269]  eta: 0:00:00  lr: 0.000090  bag_loss: 0.2291 (0.6531)  instance_loss: 1.0024 (1.0716)  time: 0.0125  data: 0.0013  max mem: 337
Epoch: [13] Total time: 0:00:04 (4.6864 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2749 (0.2749)  acc1: 100.0000 (100.0000)  time: 0.5513  data: 0.5349  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1441 (0.8733)  acc1: 100.0000 (76.6667)  time: 0.0095  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.9518 s / it)
* Acc@1 76.667 loss 0.873 auroc 0.663 f1_score 0.320
Test  [  0/200]  eta: 0:01:50  loss: 1.6159 (1.6159)  acc1: 0.0000 (0.0000)  time: 0.5533  data: 0.5389  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1809 (0.7353)  acc1: 100.0000 (75.2475)  time: 0.0084  data: 0.0014  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1517 (0.6712)  acc1: 100.0000 (78.5000)  time: 0.0097  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5653 s / it)
* Acc@1 78.500 loss 0.671 auroc 0.767 f1_score 0.434


Epoch: [14]  [  0/269]  eta: 0:02:21  lr: 0.000090  bag_loss: 0.1009 (0.1009)  instance_loss: 0.9579 (0.9579)  time: 0.5265  data: 0.5032  max mem: 337
Epoch: [14]  [100/269]  eta: 0:00:03  lr: 0.000090  bag_loss: 0.3900 (0.5632)  instance_loss: 1.0490 (1.0559)  time: 0.0154  data: 0.0011  max mem: 337
Epoch: [14]  [200/269]  eta: 0:00:01  lr: 0.000089  bag_loss: 0.2869 (0.5674)  instance_loss: 0.9643 (1.0207)  time: 0.0154  data: 0.0012  max mem: 337
Epoch: [14]  [268/269]  eta: 0:00:00  lr: 0.000088  bag_loss: 0.3030 (0.6701)  instance_loss: 0.9416 (1.0167)  time: 0.0141  data: 0.0015  max mem: 337
Epoch: [14] Total time: 0:00:04 (4.8040 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.6224 (0.6224)  acc1: 100.0000 (100.0000)  time: 0.5443  data: 0.5333  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2833 (0.8163)  acc1: 100.0000 (76.6667)  time: 0.0079  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.9881 s / it)
* Acc@1 76.667 loss 0.816 auroc 0.684 f1_score 0.320
Test  [  0/200]  eta: 0:01:41  loss: 1.1044 (1.1044)  acc1: 0.0000 (0.0000)  time: 0.5054  data: 0.4968  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3309 (0.6867)  acc1: 100.0000 (77.2277)  time: 0.0088  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2330 (0.6446)  acc1: 100.0000 (79.5000)  time: 0.0107  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5934 s / it)
* Acc@1 79.500 loss 0.645 auroc 0.773 f1_score 0.485


Epoch: [15]  [  0/269]  eta: 0:02:18  lr: 0.000088  bag_loss: 0.0825 (0.0825)  instance_loss: 0.9936 (0.9936)  time: 0.5160  data: 0.4995  max mem: 337
Epoch: [15]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.1329 (0.5934)  instance_loss: 0.8779 (0.9468)  time: 0.0157  data: 0.0011  max mem: 337
Epoch: [15]  [200/269]  eta: 0:00:01  lr: 0.000087  bag_loss: 0.2509 (0.6628)  instance_loss: 0.9195 (0.9496)  time: 0.0145  data: 0.0011  max mem: 337
Epoch: [15]  [268/269]  eta: 0:00:00  lr: 0.000086  bag_loss: 0.2563 (0.6355)  instance_loss: 0.9394 (0.9476)  time: 0.0122  data: 0.0010  max mem: 337
Epoch: [15] Total time: 0:00:04 (4.7034 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.5271 (0.5271)  acc1: 100.0000 (100.0000)  time: 0.5257  data: 0.5118  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1953 (0.7860)  acc1: 100.0000 (76.6667)  time: 0.0104  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9548 s / it)
* Acc@1 76.667 loss 0.786 auroc 0.726 f1_score 0.320
Test  [  0/200]  eta: 0:01:43  loss: 0.4796 (0.4796)  acc1: 100.0000 (100.0000)  time: 0.5200  data: 0.5126  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4096 (0.7581)  acc1: 100.0000 (71.2871)  time: 0.0085  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1509 (0.6822)  acc1: 100.0000 (76.0000)  time: 0.0112  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5612 s / it)
* Acc@1 76.000 loss 0.682 auroc 0.768 f1_score 0.500


Epoch: [16]  [  0/269]  eta: 0:02:19  lr: 0.000086  bag_loss: 0.3401 (0.3401)  instance_loss: 1.0022 (1.0022)  time: 0.5201  data: 0.5024  max mem: 337
Epoch: [16]  [100/269]  eta: 0:00:03  lr: 0.000085  bag_loss: 0.1362 (0.5802)  instance_loss: 0.9648 (0.9667)  time: 0.0139  data: 0.0010  max mem: 337
Epoch: [16]  [200/269]  eta: 0:00:01  lr: 0.000084  bag_loss: 0.3155 (0.6178)  instance_loss: 0.8321 (0.9520)  time: 0.0155  data: 0.0011  max mem: 337
Epoch: [16]  [268/269]  eta: 0:00:00  lr: 0.000083  bag_loss: 0.2666 (0.6104)  instance_loss: 0.9318 (0.9331)  time: 0.0155  data: 0.0012  max mem: 337
Epoch: [16] Total time: 0:00:04 (4.7212 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.5314 (0.5314)  acc1: 100.0000 (100.0000)  time: 0.5166  data: 0.5025  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2167 (0.8131)  acc1: 100.0000 (76.6667)  time: 0.0106  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9497 s / it)
* Acc@1 76.667 loss 0.813 auroc 0.722 f1_score 0.320
Test  [  0/200]  eta: 0:01:42  loss: 0.6623 (0.6623)  acc1: 100.0000 (100.0000)  time: 0.5113  data: 0.5034  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2262 (0.6913)  acc1: 100.0000 (78.2178)  time: 0.0084  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1638 (0.6410)  acc1: 100.0000 (80.0000)  time: 0.0113  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.5524 s / it)
* Acc@1 80.000 loss 0.641 auroc 0.780 f1_score 0.502


Epoch: [17]  [  0/269]  eta: 0:02:19  lr: 0.000083  bag_loss: 0.3257 (0.3257)  instance_loss: 1.1009 (1.1009)  time: 0.5199  data: 0.5041  max mem: 337
Epoch: [17]  [100/269]  eta: 0:00:03  lr: 0.000082  bag_loss: 0.3568 (0.6540)  instance_loss: 0.8304 (0.8947)  time: 0.0142  data: 0.0010  max mem: 337
Epoch: [17]  [200/269]  eta: 0:00:01  lr: 0.000081  bag_loss: 0.2194 (0.5984)  instance_loss: 0.8330 (0.8683)  time: 0.0148  data: 0.0010  max mem: 337
Epoch: [17]  [268/269]  eta: 0:00:00  lr: 0.000081  bag_loss: 0.2009 (0.5962)  instance_loss: 0.8670 (0.8666)  time: 0.0143  data: 0.0010  max mem: 337
Epoch: [17] Total time: 0:00:04 (4.7283 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4369 (0.4369)  acc1: 100.0000 (100.0000)  time: 0.5154  data: 0.5043  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1342 (0.8366)  acc1: 100.0000 (76.6667)  time: 0.0108  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.9494 s / it)
* Acc@1 76.667 loss 0.837 auroc 0.701 f1_score 0.320
Test  [  0/200]  eta: 0:01:44  loss: 1.1394 (1.1394)  acc1: 0.0000 (0.0000)  time: 0.5223  data: 0.5153  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1841 (0.6977)  acc1: 100.0000 (77.2277)  time: 0.0087  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1462 (0.6820)  acc1: 100.0000 (77.5000)  time: 0.0118  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.6447 s / it)
* Acc@1 77.500 loss 0.682 auroc 0.776 f1_score 0.445


Epoch: [18]  [  0/269]  eta: 0:02:19  lr: 0.000081  bag_loss: 1.7160 (1.7160)  instance_loss: 0.9473 (0.9473)  time: 0.5190  data: 0.4942  max mem: 337
Epoch: [18]  [100/269]  eta: 0:00:03  lr: 0.000080  bag_loss: 0.1245 (0.6329)  instance_loss: 0.8978 (0.8987)  time: 0.0163  data: 0.0011  max mem: 337
Epoch: [18]  [200/269]  eta: 0:00:01  lr: 0.000079  bag_loss: 0.1427 (0.6084)  instance_loss: 0.9717 (0.9182)  time: 0.0152  data: 0.0010  max mem: 337
Epoch: [18]  [268/269]  eta: 0:00:00  lr: 0.000078  bag_loss: 0.2241 (0.6035)  instance_loss: 0.8952 (0.9105)  time: 0.0133  data: 0.0010  max mem: 337
Epoch: [18] Total time: 0:00:04 (4.7258 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4428 (0.4428)  acc1: 100.0000 (100.0000)  time: 0.5184  data: 0.4993  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2112 (0.8217)  acc1: 100.0000 (76.6667)  time: 0.0100  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9184 s / it)
* Acc@1 76.667 loss 0.822 auroc 0.717 f1_score 0.320
Test  [  0/200]  eta: 0:01:41  loss: 0.7411 (0.7411)  acc1: 100.0000 (100.0000)  time: 0.5083  data: 0.5005  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2051 (0.7232)  acc1: 100.0000 (79.2079)  time: 0.0088  data: 0.0014  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1492 (0.6380)  acc1: 100.0000 (80.5000)  time: 0.0106  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5949 s / it)
* Acc@1 80.500 loss 0.638 auroc 0.781 f1_score 0.505


Epoch: [19]  [  0/269]  eta: 0:02:17  lr: 0.000078  bag_loss: 0.0531 (0.0531)  instance_loss: 0.6379 (0.6379)  time: 0.5112  data: 0.4970  max mem: 337
Epoch: [19]  [100/269]  eta: 0:00:03  lr: 0.000077  bag_loss: 0.1841 (0.5640)  instance_loss: 0.7910 (0.8820)  time: 0.0175  data: 0.0011  max mem: 337
Epoch: [19]  [200/269]  eta: 0:00:01  lr: 0.000076  bag_loss: 0.6684 (0.5863)  instance_loss: 0.8151 (0.8790)  time: 0.0129  data: 0.0010  max mem: 337
Epoch: [19]  [268/269]  eta: 0:00:00  lr: 0.000075  bag_loss: 0.6191 (0.6122)  instance_loss: 0.9571 (0.8917)  time: 0.0145  data: 0.0011  max mem: 337
Epoch: [19] Total time: 0:00:04 (4.7202 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6236 (0.6236)  acc1: 100.0000 (100.0000)  time: 0.5208  data: 0.5054  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2359 (0.8155)  acc1: 100.0000 (76.6667)  time: 0.0094  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9353 s / it)
* Acc@1 76.667 loss 0.816 auroc 0.731 f1_score 0.320
Test  [  0/200]  eta: 0:01:41  loss: 0.6464 (0.6464)  acc1: 100.0000 (100.0000)  time: 0.5082  data: 0.5007  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4178 (0.6996)  acc1: 100.0000 (75.2475)  time: 0.0083  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2420 (0.6618)  acc1: 100.0000 (77.5000)  time: 0.0111  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5780 s / it)
* Acc@1 77.500 loss 0.662 auroc 0.782 f1_score 0.545


Epoch: [20]  [  0/269]  eta: 0:02:21  lr: 0.000075  bag_loss: 0.1464 (0.1464)  instance_loss: 0.9002 (0.9002)  time: 0.5251  data: 0.5002  max mem: 337
Epoch: [20]  [100/269]  eta: 0:00:03  lr: 0.000074  bag_loss: 0.1952 (0.6566)  instance_loss: 0.9354 (0.9124)  time: 0.0163  data: 0.0011  max mem: 337
Epoch: [20]  [200/269]  eta: 0:00:01  lr: 0.000073  bag_loss: 0.1715 (0.5615)  instance_loss: 0.8337 (0.8858)  time: 0.0157  data: 0.0010  max mem: 337
Epoch: [20]  [268/269]  eta: 0:00:00  lr: 0.000072  bag_loss: 0.3627 (0.5811)  instance_loss: 0.9011 (0.8832)  time: 0.0127  data: 0.0010  max mem: 337
Epoch: [20] Total time: 0:00:04 (4.6669 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6517 (0.6517)  acc1: 100.0000 (100.0000)  time: 0.5090  data: 0.4986  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1973 (0.8194)  acc1: 100.0000 (76.6667)  time: 0.0102  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9404 s / it)
* Acc@1 76.667 loss 0.819 auroc 0.707 f1_score 0.320
Test  [  0/200]  eta: 0:01:43  loss: 0.4421 (0.4421)  acc1: 100.0000 (100.0000)  time: 0.5155  data: 0.5080  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3509 (0.7318)  acc1: 100.0000 (75.2475)  time: 0.0084  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1901 (0.6653)  acc1: 100.0000 (78.0000)  time: 0.0113  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5975 s / it)
* Acc@1 78.000 loss 0.665 auroc 0.783 f1_score 0.529


Epoch: [21]  [  0/269]  eta: 0:02:17  lr: 0.000072  bag_loss: 0.6675 (0.6675)  instance_loss: 0.7444 (0.7444)  time: 0.5124  data: 0.4975  max mem: 337
Epoch: [21]  [100/269]  eta: 0:00:03  lr: 0.000071  bag_loss: 0.1620 (0.6255)  instance_loss: 0.8092 (0.8833)  time: 0.0167  data: 0.0011  max mem: 337
Epoch: [21]  [200/269]  eta: 0:00:01  lr: 0.000070  bag_loss: 0.2216 (0.5895)  instance_loss: 0.9198 (0.8817)  time: 0.0160  data: 0.0011  max mem: 337
Epoch: [21]  [268/269]  eta: 0:00:00  lr: 0.000069  bag_loss: 0.4125 (0.5879)  instance_loss: 0.9545 (0.9001)  time: 0.0115  data: 0.0010  max mem: 337
Epoch: [21] Total time: 0:00:04 (4.6676 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6467 (0.6467)  acc1: 100.0000 (100.0000)  time: 0.5311  data: 0.5200  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3005 (0.8125)  acc1: 100.0000 (76.6667)  time: 0.0096  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9247 s / it)
* Acc@1 76.667 loss 0.812 auroc 0.745 f1_score 0.320
Test  [  0/200]  eta: 0:01:44  loss: 0.7439 (0.7439)  acc1: 100.0000 (100.0000)  time: 0.5207  data: 0.5127  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4979 (0.7655)  acc1: 100.0000 (70.2970)  time: 0.0089  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1754 (0.6553)  acc1: 100.0000 (77.0000)  time: 0.0107  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5411 s / it)
* Acc@1 77.000 loss 0.655 auroc 0.780 f1_score 0.526


Epoch: [22]  [  0/269]  eta: 0:02:22  lr: 0.000069  bag_loss: 0.0651 (0.0651)  instance_loss: 0.8580 (0.8580)  time: 0.5314  data: 0.5142  max mem: 337
Epoch: [22]  [100/269]  eta: 0:00:03  lr: 0.000068  bag_loss: 0.1985 (0.5219)  instance_loss: 0.8804 (0.9033)  time: 0.0131  data: 0.0010  max mem: 337
Epoch: [22]  [200/269]  eta: 0:00:01  lr: 0.000066  bag_loss: 0.3873 (0.5607)  instance_loss: 0.9181 (0.9154)  time: 0.0124  data: 0.0009  max mem: 337
Epoch: [22]  [268/269]  eta: 0:00:00  lr: 0.000065  bag_loss: 0.1512 (0.5713)  instance_loss: 0.9108 (0.9044)  time: 0.0137  data: 0.0010  max mem: 337
Epoch: [22] Total time: 0:00:04 (4.6436 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 1.0573 (1.0573)  acc1: 0.0000 (0.0000)  time: 0.5283  data: 0.5180  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3801 (0.8412)  acc1: 100.0000 (70.0000)  time: 0.0095  data: 0.0011  max mem: 337
Val Total time: 0:00:00 (0.9328 s / it)
* Acc@1 70.000 loss 0.841 auroc 0.723 f1_score 0.308
Test  [  0/200]  eta: 0:01:39  loss: 0.1645 (0.1645)  acc1: 100.0000 (100.0000)  time: 0.4984  data: 0.4840  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7718 (0.8385)  acc1: 100.0000 (69.3069)  time: 0.0079  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2417 (0.7109)  acc1: 100.0000 (76.0000)  time: 0.0115  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5386 s / it)
* Acc@1 76.000 loss 0.711 auroc 0.785 f1_score 0.517


Epoch: [23]  [  0/269]  eta: 0:02:21  lr: 0.000065  bag_loss: 0.3103 (0.3103)  instance_loss: 1.0612 (1.0612)  time: 0.5269  data: 0.5103  max mem: 337
Epoch: [23]  [100/269]  eta: 0:00:03  lr: 0.000064  bag_loss: 0.1747 (0.5837)  instance_loss: 0.9134 (0.9170)  time: 0.0132  data: 0.0011  max mem: 337
Epoch: [23]  [200/269]  eta: 0:00:01  lr: 0.000063  bag_loss: 0.2661 (0.5774)  instance_loss: 0.9345 (0.9244)  time: 0.0159  data: 0.0011  max mem: 337
Epoch: [23]  [268/269]  eta: 0:00:00  lr: 0.000062  bag_loss: 0.1389 (0.5519)  instance_loss: 0.9517 (0.9356)  time: 0.0166  data: 0.0010  max mem: 337
Epoch: [23] Total time: 0:00:04 (4.6563 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6350 (0.6350)  acc1: 100.0000 (100.0000)  time: 0.5328  data: 0.5209  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1440 (0.8765)  acc1: 100.0000 (76.6667)  time: 0.0086  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8934 s / it)
* Acc@1 76.667 loss 0.876 auroc 0.685 f1_score 0.320
Test  [  0/200]  eta: 0:01:42  loss: 0.4715 (0.4715)  acc1: 100.0000 (100.0000)  time: 0.5115  data: 0.5032  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4536 (0.8969)  acc1: 100.0000 (68.3168)  time: 0.0085  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1651 (0.7431)  acc1: 100.0000 (73.5000)  time: 0.0103  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.4978 s / it)
* Acc@1 73.500 loss 0.743 auroc 0.766 f1_score 0.523


Epoch: [24]  [  0/269]  eta: 0:02:30  lr: 0.000062  bag_loss: 0.3144 (0.3144)  instance_loss: 0.9218 (0.9218)  time: 0.5586  data: 0.5391  max mem: 337
Epoch: [24]  [100/269]  eta: 0:00:03  lr: 0.000061  bag_loss: 0.1766 (0.5299)  instance_loss: 0.9437 (0.9439)  time: 0.0166  data: 0.0011  max mem: 337
Epoch: [24]  [200/269]  eta: 0:00:01  lr: 0.000060  bag_loss: 0.1510 (0.5445)  instance_loss: 0.9143 (0.9403)  time: 0.0159  data: 0.0010  max mem: 337
Epoch: [24]  [268/269]  eta: 0:00:00  lr: 0.000059  bag_loss: 0.5419 (0.5544)  instance_loss: 0.8931 (0.9425)  time: 0.0136  data: 0.0010  max mem: 337
Epoch: [24] Total time: 0:00:04 (4.7712 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6326 (0.6326)  acc1: 100.0000 (100.0000)  time: 0.5197  data: 0.5027  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2381 (0.8226)  acc1: 100.0000 (76.6667)  time: 0.0096  data: 0.0012  max mem: 337
Val Total time: 0:00:00 (0.8900 s / it)
* Acc@1 76.667 loss 0.823 auroc 0.709 f1_score 0.320
Test  [  0/200]  eta: 0:01:47  loss: 0.4059 (0.4059)  acc1: 100.0000 (100.0000)  time: 0.5365  data: 0.5254  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3413 (0.7497)  acc1: 100.0000 (76.2376)  time: 0.0089  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1513 (0.6441)  acc1: 100.0000 (80.0000)  time: 0.0105  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5521 s / it)
* Acc@1 80.000 loss 0.644 auroc 0.787 f1_score 0.528


Epoch: [25]  [  0/269]  eta: 0:02:17  lr: 0.000059  bag_loss: 0.2839 (0.2839)  instance_loss: 0.9319 (0.9319)  time: 0.5129  data: 0.4986  max mem: 337
Epoch: [25]  [100/269]  eta: 0:00:03  lr: 0.000057  bag_loss: 0.1596 (0.4994)  instance_loss: 0.9427 (0.9314)  time: 0.0165  data: 0.0011  max mem: 337
Epoch: [25]  [200/269]  eta: 0:00:01  lr: 0.000056  bag_loss: 0.1460 (0.5306)  instance_loss: 0.9403 (0.9326)  time: 0.0183  data: 0.0011  max mem: 337
Epoch: [25]  [268/269]  eta: 0:00:00  lr: 0.000055  bag_loss: 0.3151 (0.5277)  instance_loss: 0.9434 (0.9350)  time: 0.0129  data: 0.0009  max mem: 337
Epoch: [25] Total time: 0:00:04 (4.7484 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8464 (0.8464)  acc1: 0.0000 (0.0000)  time: 0.5205  data: 0.5103  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2452 (0.8503)  acc1: 100.0000 (70.0000)  time: 0.0086  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8957 s / it)
* Acc@1 70.000 loss 0.850 auroc 0.698 f1_score 0.308
Test  [  0/200]  eta: 0:01:39  loss: 0.1907 (0.1907)  acc1: 100.0000 (100.0000)  time: 0.4976  data: 0.4889  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5145 (0.8585)  acc1: 100.0000 (70.2970)  time: 0.0085  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2008 (0.7197)  acc1: 100.0000 (75.0000)  time: 0.0117  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5326 s / it)
* Acc@1 75.000 loss 0.720 auroc 0.778 f1_score 0.517


Epoch: [26]  [  0/269]  eta: 0:02:20  lr: 0.000055  bag_loss: 1.7215 (1.7215)  instance_loss: 0.9462 (0.9462)  time: 0.5234  data: 0.5105  max mem: 337
Epoch: [26]  [100/269]  eta: 0:00:03  lr: 0.000054  bag_loss: 0.3379 (0.5750)  instance_loss: 0.9428 (0.9200)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [26]  [200/269]  eta: 0:00:01  lr: 0.000053  bag_loss: 0.2793 (0.5496)  instance_loss: 0.8575 (0.9121)  time: 0.0153  data: 0.0012  max mem: 337
Epoch: [26]  [268/269]  eta: 0:00:00  lr: 0.000052  bag_loss: 0.1500 (0.5316)  instance_loss: 0.7835 (0.8966)  time: 0.0140  data: 0.0010  max mem: 337
Epoch: [26] Total time: 0:00:04 (4.6632 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4177 (0.4177)  acc1: 100.0000 (100.0000)  time: 0.5100  data: 0.4986  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1448 (0.8183)  acc1: 100.0000 (76.6667)  time: 0.0089  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8665 s / it)
* Acc@1 76.667 loss 0.818 auroc 0.716 f1_score 0.320
Test  [  0/200]  eta: 0:01:45  loss: 0.5112 (0.5112)  acc1: 100.0000 (100.0000)  time: 0.5262  data: 0.5169  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1958 (0.8023)  acc1: 100.0000 (79.2079)  time: 0.0097  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1103 (0.6683)  acc1: 100.0000 (81.0000)  time: 0.0106  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5344 s / it)
* Acc@1 81.000 loss 0.668 auroc 0.782 f1_score 0.521


Epoch: [27]  [  0/269]  eta: 0:02:24  lr: 0.000052  bag_loss: 1.8843 (1.8843)  instance_loss: 1.0743 (1.0743)  time: 0.5380  data: 0.5237  max mem: 337
Epoch: [27]  [100/269]  eta: 0:00:03  lr: 0.000050  bag_loss: 0.1436 (0.4858)  instance_loss: 0.8105 (0.8493)  time: 0.0146  data: 0.0010  max mem: 337
Epoch: [27]  [200/269]  eta: 0:00:01  lr: 0.000049  bag_loss: 0.2385 (0.4993)  instance_loss: 0.9262 (0.8658)  time: 0.0141  data: 0.0011  max mem: 337
Epoch: [27]  [268/269]  eta: 0:00:00  lr: 0.000048  bag_loss: 0.1522 (0.5278)  instance_loss: 0.8204 (0.8710)  time: 0.0146  data: 0.0011  max mem: 337
Epoch: [27] Total time: 0:00:04 (4.7829 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.5125 (0.5125)  acc1: 100.0000 (100.0000)  time: 0.5358  data: 0.5230  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2090 (0.8649)  acc1: 100.0000 (76.6667)  time: 0.0090  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9297 s / it)
* Acc@1 76.667 loss 0.865 auroc 0.700 f1_score 0.320
Test  [  0/200]  eta: 0:01:41  loss: 0.3221 (0.3221)  acc1: 100.0000 (100.0000)  time: 0.5094  data: 0.5018  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3188 (0.8530)  acc1: 100.0000 (71.2871)  time: 0.0088  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1468 (0.7013)  acc1: 100.0000 (76.0000)  time: 0.0114  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.5390 s / it)
* Acc@1 76.000 loss 0.701 auroc 0.779 f1_score 0.512


Epoch: [28]  [  0/269]  eta: 0:02:23  lr: 0.000048  bag_loss: 0.3436 (0.3436)  instance_loss: 0.8569 (0.8569)  time: 0.5342  data: 0.5085  max mem: 337
Epoch: [28]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.1041 (0.4200)  instance_loss: 0.8721 (0.9014)  time: 0.0150  data: 0.0010  max mem: 337
Epoch: [28]  [200/269]  eta: 0:00:01  lr: 0.000046  bag_loss: 0.2624 (0.5160)  instance_loss: 0.8595 (0.8966)  time: 0.0143  data: 0.0011  max mem: 337
Epoch: [28]  [268/269]  eta: 0:00:00  lr: 0.000045  bag_loss: 0.4077 (0.5070)  instance_loss: 0.7974 (0.8802)  time: 0.0149  data: 0.0011  max mem: 337
Epoch: [28] Total time: 0:00:04 (4.6406 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6086 (0.6086)  acc1: 100.0000 (100.0000)  time: 0.5127  data: 0.5019  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2405 (0.8211)  acc1: 100.0000 (76.6667)  time: 0.0098  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8958 s / it)
* Acc@1 76.667 loss 0.821 auroc 0.736 f1_score 0.402
Test  [  0/200]  eta: 0:01:46  loss: 0.8153 (0.8153)  acc1: 0.0000 (0.0000)  time: 0.5301  data: 0.5176  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3516 (0.8436)  acc1: 100.0000 (72.2772)  time: 0.0090  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0965 (0.6762)  acc1: 100.0000 (78.0000)  time: 0.0109  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5381 s / it)
* Acc@1 78.000 loss 0.676 auroc 0.779 f1_score 0.505


Epoch: [29]  [  0/269]  eta: 0:02:21  lr: 0.000045  bag_loss: 0.1391 (0.1391)  instance_loss: 0.9138 (0.9138)  time: 0.5269  data: 0.5052  max mem: 337
Epoch: [29]  [100/269]  eta: 0:00:03  lr: 0.000043  bag_loss: 0.1859 (0.4945)  instance_loss: 0.8714 (0.8602)  time: 0.0133  data: 0.0011  max mem: 337
Epoch: [29]  [200/269]  eta: 0:00:01  lr: 0.000042  bag_loss: 0.1654 (0.4823)  instance_loss: 0.8326 (0.8675)  time: 0.0145  data: 0.0010  max mem: 337
Epoch: [29]  [268/269]  eta: 0:00:00  lr: 0.000041  bag_loss: 0.1076 (0.5203)  instance_loss: 0.8838 (0.8675)  time: 0.0185  data: 0.0011  max mem: 337
Epoch: [29] Total time: 0:00:04 (4.7299 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7628 (0.7628)  acc1: 0.0000 (0.0000)  time: 0.5155  data: 0.5050  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2767 (0.8591)  acc1: 100.0000 (70.0000)  time: 0.0102  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9412 s / it)
* Acc@1 70.000 loss 0.859 auroc 0.708 f1_score 0.308
Test  [  0/200]  eta: 0:01:27  loss: 0.1879 (0.1879)  acc1: 100.0000 (100.0000)  time: 0.4394  data: 0.4340  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4449 (0.8819)  acc1: 100.0000 (69.3069)  time: 0.0091  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2349 (0.7384)  acc1: 100.0000 (75.0000)  time: 0.0120  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5141 s / it)
* Acc@1 75.000 loss 0.738 auroc 0.778 f1_score 0.514


Epoch: [30]  [  0/269]  eta: 0:02:19  lr: 0.000041  bag_loss: 0.5904 (0.5904)  instance_loss: 0.9372 (0.9372)  time: 0.5182  data: 0.4926  max mem: 337
Epoch: [30]  [100/269]  eta: 0:00:03  lr: 0.000040  bag_loss: 0.2158 (0.5049)  instance_loss: 0.8346 (0.8827)  time: 0.0135  data: 0.0010  max mem: 337
Epoch: [30]  [200/269]  eta: 0:00:01  lr: 0.000039  bag_loss: 0.2394 (0.5010)  instance_loss: 0.8211 (0.8759)  time: 0.0144  data: 0.0011  max mem: 337
Epoch: [30]  [268/269]  eta: 0:00:00  lr: 0.000038  bag_loss: 0.1299 (0.4812)  instance_loss: 0.8591 (0.8653)  time: 0.0167  data: 0.0015  max mem: 337
Epoch: [30] Total time: 0:00:04 (4.7666 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7275 (0.7275)  acc1: 100.0000 (100.0000)  time: 0.5047  data: 0.4907  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2652 (0.8589)  acc1: 100.0000 (76.6667)  time: 0.0095  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8972 s / it)
* Acc@1 76.667 loss 0.859 auroc 0.723 f1_score 0.402
Test  [  0/200]  eta: 0:01:42  loss: 0.2125 (0.2125)  acc1: 100.0000 (100.0000)  time: 0.5141  data: 0.5060  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4098 (0.8899)  acc1: 100.0000 (71.2871)  time: 0.0084  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1147 (0.7130)  acc1: 100.0000 (77.0000)  time: 0.0112  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5557 s / it)
* Acc@1 77.000 loss 0.713 auroc 0.780 f1_score 0.522


Epoch: [31]  [  0/269]  eta: 0:02:21  lr: 0.000038  bag_loss: 0.2299 (0.2299)  instance_loss: 0.9892 (0.9892)  time: 0.5252  data: 0.5083  max mem: 337
Epoch: [31]  [100/269]  eta: 0:00:03  lr: 0.000037  bag_loss: 0.0979 (0.3683)  instance_loss: 0.8257 (0.8472)  time: 0.0145  data: 0.0011  max mem: 337
Epoch: [31]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.4894 (0.4544)  instance_loss: 0.9131 (0.8838)  time: 0.0150  data: 0.0010  max mem: 337
Epoch: [31]  [268/269]  eta: 0:00:00  lr: 0.000035  bag_loss: 0.3513 (0.4811)  instance_loss: 0.9443 (0.8995)  time: 0.0155  data: 0.0010  max mem: 337
Epoch: [31] Total time: 0:00:04 (4.7533 s / it)
Val  [ 0/30]  eta: 0:00:14  loss: 0.8731 (0.8731)  acc1: 0.0000 (0.0000)  time: 0.4965  data: 0.4859  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3091 (0.8659)  acc1: 100.0000 (73.3333)  time: 0.0101  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9041 s / it)
* Acc@1 73.333 loss 0.866 auroc 0.727 f1_score 0.384
Test  [  0/200]  eta: 0:01:38  loss: 0.1713 (0.1713)  acc1: 100.0000 (100.0000)  time: 0.4901  data: 0.4822  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5442 (0.9135)  acc1: 100.0000 (68.3168)  time: 0.0086  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1322 (0.7280)  acc1: 100.0000 (76.0000)  time: 0.0115  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.5875 s / it)
* Acc@1 76.000 loss 0.728 auroc 0.781 f1_score 0.526


Epoch: [32]  [  0/269]  eta: 0:02:20  lr: 0.000035  bag_loss: 0.0057 (0.0057)  instance_loss: 1.0472 (1.0472)  time: 0.5205  data: 0.4979  max mem: 337
Epoch: [32]  [100/269]  eta: 0:00:03  lr: 0.000033  bag_loss: 0.1251 (0.4170)  instance_loss: 0.8294 (0.8986)  time: 0.0153  data: 0.0010  max mem: 337
Epoch: [32]  [200/269]  eta: 0:00:01  lr: 0.000032  bag_loss: 0.1697 (0.4223)  instance_loss: 0.9037 (0.8887)  time: 0.0162  data: 0.0013  max mem: 337
Epoch: [32]  [268/269]  eta: 0:00:00  lr: 0.000031  bag_loss: 0.2318 (0.4684)  instance_loss: 0.8259 (0.8923)  time: 0.0129  data: 0.0010  max mem: 337
Epoch: [32] Total time: 0:00:04 (4.7436 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 1.0323 (1.0323)  acc1: 0.0000 (0.0000)  time: 0.5173  data: 0.5047  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2959 (0.8736)  acc1: 100.0000 (73.3333)  time: 0.0110  data: 0.0014  max mem: 337
Val Total time: 0:00:00 (0.9242 s / it)
* Acc@1 73.333 loss 0.874 auroc 0.733 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.1098 (0.1098)  acc1: 100.0000 (100.0000)  time: 0.5103  data: 0.4984  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4703 (0.9513)  acc1: 100.0000 (69.3069)  time: 0.0086  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1413 (0.7528)  acc1: 100.0000 (76.0000)  time: 0.0114  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5527 s / it)
* Acc@1 76.000 loss 0.753 auroc 0.782 f1_score 0.509


Epoch: [33]  [  0/269]  eta: 0:02:15  lr: 0.000031  bag_loss: 0.2315 (0.2315)  instance_loss: 0.9016 (0.9016)  time: 0.5033  data: 0.4878  max mem: 337
Epoch: [33]  [100/269]  eta: 0:00:03  lr: 0.000030  bag_loss: 0.1366 (0.5165)  instance_loss: 0.8222 (0.8831)  time: 0.0132  data: 0.0010  max mem: 337
Epoch: [33]  [200/269]  eta: 0:00:01  lr: 0.000029  bag_loss: 0.1859 (0.4506)  instance_loss: 0.8416 (0.8778)  time: 0.0164  data: 0.0012  max mem: 337
Epoch: [33]  [268/269]  eta: 0:00:00  lr: 0.000028  bag_loss: 0.2026 (0.4643)  instance_loss: 0.9767 (0.8787)  time: 0.0164  data: 0.0010  max mem: 337
Epoch: [33] Total time: 0:00:04 (4.7399 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6160 (0.6160)  acc1: 100.0000 (100.0000)  time: 0.5103  data: 0.4996  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1886 (0.8671)  acc1: 100.0000 (76.6667)  time: 0.0108  data: 0.0014  max mem: 337
Val Total time: 0:00:00 (0.9140 s / it)
* Acc@1 76.667 loss 0.867 auroc 0.714 f1_score 0.320
Test  [  0/200]  eta: 0:01:41  loss: 0.2304 (0.2304)  acc1: 100.0000 (100.0000)  time: 0.5097  data: 0.5024  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2777 (0.9158)  acc1: 100.0000 (72.2772)  time: 0.0086  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0971 (0.7192)  acc1: 100.0000 (78.0000)  time: 0.0114  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5469 s / it)
* Acc@1 78.000 loss 0.719 auroc 0.777 f1_score 0.539


Epoch: [34]  [  0/269]  eta: 0:02:14  lr: 0.000028  bag_loss: 0.2881 (0.2881)  instance_loss: 0.6464 (0.6464)  time: 0.5013  data: 0.4883  max mem: 337
Epoch: [34]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.2181 (0.4773)  instance_loss: 0.8197 (0.8570)  time: 0.0139  data: 0.0010  max mem: 337
Epoch: [34]  [200/269]  eta: 0:00:01  lr: 0.000026  bag_loss: 0.1254 (0.4483)  instance_loss: 0.8493 (0.8623)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [34]  [268/269]  eta: 0:00:00  lr: 0.000025  bag_loss: 0.2038 (0.4528)  instance_loss: 0.8091 (0.8628)  time: 0.0139  data: 0.0011  max mem: 337
Epoch: [34] Total time: 0:00:04 (4.6591 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.9596 (0.9596)  acc1: 0.0000 (0.0000)  time: 0.5238  data: 0.5126  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2703 (0.8742)  acc1: 100.0000 (70.0000)  time: 0.0107  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9532 s / it)
* Acc@1 70.000 loss 0.874 auroc 0.741 f1_score 0.361
Test  [  0/200]  eta: 0:01:38  loss: 0.2183 (0.2183)  acc1: 100.0000 (100.0000)  time: 0.4915  data: 0.4829  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5707 (0.9788)  acc1: 100.0000 (68.3168)  time: 0.0083  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1137 (0.7502)  acc1: 100.0000 (77.0000)  time: 0.0115  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.5301 s / it)
* Acc@1 77.000 loss 0.750 auroc 0.779 f1_score 0.539


Epoch: [35]  [  0/269]  eta: 0:02:21  lr: 0.000025  bag_loss: 0.2103 (0.2103)  instance_loss: 1.0081 (1.0081)  time: 0.5249  data: 0.4962  max mem: 337
Epoch: [35]  [100/269]  eta: 0:00:03  lr: 0.000024  bag_loss: 0.1580 (0.4341)  instance_loss: 0.8075 (0.8725)  time: 0.0160  data: 0.0010  max mem: 337
Epoch: [35]  [200/269]  eta: 0:00:01  lr: 0.000023  bag_loss: 0.1520 (0.4598)  instance_loss: 0.8210 (0.8751)  time: 0.0152  data: 0.0010  max mem: 337
Epoch: [35]  [268/269]  eta: 0:00:00  lr: 0.000022  bag_loss: 0.3005 (0.4638)  instance_loss: 0.8534 (0.8749)  time: 0.0154  data: 0.0011  max mem: 337
Epoch: [35] Total time: 0:00:04 (4.6706 s / it)
Val  [ 0/30]  eta: 0:00:14  loss: 0.8878 (0.8878)  acc1: 0.0000 (0.0000)  time: 0.4974  data: 0.4868  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2688 (0.8834)  acc1: 100.0000 (73.3333)  time: 0.0113  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.9499 s / it)
* Acc@1 73.333 loss 0.883 auroc 0.741 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.2435 (0.2435)  acc1: 100.0000 (100.0000)  time: 0.5102  data: 0.5013  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4609 (0.9998)  acc1: 100.0000 (65.3465)  time: 0.0092  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1093 (0.7607)  acc1: 100.0000 (74.5000)  time: 0.0119  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6405 s / it)
* Acc@1 74.500 loss 0.761 auroc 0.776 f1_score 0.531


Epoch: [36]  [  0/269]  eta: 0:02:14  lr: 0.000022  bag_loss: 0.4092 (0.4092)  instance_loss: 0.8398 (0.8398)  time: 0.5009  data: 0.4877  max mem: 337
Epoch: [36]  [100/269]  eta: 0:00:03  lr: 0.000021  bag_loss: 0.2400 (0.4367)  instance_loss: 0.8143 (0.8395)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [36]  [200/269]  eta: 0:00:01  lr: 0.000020  bag_loss: 0.2539 (0.4495)  instance_loss: 0.8703 (0.8485)  time: 0.0158  data: 0.0011  max mem: 337
Epoch: [36]  [268/269]  eta: 0:00:00  lr: 0.000019  bag_loss: 0.2921 (0.4613)  instance_loss: 0.8167 (0.8621)  time: 0.0158  data: 0.0011  max mem: 337
Epoch: [36] Total time: 0:00:04 (4.6822 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8814 (0.8814)  acc1: 0.0000 (0.0000)  time: 0.5006  data: 0.4874  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2758 (0.8681)  acc1: 100.0000 (73.3333)  time: 0.0103  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8950 s / it)
* Acc@1 73.333 loss 0.868 auroc 0.741 f1_score 0.384
Test  [  0/200]  eta: 0:01:37  loss: 0.2298 (0.2298)  acc1: 100.0000 (100.0000)  time: 0.4882  data: 0.4771  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5485 (0.9336)  acc1: 100.0000 (68.3168)  time: 0.0080  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1290 (0.7304)  acc1: 100.0000 (77.0000)  time: 0.0111  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5250 s / it)
* Acc@1 77.000 loss 0.730 auroc 0.779 f1_score 0.542


Epoch: [37]  [  0/269]  eta: 0:02:32  lr: 0.000019  bag_loss: 0.3578 (0.3578)  instance_loss: 0.9159 (0.9159)  time: 0.5656  data: 0.5316  max mem: 337
Epoch: [37]  [100/269]  eta: 0:00:03  lr: 0.000018  bag_loss: 0.2253 (0.3861)  instance_loss: 0.8346 (0.8519)  time: 0.0152  data: 0.0012  max mem: 337
Epoch: [37]  [200/269]  eta: 0:00:01  lr: 0.000017  bag_loss: 0.1176 (0.4587)  instance_loss: 0.8049 (0.8651)  time: 0.0151  data: 0.0012  max mem: 337
Epoch: [37]  [268/269]  eta: 0:00:00  lr: 0.000017  bag_loss: 0.1587 (0.4367)  instance_loss: 0.8303 (0.8628)  time: 0.0137  data: 0.0010  max mem: 337
Epoch: [37] Total time: 0:00:04 (4.7157 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7827 (0.7827)  acc1: 0.0000 (0.0000)  time: 0.5010  data: 0.4905  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2351 (0.8736)  acc1: 100.0000 (70.0000)  time: 0.0096  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9044 s / it)
* Acc@1 70.000 loss 0.874 auroc 0.741 f1_score 0.361
Test  [  0/200]  eta: 0:01:42  loss: 0.4713 (0.4713)  acc1: 100.0000 (100.0000)  time: 0.5139  data: 0.5050  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4120 (0.9473)  acc1: 100.0000 (70.2970)  time: 0.0089  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1032 (0.7273)  acc1: 100.0000 (77.5000)  time: 0.0109  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5419 s / it)
* Acc@1 77.500 loss 0.727 auroc 0.776 f1_score 0.509


Epoch: [38]  [  0/269]  eta: 0:02:17  lr: 0.000017  bag_loss: 0.3357 (0.3357)  instance_loss: 0.9067 (0.9067)  time: 0.5115  data: 0.4959  max mem: 337
Epoch: [38]  [100/269]  eta: 0:00:03  lr: 0.000016  bag_loss: 0.1432 (0.3857)  instance_loss: 0.8144 (0.8530)  time: 0.0139  data: 0.0010  max mem: 337
Epoch: [38]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.1949 (0.3995)  instance_loss: 0.8516 (0.8703)  time: 0.0138  data: 0.0012  max mem: 337
Epoch: [38]  [268/269]  eta: 0:00:00  lr: 0.000014  bag_loss: 0.2712 (0.4410)  instance_loss: 0.8535 (0.8718)  time: 0.0146  data: 0.0010  max mem: 337
Epoch: [38] Total time: 0:00:04 (4.6701 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.9979 (0.9979)  acc1: 0.0000 (0.0000)  time: 0.5120  data: 0.5004  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2818 (0.8945)  acc1: 100.0000 (66.6667)  time: 0.0108  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9426 s / it)
* Acc@1 66.667 loss 0.895 auroc 0.743 f1_score 0.346
Test  [  0/200]  eta: 0:01:41  loss: 0.3115 (0.3115)  acc1: 100.0000 (100.0000)  time: 0.5089  data: 0.4933  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4673 (0.9970)  acc1: 100.0000 (67.3267)  time: 0.0088  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1178 (0.7586)  acc1: 100.0000 (75.5000)  time: 0.0112  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5252 s / it)
* Acc@1 75.500 loss 0.759 auroc 0.776 f1_score 0.511


Epoch: [39]  [  0/269]  eta: 0:02:17  lr: 0.000014  bag_loss: 0.0283 (0.0283)  instance_loss: 0.7803 (0.7803)  time: 0.5118  data: 0.4999  max mem: 337
Epoch: [39]  [100/269]  eta: 0:00:03  lr: 0.000013  bag_loss: 0.1355 (0.4587)  instance_loss: 0.9046 (0.8724)  time: 0.0138  data: 0.0012  max mem: 337
Epoch: [39]  [200/269]  eta: 0:00:01  lr: 0.000012  bag_loss: 0.1452 (0.4513)  instance_loss: 0.8460 (0.8715)  time: 0.0176  data: 0.0010  max mem: 337
Epoch: [39]  [268/269]  eta: 0:00:00  lr: 0.000012  bag_loss: 0.0874 (0.4362)  instance_loss: 0.7817 (0.8591)  time: 0.0135  data: 0.0010  max mem: 337
Epoch: [39] Total time: 0:00:04 (4.6591 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7479 (0.7479)  acc1: 0.0000 (0.0000)  time: 0.5181  data: 0.4976  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2134 (0.8852)  acc1: 100.0000 (73.3333)  time: 0.0094  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9252 s / it)
* Acc@1 73.333 loss 0.885 auroc 0.725 f1_score 0.384
Test  [  0/200]  eta: 0:01:39  loss: 0.2121 (0.2121)  acc1: 100.0000 (100.0000)  time: 0.4996  data: 0.4868  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3360 (0.9679)  acc1: 100.0000 (71.2871)  time: 0.0087  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0823 (0.7437)  acc1: 100.0000 (77.5000)  time: 0.0117  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5343 s / it)
* Acc@1 77.500 loss 0.744 auroc 0.775 f1_score 0.521


Epoch: [40]  [  0/269]  eta: 0:02:17  lr: 0.000012  bag_loss: 0.5313 (0.5313)  instance_loss: 1.1091 (1.1091)  time: 0.5115  data: 0.4984  max mem: 337
Epoch: [40]  [100/269]  eta: 0:00:03  lr: 0.000011  bag_loss: 0.1457 (0.3832)  instance_loss: 0.8533 (0.8658)  time: 0.0167  data: 0.0010  max mem: 337
Epoch: [40]  [200/269]  eta: 0:00:01  lr: 0.000010  bag_loss: 0.3442 (0.4380)  instance_loss: 0.8839 (0.8509)  time: 0.0150  data: 0.0010  max mem: 337
Epoch: [40]  [268/269]  eta: 0:00:00  lr: 0.000010  bag_loss: 0.2785 (0.4252)  instance_loss: 0.8924 (0.8579)  time: 0.0138  data: 0.0010  max mem: 337
Epoch: [40] Total time: 0:00:04 (4.6354 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.9339 (0.9339)  acc1: 0.0000 (0.0000)  time: 0.5078  data: 0.4970  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2631 (0.8970)  acc1: 100.0000 (70.0000)  time: 0.0088  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8988 s / it)
* Acc@1 70.000 loss 0.897 auroc 0.735 f1_score 0.361
Test  [  0/200]  eta: 0:01:40  loss: 0.2243 (0.2243)  acc1: 100.0000 (100.0000)  time: 0.5004  data: 0.4915  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4804 (0.9941)  acc1: 100.0000 (67.3267)  time: 0.0088  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1008 (0.7567)  acc1: 100.0000 (76.5000)  time: 0.0119  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.5552 s / it)
* Acc@1 76.500 loss 0.757 auroc 0.775 f1_score 0.530


Epoch: [41]  [  0/269]  eta: 0:02:21  lr: 0.000010  bag_loss: 0.4160 (0.4160)  instance_loss: 0.9543 (0.9543)  time: 0.5261  data: 0.5030  max mem: 337
Epoch: [41]  [100/269]  eta: 0:00:03  lr: 0.000009  bag_loss: 0.2565 (0.4311)  instance_loss: 0.8687 (0.8750)  time: 0.0136  data: 0.0010  max mem: 337
Epoch: [41]  [200/269]  eta: 0:00:01  lr: 0.000008  bag_loss: 0.1872 (0.4384)  instance_loss: 0.8534 (0.8658)  time: 0.0152  data: 0.0010  max mem: 337
Epoch: [41]  [268/269]  eta: 0:00:00  lr: 0.000008  bag_loss: 0.3202 (0.4379)  instance_loss: 0.8656 (0.8682)  time: 0.0159  data: 0.0011  max mem: 337
Epoch: [41] Total time: 0:00:04 (4.6465 s / it)
Val  [ 0/30]  eta: 0:00:14  loss: 0.8922 (0.8922)  acc1: 0.0000 (0.0000)  time: 0.4993  data: 0.4887  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2233 (0.8871)  acc1: 100.0000 (73.3333)  time: 0.0110  data: 0.0014  max mem: 337
Val Total time: 0:00:00 (0.9364 s / it)
* Acc@1 73.333 loss 0.887 auroc 0.739 f1_score 0.384
Test  [  0/200]  eta: 0:02:12  loss: 0.1873 (0.1873)  acc1: 100.0000 (100.0000)  time: 0.6616  data: 0.6510  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3606 (0.9757)  acc1: 100.0000 (71.2871)  time: 0.0086  data: 0.0008  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0862 (0.7507)  acc1: 100.0000 (77.0000)  time: 0.0097  data: 0.0010  max mem: 337
Test Total time: 0:00:03 (3.0474 s / it)
* Acc@1 77.000 loss 0.751 auroc 0.776 f1_score 0.517


Epoch: [42]  [  0/269]  eta: 0:02:17  lr: 0.000008  bag_loss: 1.5919 (1.5919)  instance_loss: 0.8722 (0.8722)  time: 0.5102  data: 0.4941  max mem: 337
Epoch: [42]  [100/269]  eta: 0:00:03  lr: 0.000007  bag_loss: 0.1782 (0.4698)  instance_loss: 0.8821 (0.8812)  time: 0.0149  data: 0.0010  max mem: 337
Epoch: [42]  [200/269]  eta: 0:00:01  lr: 0.000006  bag_loss: 0.2447 (0.4278)  instance_loss: 0.8363 (0.8696)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [42]  [268/269]  eta: 0:00:00  lr: 0.000006  bag_loss: 0.2111 (0.4462)  instance_loss: 0.9231 (0.8695)  time: 0.0148  data: 0.0011  max mem: 337
Epoch: [42] Total time: 0:00:04 (4.7372 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8701 (0.8701)  acc1: 0.0000 (0.0000)  time: 0.5087  data: 0.4917  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2251 (0.8830)  acc1: 100.0000 (73.3333)  time: 0.0101  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9299 s / it)
* Acc@1 73.333 loss 0.883 auroc 0.738 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.1978 (0.1978)  acc1: 100.0000 (100.0000)  time: 0.5119  data: 0.4985  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4090 (0.9797)  acc1: 100.0000 (71.2871)  time: 0.0084  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0884 (0.7516)  acc1: 100.0000 (77.5000)  time: 0.0111  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6225 s / it)
* Acc@1 77.500 loss 0.752 auroc 0.777 f1_score 0.521


Epoch: [43]  [  0/269]  eta: 0:02:24  lr: 0.000006  bag_loss: 0.3555 (0.3555)  instance_loss: 0.9338 (0.9338)  time: 0.5364  data: 0.5092  max mem: 337
Epoch: [43]  [100/269]  eta: 0:00:03  lr: 0.000005  bag_loss: 0.2394 (0.4403)  instance_loss: 0.8568 (0.8660)  time: 0.0143  data: 0.0010  max mem: 337
Epoch: [43]  [200/269]  eta: 0:00:01  lr: 0.000005  bag_loss: 0.3020 (0.4347)  instance_loss: 0.8371 (0.8558)  time: 0.0152  data: 0.0011  max mem: 337
Epoch: [43]  [268/269]  eta: 0:00:00  lr: 0.000004  bag_loss: 0.1398 (0.4173)  instance_loss: 0.8388 (0.8560)  time: 0.0163  data: 0.0011  max mem: 337
Epoch: [43] Total time: 0:00:04 (4.6982 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8346 (0.8346)  acc1: 0.0000 (0.0000)  time: 0.5281  data: 0.5116  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2152 (0.8802)  acc1: 100.0000 (73.3333)  time: 0.0098  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9528 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.738 f1_score 0.384
Test  [  0/200]  eta: 0:01:44  loss: 0.2460 (0.2460)  acc1: 100.0000 (100.0000)  time: 0.5213  data: 0.5132  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4146 (0.9741)  acc1: 100.0000 (71.2871)  time: 0.0085  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0863 (0.7458)  acc1: 100.0000 (78.0000)  time: 0.0115  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6005 s / it)
* Acc@1 78.000 loss 0.746 auroc 0.776 f1_score 0.533


Epoch: [44]  [  0/269]  eta: 0:02:27  lr: 0.000004  bag_loss: 0.2767 (0.2767)  instance_loss: 0.9312 (0.9312)  time: 0.5491  data: 0.5366  max mem: 337
Epoch: [44]  [100/269]  eta: 0:00:03  lr: 0.000004  bag_loss: 0.0600 (0.4985)  instance_loss: 0.8204 (0.8622)  time: 0.0158  data: 0.0010  max mem: 337
Epoch: [44]  [200/269]  eta: 0:00:01  lr: 0.000003  bag_loss: 0.2319 (0.4583)  instance_loss: 0.8537 (0.8630)  time: 0.0148  data: 0.0011  max mem: 337
Epoch: [44]  [268/269]  eta: 0:00:00  lr: 0.000003  bag_loss: 0.1942 (0.4266)  instance_loss: 0.8791 (0.8577)  time: 0.0139  data: 0.0010  max mem: 337
Epoch: [44] Total time: 0:00:04 (4.7461 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.8569 (0.8569)  acc1: 0.0000 (0.0000)  time: 0.5495  data: 0.5359  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2210 (0.8805)  acc1: 100.0000 (73.3333)  time: 0.0101  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9830 s / it)
* Acc@1 73.333 loss 0.881 auroc 0.741 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.2446 (0.2446)  acc1: 100.0000 (100.0000)  time: 0.5150  data: 0.5064  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4387 (0.9770)  acc1: 100.0000 (70.2970)  time: 0.0088  data: 0.0015  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0891 (0.7476)  acc1: 100.0000 (78.0000)  time: 0.0109  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.6283 s / it)
* Acc@1 78.000 loss 0.748 auroc 0.776 f1_score 0.536


Epoch: [45]  [  0/269]  eta: 0:02:29  lr: 0.000003  bag_loss: 1.4399 (1.4399)  instance_loss: 1.1570 (1.1570)  time: 0.5543  data: 0.5227  max mem: 337
Epoch: [45]  [100/269]  eta: 0:00:03  lr: 0.000003  bag_loss: 0.2750 (0.4357)  instance_loss: 0.8679 (0.8442)  time: 0.0150  data: 0.0010  max mem: 337
Epoch: [45]  [200/269]  eta: 0:00:01  lr: 0.000002  bag_loss: 0.1368 (0.4359)  instance_loss: 0.8256 (0.8597)  time: 0.0144  data: 0.0011  max mem: 337
Epoch: [45]  [268/269]  eta: 0:00:00  lr: 0.000002  bag_loss: 0.2092 (0.4365)  instance_loss: 0.8130 (0.8556)  time: 0.0151  data: 0.0011  max mem: 337
Epoch: [45] Total time: 0:00:04 (4.7001 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8519 (0.8519)  acc1: 0.0000 (0.0000)  time: 0.5201  data: 0.5051  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2209 (0.8796)  acc1: 100.0000 (73.3333)  time: 0.0098  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9449 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.738 f1_score 0.384
Test  [  0/200]  eta: 0:01:39  loss: 0.2575 (0.2575)  acc1: 100.0000 (100.0000)  time: 0.4980  data: 0.4905  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4468 (0.9727)  acc1: 100.0000 (71.2871)  time: 0.0088  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0891 (0.7451)  acc1: 100.0000 (78.5000)  time: 0.0112  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.5355 s / it)
* Acc@1 78.500 loss 0.745 auroc 0.776 f1_score 0.537


Epoch: [46]  [  0/269]  eta: 0:02:16  lr: 0.000002  bag_loss: 0.0356 (0.0356)  instance_loss: 0.7035 (0.7035)  time: 0.5079  data: 0.4948  max mem: 337
Epoch: [46]  [100/269]  eta: 0:00:03  lr: 0.000002  bag_loss: 0.1098 (0.5136)  instance_loss: 0.7940 (0.8772)  time: 0.0149  data: 0.0010  max mem: 337
Epoch: [46]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.2247 (0.4383)  instance_loss: 0.8082 (0.8637)  time: 0.0164  data: 0.0010  max mem: 337
Epoch: [46]  [268/269]  eta: 0:00:00  lr: 0.000001  bag_loss: 0.1535 (0.4193)  instance_loss: 0.8516 (0.8616)  time: 0.0140  data: 0.0009  max mem: 337
Epoch: [46] Total time: 0:00:04 (4.6631 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8372 (0.8372)  acc1: 0.0000 (0.0000)  time: 0.5030  data: 0.4922  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2180 (0.8792)  acc1: 100.0000 (73.3333)  time: 0.0101  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8973 s / it)
* Acc@1 73.333 loss 0.879 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:40  loss: 0.2574 (0.2574)  acc1: 100.0000 (100.0000)  time: 0.5041  data: 0.4970  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4318 (0.9693)  acc1: 100.0000 (71.2871)  time: 0.0093  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0880 (0.7435)  acc1: 100.0000 (78.5000)  time: 0.0110  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.5566 s / it)
* Acc@1 78.500 loss 0.743 auroc 0.776 f1_score 0.537


Epoch: [47]  [  0/269]  eta: 0:02:22  lr: 0.000001  bag_loss: 0.0677 (0.0677)  instance_loss: 0.9623 (0.9623)  time: 0.5284  data: 0.5008  max mem: 337
Epoch: [47]  [100/269]  eta: 0:00:03  lr: 0.000001  bag_loss: 0.2559 (0.3722)  instance_loss: 0.8483 (0.8570)  time: 0.0176  data: 0.0010  max mem: 337
Epoch: [47]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.0829 (0.4159)  instance_loss: 0.8034 (0.8551)  time: 0.0159  data: 0.0011  max mem: 337
Epoch: [47]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1989 (0.4170)  instance_loss: 0.8979 (0.8631)  time: 0.0136  data: 0.0010  max mem: 337
Epoch: [47] Total time: 0:00:04 (4.7039 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8420 (0.8420)  acc1: 0.0000 (0.0000)  time: 0.5180  data: 0.5066  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2188 (0.8793)  acc1: 100.0000 (73.3333)  time: 0.0099  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9141 s / it)
* Acc@1 73.333 loss 0.879 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:40  loss: 0.2559 (0.2559)  acc1: 100.0000 (100.0000)  time: 0.5026  data: 0.4937  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4322 (0.9697)  acc1: 100.0000 (71.2871)  time: 0.0089  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0882 (0.7439)  acc1: 100.0000 (78.5000)  time: 0.0109  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.5164 s / it)
* Acc@1 78.500 loss 0.744 auroc 0.776 f1_score 0.537


Epoch: [48]  [  0/269]  eta: 0:02:20  lr: 0.000000  bag_loss: 0.0369 (0.0369)  instance_loss: 0.6288 (0.6288)  time: 0.5239  data: 0.5083  max mem: 337
Epoch: [48]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.1730 (0.4050)  instance_loss: 0.7826 (0.8525)  time: 0.0141  data: 0.0010  max mem: 337
Epoch: [48]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1848 (0.4460)  instance_loss: 0.9056 (0.8780)  time: 0.0145  data: 0.0011  max mem: 337
Epoch: [48]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1166 (0.4178)  instance_loss: 0.9123 (0.8692)  time: 0.0148  data: 0.0010  max mem: 337
Epoch: [48] Total time: 0:00:04 (4.7464 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8472 (0.8472)  acc1: 0.0000 (0.0000)  time: 0.5314  data: 0.5187  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2202 (0.8797)  acc1: 100.0000 (73.3333)  time: 0.0106  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9725 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.2556 (0.2556)  acc1: 100.0000 (100.0000)  time: 0.5143  data: 0.5044  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4365 (0.9704)  acc1: 100.0000 (71.2871)  time: 0.0084  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0891 (0.7444)  acc1: 100.0000 (78.5000)  time: 0.0111  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5599 s / it)
* Acc@1 78.500 loss 0.744 auroc 0.776 f1_score 0.537


Epoch: [49]  [  0/269]  eta: 0:02:17  lr: 0.000000  bag_loss: 2.0841 (2.0841)  instance_loss: 1.1751 (1.1751)  time: 0.5125  data: 0.5004  max mem: 337
Epoch: [49]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.1373 (0.4280)  instance_loss: 0.7949 (0.8584)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [49]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1772 (0.4115)  instance_loss: 0.8683 (0.8498)  time: 0.0116  data: 0.0010  max mem: 337
Epoch: [49]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1795 (0.4107)  instance_loss: 0.8143 (0.8523)  time: 0.0169  data: 0.0011  max mem: 337
Epoch: [49] Total time: 0:00:04 (4.6525 s / it)
Val  [ 0/30]  eta: 0:00:14  loss: 0.8461 (0.8461)  acc1: 0.0000 (0.0000)  time: 0.4983  data: 0.4879  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2200 (0.8797)  acc1: 100.0000 (73.3333)  time: 0.0107  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9252 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:38  loss: 0.2566 (0.2566)  acc1: 100.0000 (100.0000)  time: 0.4922  data: 0.4832  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4353 (0.9704)  acc1: 100.0000 (71.2871)  time: 0.0087  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0889 (0.7443)  acc1: 100.0000 (78.5000)  time: 0.0118  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.5381 s / it)
* Acc@1 78.500 loss 0.744 auroc 0.776 f1_score 0.537


Results on best epoch:
{'epoch': 28, 'val_acc': 76.66666666666667, 'val_auc': 0.7363314628601074, 'val_f1': 0.4020833373069763, 'test_acc': 78.0, 'test_auc': 0.7786926031112671, 'test_f1': 0.5049492716789246}
Wandb run dir: /fs2/comm/kpgrp/yelinfen/Documents/ACMIL/wandb/offline-run-20250807_002416-de3zi3rt/files
Used config:
{'B': 1,
 'D_feat': 512,
 'D_inner': 256,
 'arch': 'clam_sb',
 'augment_epoch': 1,
 'backbone': 'Resnet18',
 'config': 'config/patch_classification_camelyon17_config.yml',
 'data_dir': './Features/CAM17_res18',
 'dataset': 'camelyon17',
 'heatmap_arguments': {'alpha': 0.4,
                       'binarize': False,
                       'blank_canvas': False,
                       'blur': True,
                       'cmap': 'jet',
                       'custom_downsample': 1,
                       'vis_level': -1},
 'load_head_checkpoints': False,
 'lr': 0.0001,
 'min_lr': 0,
 'n_class': 4,
 'n_shot': -1,
 'n_token': 4,
 'n_worker': 8,
 'optim': 'sgd',
 'pin_memory': False,
 'pretrain': 'natural_supervsied',
 'seed': 5,
 'start_epoch': 0,
 'train_epoch': 50,
 'w_loss': 1.0,
 'wandb_mode': 'offline',
 'warmup_epoch': 5,
 'wd': 0.0005}
get dataset
Epoch: [0]  [  0/269]  eta: 0:04:28  lr: 0.000000  bag_loss: 2.0408 (2.0408)  instance_loss: 1.1297 (1.1297)  time: 0.9984  data: 0.4353  max mem: 88
Epoch: [0]  [100/269]  eta: 0:00:04  lr: 0.000007  bag_loss: 1.5611 (1.5891)  instance_loss: 1.2793 (1.3641)  time: 0.0124  data: 0.0010  max mem: 337
Epoch: [0]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.6874 (1.3846)  instance_loss: 1.3703 (1.3876)  time: 0.0143  data: 0.0012  max mem: 337
Epoch: [0]  [268/269]  eta: 0:00:00  lr: 0.000020  bag_loss: 0.5244 (1.2896)  instance_loss: 1.4212 (1.4006)  time: 0.0127  data: 0.0011  max mem: 337
Epoch: [0] Total time: 0:00:04 (4.9256 s / it)
Val  [ 0/30]  eta: 0:00:14  loss: 0.3923 (0.3923)  acc1: 100.0000 (100.0000)  time: 0.4872  data: 0.4700  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4292 (0.8534)  acc1: 100.0000 (73.3333)  time: 0.0074  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8103 s / it)
* Acc@1 73.333 loss 0.853 auroc 0.701 f1_score 0.212
Test  [  0/200]  eta: 0:01:35  loss: 1.9171 (1.9171)  acc1: 0.0000 (0.0000)  time: 0.4753  data: 0.4700  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4859 (1.1123)  acc1: 100.0000 (59.4059)  time: 0.0065  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5514 (1.0779)  acc1: 100.0000 (60.5000)  time: 0.0104  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.0748 s / it)
* Acc@1 60.500 loss 1.078 auroc 0.550 f1_score 0.188


Epoch: [1]  [  0/269]  eta: 0:02:27  lr: 0.000020  bag_loss: 0.5400 (0.5400)  instance_loss: 1.5285 (1.5285)  time: 0.5490  data: 0.5175  max mem: 337
Epoch: [1]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.5600 (1.0040)  instance_loss: 1.4202 (1.5052)  time: 0.0159  data: 0.0012  max mem: 337
Epoch: [1]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.4729 (1.0115)  instance_loss: 1.3555 (1.4769)  time: 0.0131  data: 0.0010  max mem: 337
Epoch: [1]  [268/269]  eta: 0:00:00  lr: 0.000040  bag_loss: 0.5602 (1.0369)  instance_loss: 1.3314 (1.4654)  time: 0.0127  data: 0.0011  max mem: 337
Epoch: [1] Total time: 0:00:04 (4.3358 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.5193 (0.5193)  acc1: 100.0000 (100.0000)  time: 0.5026  data: 0.4921  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5063 (0.8556)  acc1: 100.0000 (73.3333)  time: 0.0077  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8452 s / it)
* Acc@1 73.333 loss 0.856 auroc 0.684 f1_score 0.212
Test  [  0/200]  eta: 0:01:39  loss: 1.4550 (1.4550)  acc1: 0.0000 (0.0000)  time: 0.4980  data: 0.4828  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5655 (1.1265)  acc1: 100.0000 (59.4059)  time: 0.0072  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5673 (1.0973)  acc1: 100.0000 (60.5000)  time: 0.0093  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2040 s / it)
* Acc@1 60.500 loss 1.097 auroc 0.580 f1_score 0.188


Epoch: [2]  [  0/269]  eta: 0:02:41  lr: 0.000040  bag_loss: 0.5860 (0.5860)  instance_loss: 1.2733 (1.2733)  time: 0.5992  data: 0.5733  max mem: 337
Epoch: [2]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.2876 (0.9401)  instance_loss: 1.3984 (1.4373)  time: 0.0162  data: 0.0016  max mem: 337
Epoch: [2]  [200/269]  eta: 0:00:01  lr: 0.000055  bag_loss: 1.5218 (1.0187)  instance_loss: 1.4241 (1.4530)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [2]  [268/269]  eta: 0:00:00  lr: 0.000060  bag_loss: 1.8610 (1.0327)  instance_loss: 1.4700 (1.4387)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [2] Total time: 0:00:04 (4.6760 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.5201 (0.5201)  acc1: 100.0000 (100.0000)  time: 0.5084  data: 0.4934  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4165 (0.8338)  acc1: 100.0000 (73.3333)  time: 0.0077  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8452 s / it)
* Acc@1 73.333 loss 0.834 auroc 0.706 f1_score 0.212
Test  [  0/200]  eta: 0:01:41  loss: 1.5565 (1.5565)  acc1: 0.0000 (0.0000)  time: 0.5067  data: 0.4982  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5380 (1.1128)  acc1: 100.0000 (59.4059)  time: 0.0062  data: 0.0008  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.4865 (1.0735)  acc1: 100.0000 (60.5000)  time: 0.0085  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.0655 s / it)
* Acc@1 60.500 loss 1.073 auroc 0.591 f1_score 0.188


Epoch: [3]  [  0/269]  eta: 0:02:24  lr: 0.000060  bag_loss: 0.3753 (0.3753)  instance_loss: 1.2302 (1.2302)  time: 0.5380  data: 0.5129  max mem: 337
Epoch: [3]  [100/269]  eta: 0:00:03  lr: 0.000067  bag_loss: 0.4542 (0.9073)  instance_loss: 1.1733 (1.2678)  time: 0.0131  data: 0.0012  max mem: 337
Epoch: [3]  [200/269]  eta: 0:00:01  lr: 0.000075  bag_loss: 0.4451 (0.9754)  instance_loss: 1.3559 (1.3199)  time: 0.0132  data: 0.0011  max mem: 337
Epoch: [3]  [268/269]  eta: 0:00:00  lr: 0.000080  bag_loss: 0.8925 (1.0300)  instance_loss: 1.2312 (1.3190)  time: 0.0134  data: 0.0012  max mem: 337
Epoch: [3] Total time: 0:00:04 (4.3348 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8946 (0.8946)  acc1: 100.0000 (100.0000)  time: 0.5052  data: 0.4918  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.6875 (0.9417)  acc1: 100.0000 (73.3333)  time: 0.0070  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8396 s / it)
* Acc@1 73.333 loss 0.942 auroc 0.728 f1_score 0.212
Test  [  0/200]  eta: 0:01:40  loss: 1.3929 (1.3929)  acc1: 0.0000 (0.0000)  time: 0.5040  data: 0.4950  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.8862 (1.1310)  acc1: 100.0000 (59.4059)  time: 0.0067  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.8479 (1.0834)  acc1: 100.0000 (60.5000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0954 s / it)
* Acc@1 60.500 loss 1.083 auroc 0.641 f1_score 0.188


Epoch: [4]  [  0/269]  eta: 0:02:21  lr: 0.000080  bag_loss: 0.5954 (0.5954)  instance_loss: 1.4286 (1.4286)  time: 0.5261  data: 0.5101  max mem: 337
Epoch: [4]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.6522 (1.0712)  instance_loss: 1.1156 (1.1918)  time: 0.0151  data: 0.0013  max mem: 337
Epoch: [4]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.6277 (1.0101)  instance_loss: 1.1510 (1.1877)  time: 0.0139  data: 0.0012  max mem: 337
Epoch: [4]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.4943 (1.0165)  instance_loss: 1.0961 (1.1780)  time: 0.0122  data: 0.0011  max mem: 337
Epoch: [4] Total time: 0:00:04 (4.4231 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7426 (0.7426)  acc1: 100.0000 (100.0000)  time: 0.5108  data: 0.4957  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5389 (0.9452)  acc1: 100.0000 (73.3333)  time: 0.0076  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8540 s / it)
* Acc@1 73.333 loss 0.945 auroc 0.671 f1_score 0.212
Test  [  0/200]  eta: 0:01:42  loss: 2.2429 (2.2429)  acc1: 0.0000 (0.0000)  time: 0.5104  data: 0.5018  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7801 (1.1228)  acc1: 100.0000 (60.3960)  time: 0.0059  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6611 (1.0508)  acc1: 100.0000 (61.0000)  time: 0.0085  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0827 s / it)
* Acc@1 61.000 loss 1.051 auroc 0.637 f1_score 0.200


Epoch: [5]  [  0/269]  eta: 0:02:19  lr: 0.000100  bag_loss: 1.5243 (1.5243)  instance_loss: 1.0512 (1.0512)  time: 0.5202  data: 0.5046  max mem: 337
Epoch: [5]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.3065 (1.0574)  instance_loss: 1.3322 (1.1712)  time: 0.0139  data: 0.0011  max mem: 337
Epoch: [5]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.4579 (1.0315)  instance_loss: 1.2696 (1.1937)  time: 0.0156  data: 0.0012  max mem: 337
Epoch: [5]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.7772 (1.0163)  instance_loss: 1.1304 (1.1857)  time: 0.0143  data: 0.0011  max mem: 337
Epoch: [5] Total time: 0:00:04 (4.3178 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7753 (0.7753)  acc1: 100.0000 (100.0000)  time: 0.5117  data: 0.5003  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5492 (0.9064)  acc1: 100.0000 (73.3333)  time: 0.0074  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8385 s / it)
* Acc@1 73.333 loss 0.906 auroc 0.697 f1_score 0.310
Test  [  0/200]  eta: 0:01:42  loss: 1.7764 (1.7764)  acc1: 0.0000 (0.0000)  time: 0.5109  data: 0.5025  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7755 (1.0836)  acc1: 100.0000 (70.2970)  time: 0.0060  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6185 (1.0129)  acc1: 100.0000 (70.5000)  time: 0.0086  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0691 s / it)
* Acc@1 70.500 loss 1.013 auroc 0.706 f1_score 0.352


Epoch: [6]  [  0/269]  eta: 0:02:22  lr: 0.000100  bag_loss: 0.9379 (0.9379)  instance_loss: 1.1581 (1.1581)  time: 0.5287  data: 0.5173  max mem: 337
Epoch: [6]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.3803 (0.9727)  instance_loss: 1.0987 (1.1329)  time: 0.0169  data: 0.0013  max mem: 337
Epoch: [6]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.2107 (0.9054)  instance_loss: 1.1538 (1.1599)  time: 0.0136  data: 0.0012  max mem: 337
Epoch: [6]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.6152 (0.9349)  instance_loss: 1.1400 (1.1841)  time: 0.0131  data: 0.0011  max mem: 337
Epoch: [6] Total time: 0:00:04 (4.4143 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8416 (0.8416)  acc1: 100.0000 (100.0000)  time: 0.5237  data: 0.5132  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3704 (0.8402)  acc1: 100.0000 (76.6667)  time: 0.0074  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8449 s / it)
* Acc@1 76.667 loss 0.840 auroc 0.670 f1_score 0.341
Test  [  0/200]  eta: 0:01:48  loss: 1.2313 (1.2313)  acc1: 0.0000 (0.0000)  time: 0.5441  data: 0.5338  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7825 (0.9490)  acc1: 100.0000 (66.3366)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.4777 (0.9076)  acc1: 100.0000 (68.5000)  time: 0.0084  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.1357 s / it)
* Acc@1 68.500 loss 0.908 auroc 0.733 f1_score 0.370


Epoch: [7]  [  0/269]  eta: 0:02:20  lr: 0.000100  bag_loss: 0.3426 (0.3426)  instance_loss: 1.1473 (1.1473)  time: 0.5241  data: 0.5074  max mem: 337
Epoch: [7]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.4474 (0.9173)  instance_loss: 1.2217 (1.2263)  time: 0.0128  data: 0.0010  max mem: 337
Epoch: [7]  [200/269]  eta: 0:00:01  lr: 0.000099  bag_loss: 0.2981 (0.8272)  instance_loss: 1.1228 (1.2135)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [7]  [268/269]  eta: 0:00:00  lr: 0.000099  bag_loss: 0.3556 (0.8088)  instance_loss: 1.2183 (1.2241)  time: 0.0157  data: 0.0011  max mem: 337
Epoch: [7] Total time: 0:00:04 (4.3600 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4263 (0.4263)  acc1: 100.0000 (100.0000)  time: 0.5266  data: 0.5166  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2092 (0.7697)  acc1: 100.0000 (76.6667)  time: 0.0082  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8649 s / it)
* Acc@1 76.667 loss 0.770 auroc 0.698 f1_score 0.320
Test  [  0/200]  eta: 0:01:42  loss: 1.4667 (1.4667)  acc1: 0.0000 (0.0000)  time: 0.5122  data: 0.5027  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2932 (0.7966)  acc1: 100.0000 (76.2376)  time: 0.0060  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2008 (0.7511)  acc1: 100.0000 (78.5000)  time: 0.0084  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0788 s / it)
* Acc@1 78.500 loss 0.751 auroc 0.760 f1_score 0.431


Epoch: [8]  [  0/269]  eta: 0:02:24  lr: 0.000099  bag_loss: 0.3202 (0.3202)  instance_loss: 1.0728 (1.0728)  time: 0.5366  data: 0.5188  max mem: 337
Epoch: [8]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.2226 (0.5991)  instance_loss: 1.1991 (1.2174)  time: 0.0131  data: 0.0012  max mem: 337
Epoch: [8]  [200/269]  eta: 0:00:01  lr: 0.000098  bag_loss: 0.5096 (0.7195)  instance_loss: 1.1538 (1.2466)  time: 0.0114  data: 0.0011  max mem: 337
Epoch: [8]  [268/269]  eta: 0:00:00  lr: 0.000098  bag_loss: 0.2494 (0.7665)  instance_loss: 1.1694 (1.2381)  time: 0.0180  data: 0.0013  max mem: 337
Epoch: [8] Total time: 0:00:04 (4.4629 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.3677 (0.3677)  acc1: 100.0000 (100.0000)  time: 0.5146  data: 0.5013  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2718 (0.8780)  acc1: 100.0000 (76.6667)  time: 0.0072  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8570 s / it)
* Acc@1 76.667 loss 0.878 auroc 0.731 f1_score 0.320
Test  [  0/200]  eta: 0:01:42  loss: 2.5418 (2.5418)  acc1: 0.0000 (0.0000)  time: 0.5140  data: 0.5031  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2774 (0.8178)  acc1: 100.0000 (77.2277)  time: 0.0070  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2251 (0.7133)  acc1: 100.0000 (80.0000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0653 s / it)
* Acc@1 80.000 loss 0.713 auroc 0.753 f1_score 0.438


Epoch: [9]  [  0/269]  eta: 0:02:17  lr: 0.000098  bag_loss: 1.5887 (1.5887)  instance_loss: 0.9746 (0.9746)  time: 0.5109  data: 0.4948  max mem: 337
Epoch: [9]  [100/269]  eta: 0:00:03  lr: 0.000098  bag_loss: 0.2662 (0.7012)  instance_loss: 1.1000 (1.1620)  time: 0.0143  data: 0.0012  max mem: 337
Epoch: [9]  [200/269]  eta: 0:00:01  lr: 0.000097  bag_loss: 0.4729 (0.7209)  instance_loss: 1.0427 (1.1689)  time: 0.0139  data: 0.0011  max mem: 337
Epoch: [9]  [268/269]  eta: 0:00:00  lr: 0.000097  bag_loss: 0.3234 (0.7443)  instance_loss: 1.1218 (1.1644)  time: 0.0157  data: 0.0014  max mem: 337
Epoch: [9] Total time: 0:00:04 (4.3846 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4146 (0.4146)  acc1: 100.0000 (100.0000)  time: 0.5107  data: 0.4962  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3071 (0.8474)  acc1: 100.0000 (70.0000)  time: 0.0081  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.8518 s / it)
* Acc@1 70.000 loss 0.847 auroc 0.712 f1_score 0.280
Test  [  0/200]  eta: 0:01:41  loss: 1.6164 (1.6164)  acc1: 0.0000 (0.0000)  time: 0.5095  data: 0.4957  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3023 (0.7618)  acc1: 100.0000 (77.2277)  time: 0.0061  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2013 (0.6833)  acc1: 100.0000 (81.0000)  time: 0.0088  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0529 s / it)
* Acc@1 81.000 loss 0.683 auroc 0.767 f1_score 0.444


Epoch: [10]  [  0/269]  eta: 0:02:19  lr: 0.000097  bag_loss: 0.1212 (0.1212)  instance_loss: 0.9991 (0.9991)  time: 0.5169  data: 0.5031  max mem: 337
Epoch: [10]  [100/269]  eta: 0:00:03  lr: 0.000097  bag_loss: 0.1540 (0.6606)  instance_loss: 1.0544 (1.1229)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [10]  [200/269]  eta: 0:00:01  lr: 0.000096  bag_loss: 0.2042 (0.7027)  instance_loss: 1.0459 (1.1120)  time: 0.0134  data: 0.0012  max mem: 337
Epoch: [10]  [268/269]  eta: 0:00:00  lr: 0.000096  bag_loss: 0.2991 (0.7070)  instance_loss: 1.0889 (1.1195)  time: 0.0123  data: 0.0010  max mem: 337
Epoch: [10] Total time: 0:00:04 (4.4582 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4894 (0.4894)  acc1: 100.0000 (100.0000)  time: 0.5052  data: 0.4925  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2915 (0.8288)  acc1: 100.0000 (73.3333)  time: 0.0071  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8216 s / it)
* Acc@1 73.333 loss 0.829 auroc 0.696 f1_score 0.298
Test  [  0/200]  eta: 0:01:41  loss: 1.5689 (1.5689)  acc1: 0.0000 (0.0000)  time: 0.5098  data: 0.5016  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3518 (0.7120)  acc1: 100.0000 (77.2277)  time: 0.0059  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2538 (0.6430)  acc1: 100.0000 (80.0000)  time: 0.0081  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.0400 s / it)
* Acc@1 80.000 loss 0.643 auroc 0.778 f1_score 0.436


Epoch: [11]  [  0/269]  eta: 0:02:20  lr: 0.000096  bag_loss: 0.4424 (0.4424)  instance_loss: 0.9280 (0.9280)  time: 0.5229  data: 0.5072  max mem: 337
Epoch: [11]  [100/269]  eta: 0:00:03  lr: 0.000095  bag_loss: 0.2074 (0.7929)  instance_loss: 1.0391 (1.0573)  time: 0.0157  data: 0.0013  max mem: 337
Epoch: [11]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.1214 (0.7238)  instance_loss: 1.1759 (1.0800)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [11]  [268/269]  eta: 0:00:00  lr: 0.000094  bag_loss: 0.2474 (0.7042)  instance_loss: 0.9680 (1.0902)  time: 0.0163  data: 0.0012  max mem: 337
Epoch: [11] Total time: 0:00:04 (4.4433 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6940 (0.6940)  acc1: 100.0000 (100.0000)  time: 0.5048  data: 0.4916  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3816 (0.8019)  acc1: 100.0000 (80.0000)  time: 0.0077  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8649 s / it)
* Acc@1 80.000 loss 0.802 auroc 0.741 f1_score 0.391
Test  [  0/200]  eta: 0:01:40  loss: 0.8070 (0.8070)  acc1: 100.0000 (100.0000)  time: 0.5046  data: 0.4964  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4577 (0.7535)  acc1: 100.0000 (77.2277)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2362 (0.6660)  acc1: 100.0000 (81.0000)  time: 0.0084  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1060 s / it)
* Acc@1 81.000 loss 0.666 auroc 0.771 f1_score 0.521


Epoch: [12]  [  0/269]  eta: 0:02:21  lr: 0.000094  bag_loss: 1.5082 (1.5082)  instance_loss: 0.8020 (0.8020)  time: 0.5263  data: 0.5117  max mem: 337
Epoch: [12]  [100/269]  eta: 0:00:03  lr: 0.000094  bag_loss: 0.1710 (0.7004)  instance_loss: 1.0085 (1.0413)  time: 0.0159  data: 0.0012  max mem: 337
Epoch: [12]  [200/269]  eta: 0:00:01  lr: 0.000093  bag_loss: 0.1676 (0.6553)  instance_loss: 0.9888 (1.0452)  time: 0.0151  data: 0.0013  max mem: 337
Epoch: [12]  [268/269]  eta: 0:00:00  lr: 0.000092  bag_loss: 0.3906 (0.6650)  instance_loss: 0.9704 (1.0417)  time: 0.0155  data: 0.0012  max mem: 337
Epoch: [12] Total time: 0:00:04 (4.3245 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6544 (0.6544)  acc1: 100.0000 (100.0000)  time: 0.5085  data: 0.4967  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3713 (0.8362)  acc1: 100.0000 (73.3333)  time: 0.0072  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8223 s / it)
* Acc@1 73.333 loss 0.836 auroc 0.722 f1_score 0.298
Test  [  0/200]  eta: 0:01:43  loss: 1.0951 (1.0951)  acc1: 100.0000 (100.0000)  time: 0.5178  data: 0.5081  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4215 (0.7176)  acc1: 100.0000 (80.1980)  time: 0.0062  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2628 (0.6337)  acc1: 100.0000 (82.5000)  time: 0.0088  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1046 s / it)
* Acc@1 82.500 loss 0.634 auroc 0.775 f1_score 0.522


Epoch: [13]  [  0/269]  eta: 0:02:20  lr: 0.000092  bag_loss: 0.4682 (0.4682)  instance_loss: 0.8966 (0.8966)  time: 0.5236  data: 0.5116  max mem: 337
Epoch: [13]  [100/269]  eta: 0:00:03  lr: 0.000092  bag_loss: 0.8196 (0.8052)  instance_loss: 0.9626 (1.0594)  time: 0.0128  data: 0.0010  max mem: 337
Epoch: [13]  [200/269]  eta: 0:00:01  lr: 0.000091  bag_loss: 0.2571 (0.6319)  instance_loss: 1.0389 (1.0721)  time: 0.0125  data: 0.0012  max mem: 337
Epoch: [13]  [268/269]  eta: 0:00:00  lr: 0.000090  bag_loss: 0.2291 (0.6531)  instance_loss: 1.0024 (1.0716)  time: 0.0115  data: 0.0011  max mem: 337
Epoch: [13] Total time: 0:00:04 (4.3256 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.2749 (0.2749)  acc1: 100.0000 (100.0000)  time: 0.5112  data: 0.4996  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1441 (0.8733)  acc1: 100.0000 (76.6667)  time: 0.0080  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8649 s / it)
* Acc@1 76.667 loss 0.873 auroc 0.663 f1_score 0.320
Test  [  0/200]  eta: 0:01:42  loss: 1.6159 (1.6159)  acc1: 0.0000 (0.0000)  time: 0.5148  data: 0.5050  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1809 (0.7353)  acc1: 100.0000 (75.2475)  time: 0.0058  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1517 (0.6712)  acc1: 100.0000 (78.5000)  time: 0.0089  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.0615 s / it)
* Acc@1 78.500 loss 0.671 auroc 0.767 f1_score 0.434


Epoch: [14]  [  0/269]  eta: 0:02:17  lr: 0.000090  bag_loss: 0.1009 (0.1009)  instance_loss: 0.9579 (0.9579)  time: 0.5096  data: 0.4957  max mem: 337
Epoch: [14]  [100/269]  eta: 0:00:03  lr: 0.000090  bag_loss: 0.3900 (0.5632)  instance_loss: 1.0490 (1.0559)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [14]  [200/269]  eta: 0:00:01  lr: 0.000089  bag_loss: 0.2869 (0.5674)  instance_loss: 0.9643 (1.0207)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [14]  [268/269]  eta: 0:00:00  lr: 0.000088  bag_loss: 0.3030 (0.6701)  instance_loss: 0.9416 (1.0167)  time: 0.0140  data: 0.0012  max mem: 337
Epoch: [14] Total time: 0:00:04 (4.4359 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6224 (0.6224)  acc1: 100.0000 (100.0000)  time: 0.5234  data: 0.5106  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2833 (0.8163)  acc1: 100.0000 (76.6667)  time: 0.0084  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8734 s / it)
* Acc@1 76.667 loss 0.816 auroc 0.684 f1_score 0.320
Test  [  0/200]  eta: 0:01:42  loss: 1.1044 (1.1044)  acc1: 0.0000 (0.0000)  time: 0.5129  data: 0.5049  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3309 (0.6867)  acc1: 100.0000 (77.2277)  time: 0.0062  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2330 (0.6446)  acc1: 100.0000 (79.5000)  time: 0.0089  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.0747 s / it)
* Acc@1 79.500 loss 0.645 auroc 0.773 f1_score 0.485


Epoch: [15]  [  0/269]  eta: 0:02:16  lr: 0.000088  bag_loss: 0.0825 (0.0825)  instance_loss: 0.9936 (0.9936)  time: 0.5076  data: 0.4925  max mem: 337
Epoch: [15]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.1329 (0.5934)  instance_loss: 0.8779 (0.9468)  time: 0.0162  data: 0.0012  max mem: 337
Epoch: [15]  [200/269]  eta: 0:00:01  lr: 0.000087  bag_loss: 0.2509 (0.6628)  instance_loss: 0.9195 (0.9496)  time: 0.0151  data: 0.0012  max mem: 337
Epoch: [15]  [268/269]  eta: 0:00:00  lr: 0.000086  bag_loss: 0.2563 (0.6355)  instance_loss: 0.9394 (0.9476)  time: 0.0138  data: 0.0013  max mem: 337
Epoch: [15] Total time: 0:00:04 (4.4910 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.5271 (0.5271)  acc1: 100.0000 (100.0000)  time: 0.5171  data: 0.5035  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1953 (0.7860)  acc1: 100.0000 (76.6667)  time: 0.0078  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8521 s / it)
* Acc@1 76.667 loss 0.786 auroc 0.726 f1_score 0.320
Test  [  0/200]  eta: 0:01:42  loss: 0.4796 (0.4796)  acc1: 100.0000 (100.0000)  time: 0.5126  data: 0.5032  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4096 (0.7581)  acc1: 100.0000 (71.2871)  time: 0.0068  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1509 (0.6822)  acc1: 100.0000 (76.0000)  time: 0.0096  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1011 s / it)
* Acc@1 76.000 loss 0.682 auroc 0.768 f1_score 0.500


Epoch: [16]  [  0/269]  eta: 0:02:19  lr: 0.000086  bag_loss: 0.3401 (0.3401)  instance_loss: 1.0022 (1.0022)  time: 0.5170  data: 0.5049  max mem: 337
Epoch: [16]  [100/269]  eta: 0:00:03  lr: 0.000085  bag_loss: 0.1362 (0.5802)  instance_loss: 0.9648 (0.9667)  time: 0.0136  data: 0.0013  max mem: 337
Epoch: [16]  [200/269]  eta: 0:00:01  lr: 0.000084  bag_loss: 0.3155 (0.6178)  instance_loss: 0.8321 (0.9520)  time: 0.0151  data: 0.0012  max mem: 337
Epoch: [16]  [268/269]  eta: 0:00:00  lr: 0.000083  bag_loss: 0.2666 (0.6104)  instance_loss: 0.9318 (0.9331)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [16] Total time: 0:00:04 (4.3574 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.5314 (0.5314)  acc1: 100.0000 (100.0000)  time: 0.5129  data: 0.5026  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2167 (0.8131)  acc1: 100.0000 (76.6667)  time: 0.0076  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8358 s / it)
* Acc@1 76.667 loss 0.813 auroc 0.722 f1_score 0.320
Test  [  0/200]  eta: 0:01:45  loss: 0.6623 (0.6623)  acc1: 100.0000 (100.0000)  time: 0.5275  data: 0.5193  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2262 (0.6913)  acc1: 100.0000 (78.2178)  time: 0.0056  data: 0.0008  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1638 (0.6410)  acc1: 100.0000 (80.0000)  time: 0.0100  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.1229 s / it)
* Acc@1 80.000 loss 0.641 auroc 0.780 f1_score 0.502


Epoch: [17]  [  0/269]  eta: 0:02:22  lr: 0.000083  bag_loss: 0.3257 (0.3257)  instance_loss: 1.1009 (1.1009)  time: 0.5282  data: 0.5093  max mem: 337
Epoch: [17]  [100/269]  eta: 0:00:03  lr: 0.000082  bag_loss: 0.3568 (0.6540)  instance_loss: 0.8304 (0.8947)  time: 0.0132  data: 0.0012  max mem: 337
Epoch: [17]  [200/269]  eta: 0:00:01  lr: 0.000081  bag_loss: 0.2194 (0.5984)  instance_loss: 0.8330 (0.8683)  time: 0.0133  data: 0.0012  max mem: 337
Epoch: [17]  [268/269]  eta: 0:00:00  lr: 0.000081  bag_loss: 0.2009 (0.5962)  instance_loss: 0.8670 (0.8666)  time: 0.0143  data: 0.0011  max mem: 337
Epoch: [17] Total time: 0:00:04 (4.4480 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4369 (0.4369)  acc1: 100.0000 (100.0000)  time: 0.5117  data: 0.4978  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1342 (0.8366)  acc1: 100.0000 (76.6667)  time: 0.0078  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8474 s / it)
* Acc@1 76.667 loss 0.837 auroc 0.701 f1_score 0.320
Test  [  0/200]  eta: 0:01:41  loss: 1.1394 (1.1394)  acc1: 0.0000 (0.0000)  time: 0.5079  data: 0.4995  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1841 (0.6977)  acc1: 100.0000 (77.2277)  time: 0.0067  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1462 (0.6820)  acc1: 100.0000 (77.5000)  time: 0.0092  data: 0.0012  max mem: 337
Test Total time: 0:00:05 (5.1933 s / it)
* Acc@1 77.500 loss 0.682 auroc 0.776 f1_score 0.445


Epoch: [18]  [  0/269]  eta: 0:02:23  lr: 0.000081  bag_loss: 1.7160 (1.7160)  instance_loss: 0.9473 (0.9473)  time: 0.5322  data: 0.5158  max mem: 337
Epoch: [18]  [100/269]  eta: 0:00:03  lr: 0.000080  bag_loss: 0.1245 (0.6329)  instance_loss: 0.8978 (0.8987)  time: 0.0149  data: 0.0011  max mem: 337
Epoch: [18]  [200/269]  eta: 0:00:01  lr: 0.000079  bag_loss: 0.1427 (0.6084)  instance_loss: 0.9717 (0.9182)  time: 0.0166  data: 0.0014  max mem: 337
Epoch: [18]  [268/269]  eta: 0:00:00  lr: 0.000078  bag_loss: 0.2241 (0.6035)  instance_loss: 0.8952 (0.9105)  time: 0.0134  data: 0.0011  max mem: 337
Epoch: [18] Total time: 0:00:04 (4.4383 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4428 (0.4428)  acc1: 100.0000 (100.0000)  time: 0.5329  data: 0.5230  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2112 (0.8217)  acc1: 100.0000 (76.6667)  time: 0.0075  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8611 s / it)
* Acc@1 76.667 loss 0.822 auroc 0.717 f1_score 0.320
Test  [  0/200]  eta: 0:01:41  loss: 0.7411 (0.7411)  acc1: 100.0000 (100.0000)  time: 0.5052  data: 0.4962  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2051 (0.7232)  acc1: 100.0000 (79.2079)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1492 (0.6380)  acc1: 100.0000 (80.5000)  time: 0.0088  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.0841 s / it)
* Acc@1 80.500 loss 0.638 auroc 0.781 f1_score 0.505


Epoch: [19]  [  0/269]  eta: 0:02:16  lr: 0.000078  bag_loss: 0.0531 (0.0531)  instance_loss: 0.6379 (0.6379)  time: 0.5078  data: 0.4925  max mem: 337
Epoch: [19]  [100/269]  eta: 0:00:03  lr: 0.000077  bag_loss: 0.1841 (0.5640)  instance_loss: 0.7910 (0.8820)  time: 0.0168  data: 0.0012  max mem: 337
Epoch: [19]  [200/269]  eta: 0:00:01  lr: 0.000076  bag_loss: 0.6684 (0.5863)  instance_loss: 0.8151 (0.8790)  time: 0.0118  data: 0.0010  max mem: 337
Epoch: [19]  [268/269]  eta: 0:00:00  lr: 0.000075  bag_loss: 0.6191 (0.6122)  instance_loss: 0.9571 (0.8917)  time: 0.0134  data: 0.0012  max mem: 337
Epoch: [19] Total time: 0:00:04 (4.4327 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6236 (0.6236)  acc1: 100.0000 (100.0000)  time: 0.5089  data: 0.4980  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2359 (0.8155)  acc1: 100.0000 (76.6667)  time: 0.0071  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.8437 s / it)
* Acc@1 76.667 loss 0.816 auroc 0.731 f1_score 0.320
Test  [  0/200]  eta: 0:01:39  loss: 0.6464 (0.6464)  acc1: 100.0000 (100.0000)  time: 0.4982  data: 0.4894  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4178 (0.6996)  acc1: 100.0000 (75.2475)  time: 0.0060  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2420 (0.6618)  acc1: 100.0000 (77.5000)  time: 0.0099  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.1377 s / it)
* Acc@1 77.500 loss 0.662 auroc 0.782 f1_score 0.545


Epoch: [20]  [  0/269]  eta: 0:02:25  lr: 0.000075  bag_loss: 0.1464 (0.1464)  instance_loss: 0.9002 (0.9002)  time: 0.5407  data: 0.5109  max mem: 337
Epoch: [20]  [100/269]  eta: 0:00:03  lr: 0.000074  bag_loss: 0.1952 (0.6566)  instance_loss: 0.9354 (0.9124)  time: 0.0158  data: 0.0014  max mem: 337
Epoch: [20]  [200/269]  eta: 0:00:01  lr: 0.000073  bag_loss: 0.1715 (0.5615)  instance_loss: 0.8337 (0.8858)  time: 0.0144  data: 0.0011  max mem: 337
Epoch: [20]  [268/269]  eta: 0:00:00  lr: 0.000072  bag_loss: 0.3627 (0.5811)  instance_loss: 0.9011 (0.8832)  time: 0.0124  data: 0.0010  max mem: 337
Epoch: [20] Total time: 0:00:04 (4.4578 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6517 (0.6517)  acc1: 100.0000 (100.0000)  time: 0.5147  data: 0.5043  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1973 (0.8194)  acc1: 100.0000 (76.6667)  time: 0.0075  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8501 s / it)
* Acc@1 76.667 loss 0.819 auroc 0.707 f1_score 0.320
Test  [  0/200]  eta: 0:01:40  loss: 0.4421 (0.4421)  acc1: 100.0000 (100.0000)  time: 0.5035  data: 0.4930  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3509 (0.7318)  acc1: 100.0000 (75.2475)  time: 0.0065  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1901 (0.6653)  acc1: 100.0000 (78.0000)  time: 0.0086  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0589 s / it)
* Acc@1 78.000 loss 0.665 auroc 0.783 f1_score 0.529


Epoch: [21]  [  0/269]  eta: 0:02:17  lr: 0.000072  bag_loss: 0.6675 (0.6675)  instance_loss: 0.7444 (0.7444)  time: 0.5109  data: 0.4972  max mem: 337
Epoch: [21]  [100/269]  eta: 0:00:03  lr: 0.000071  bag_loss: 0.1620 (0.6255)  instance_loss: 0.8092 (0.8833)  time: 0.0145  data: 0.0012  max mem: 337
Epoch: [21]  [200/269]  eta: 0:00:01  lr: 0.000070  bag_loss: 0.2216 (0.5895)  instance_loss: 0.9198 (0.8817)  time: 0.0153  data: 0.0012  max mem: 337
Epoch: [21]  [268/269]  eta: 0:00:00  lr: 0.000069  bag_loss: 0.4125 (0.5879)  instance_loss: 0.9545 (0.9001)  time: 0.0110  data: 0.0010  max mem: 337
Epoch: [21] Total time: 0:00:04 (4.4478 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6467 (0.6467)  acc1: 100.0000 (100.0000)  time: 0.5077  data: 0.4969  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3005 (0.8125)  acc1: 100.0000 (76.6667)  time: 0.0077  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8318 s / it)
* Acc@1 76.667 loss 0.812 auroc 0.745 f1_score 0.320
Test  [  0/200]  eta: 0:01:42  loss: 0.7439 (0.7439)  acc1: 100.0000 (100.0000)  time: 0.5119  data: 0.5027  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4979 (0.7655)  acc1: 100.0000 (70.2970)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1754 (0.6553)  acc1: 100.0000 (77.0000)  time: 0.0092  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.0880 s / it)
* Acc@1 77.000 loss 0.655 auroc 0.780 f1_score 0.526


Epoch: [22]  [  0/269]  eta: 0:02:20  lr: 0.000069  bag_loss: 0.0651 (0.0651)  instance_loss: 0.8580 (0.8580)  time: 0.5229  data: 0.5066  max mem: 337
Epoch: [22]  [100/269]  eta: 0:00:03  lr: 0.000068  bag_loss: 0.1985 (0.5219)  instance_loss: 0.8804 (0.9033)  time: 0.0125  data: 0.0012  max mem: 337
Epoch: [22]  [200/269]  eta: 0:00:01  lr: 0.000066  bag_loss: 0.3873 (0.5607)  instance_loss: 0.9181 (0.9154)  time: 0.0122  data: 0.0010  max mem: 337
Epoch: [22]  [268/269]  eta: 0:00:00  lr: 0.000065  bag_loss: 0.1512 (0.5713)  instance_loss: 0.9108 (0.9044)  time: 0.0126  data: 0.0011  max mem: 337
Epoch: [22] Total time: 0:00:04 (4.4561 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 1.0573 (1.0573)  acc1: 0.0000 (0.0000)  time: 0.5383  data: 0.5271  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3801 (0.8412)  acc1: 100.0000 (70.0000)  time: 0.0075  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8638 s / it)
* Acc@1 70.000 loss 0.841 auroc 0.723 f1_score 0.308
Test  [  0/200]  eta: 0:01:44  loss: 0.1645 (0.1645)  acc1: 100.0000 (100.0000)  time: 0.5218  data: 0.5086  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7718 (0.8385)  acc1: 100.0000 (69.3069)  time: 0.0066  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2417 (0.7109)  acc1: 100.0000 (76.0000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1002 s / it)
* Acc@1 76.000 loss 0.711 auroc 0.785 f1_score 0.517


Epoch: [23]  [  0/269]  eta: 0:02:16  lr: 0.000065  bag_loss: 0.3103 (0.3103)  instance_loss: 1.0612 (1.0612)  time: 0.5085  data: 0.4939  max mem: 337
Epoch: [23]  [100/269]  eta: 0:00:03  lr: 0.000064  bag_loss: 0.1747 (0.5837)  instance_loss: 0.9134 (0.9170)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [23]  [200/269]  eta: 0:00:01  lr: 0.000063  bag_loss: 0.2661 (0.5774)  instance_loss: 0.9345 (0.9244)  time: 0.0163  data: 0.0012  max mem: 337
Epoch: [23]  [268/269]  eta: 0:00:00  lr: 0.000062  bag_loss: 0.1389 (0.5519)  instance_loss: 0.9517 (0.9356)  time: 0.0157  data: 0.0013  max mem: 337
Epoch: [23] Total time: 0:00:04 (4.4283 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6350 (0.6350)  acc1: 100.0000 (100.0000)  time: 0.5181  data: 0.5060  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1440 (0.8765)  acc1: 100.0000 (76.6667)  time: 0.0083  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8562 s / it)
* Acc@1 76.667 loss 0.876 auroc 0.685 f1_score 0.320
Test  [  0/200]  eta: 0:01:46  loss: 0.4715 (0.4715)  acc1: 100.0000 (100.0000)  time: 0.5349  data: 0.5274  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4536 (0.8969)  acc1: 100.0000 (68.3168)  time: 0.0058  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1651 (0.7431)  acc1: 100.0000 (73.5000)  time: 0.0086  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1176 s / it)
* Acc@1 73.500 loss 0.743 auroc 0.766 f1_score 0.523


Epoch: [24]  [  0/269]  eta: 0:02:19  lr: 0.000062  bag_loss: 0.3144 (0.3144)  instance_loss: 0.9218 (0.9218)  time: 0.5175  data: 0.4958  max mem: 337
Epoch: [24]  [100/269]  eta: 0:00:03  lr: 0.000061  bag_loss: 0.1766 (0.5299)  instance_loss: 0.9437 (0.9439)  time: 0.0144  data: 0.0010  max mem: 337
Epoch: [24]  [200/269]  eta: 0:00:01  lr: 0.000060  bag_loss: 0.1510 (0.5445)  instance_loss: 0.9143 (0.9403)  time: 0.0156  data: 0.0013  max mem: 337
Epoch: [24]  [268/269]  eta: 0:00:00  lr: 0.000059  bag_loss: 0.5419 (0.5544)  instance_loss: 0.8931 (0.9425)  time: 0.0119  data: 0.0009  max mem: 337
Epoch: [24] Total time: 0:00:04 (4.3508 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6326 (0.6326)  acc1: 100.0000 (100.0000)  time: 0.5184  data: 0.5052  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2381 (0.8226)  acc1: 100.0000 (76.6667)  time: 0.0078  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8510 s / it)
* Acc@1 76.667 loss 0.823 auroc 0.709 f1_score 0.320
Test  [  0/200]  eta: 0:01:40  loss: 0.4059 (0.4059)  acc1: 100.0000 (100.0000)  time: 0.5035  data: 0.4794  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3413 (0.7497)  acc1: 100.0000 (76.2376)  time: 0.0061  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1513 (0.6441)  acc1: 100.0000 (80.0000)  time: 0.0088  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.0959 s / it)
* Acc@1 80.000 loss 0.644 auroc 0.787 f1_score 0.528


Epoch: [25]  [  0/269]  eta: 0:02:17  lr: 0.000059  bag_loss: 0.2839 (0.2839)  instance_loss: 0.9319 (0.9319)  time: 0.5120  data: 0.4976  max mem: 337
Epoch: [25]  [100/269]  eta: 0:00:03  lr: 0.000057  bag_loss: 0.1596 (0.4994)  instance_loss: 0.9427 (0.9314)  time: 0.0133  data: 0.0011  max mem: 337
Epoch: [25]  [200/269]  eta: 0:00:01  lr: 0.000056  bag_loss: 0.1460 (0.5306)  instance_loss: 0.9403 (0.9326)  time: 0.0176  data: 0.0013  max mem: 337
Epoch: [25]  [268/269]  eta: 0:00:00  lr: 0.000055  bag_loss: 0.3151 (0.5277)  instance_loss: 0.9434 (0.9350)  time: 0.0119  data: 0.0010  max mem: 337
Epoch: [25] Total time: 0:00:04 (4.4100 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.8464 (0.8464)  acc1: 0.0000 (0.0000)  time: 0.5516  data: 0.5390  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2452 (0.8503)  acc1: 100.0000 (70.0000)  time: 0.0083  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8944 s / it)
* Acc@1 70.000 loss 0.850 auroc 0.698 f1_score 0.308
Test  [  0/200]  eta: 0:01:43  loss: 0.1907 (0.1907)  acc1: 100.0000 (100.0000)  time: 0.5196  data: 0.5121  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5145 (0.8585)  acc1: 100.0000 (70.2970)  time: 0.0067  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2008 (0.7197)  acc1: 100.0000 (75.0000)  time: 0.0089  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.4744 s / it)
* Acc@1 75.000 loss 0.720 auroc 0.778 f1_score 0.517


Epoch: [26]  [  0/269]  eta: 0:02:17  lr: 0.000055  bag_loss: 1.7215 (1.7215)  instance_loss: 0.9462 (0.9462)  time: 0.5114  data: 0.4974  max mem: 337
Epoch: [26]  [100/269]  eta: 0:00:03  lr: 0.000054  bag_loss: 0.3379 (0.5750)  instance_loss: 0.9428 (0.9200)  time: 0.0117  data: 0.0010  max mem: 337
Epoch: [26]  [200/269]  eta: 0:00:01  lr: 0.000053  bag_loss: 0.2793 (0.5496)  instance_loss: 0.8575 (0.9121)  time: 0.0126  data: 0.0010  max mem: 337
Epoch: [26]  [268/269]  eta: 0:00:00  lr: 0.000052  bag_loss: 0.1500 (0.5316)  instance_loss: 0.7835 (0.8966)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [26] Total time: 0:00:04 (4.3254 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.4177 (0.4177)  acc1: 100.0000 (100.0000)  time: 0.5115  data: 0.5011  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1448 (0.8183)  acc1: 100.0000 (76.6667)  time: 0.0079  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8639 s / it)
* Acc@1 76.667 loss 0.818 auroc 0.716 f1_score 0.320
Test  [  0/200]  eta: 0:01:42  loss: 0.5112 (0.5112)  acc1: 100.0000 (100.0000)  time: 0.5114  data: 0.5027  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1958 (0.8023)  acc1: 100.0000 (79.2079)  time: 0.0066  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1103 (0.6683)  acc1: 100.0000 (81.0000)  time: 0.0084  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0757 s / it)
* Acc@1 81.000 loss 0.668 auroc 0.782 f1_score 0.521


Epoch: [27]  [  0/269]  eta: 0:02:20  lr: 0.000052  bag_loss: 1.8843 (1.8843)  instance_loss: 1.0743 (1.0743)  time: 0.5210  data: 0.5059  max mem: 337
Epoch: [27]  [100/269]  eta: 0:00:03  lr: 0.000050  bag_loss: 0.1436 (0.4858)  instance_loss: 0.8105 (0.8493)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [27]  [200/269]  eta: 0:00:01  lr: 0.000049  bag_loss: 0.2385 (0.4993)  instance_loss: 0.9262 (0.8658)  time: 0.0130  data: 0.0010  max mem: 337
Epoch: [27]  [268/269]  eta: 0:00:00  lr: 0.000048  bag_loss: 0.1522 (0.5278)  instance_loss: 0.8204 (0.8710)  time: 0.0157  data: 0.0015  max mem: 337
Epoch: [27] Total time: 0:00:04 (4.4127 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.5125 (0.5125)  acc1: 100.0000 (100.0000)  time: 0.5142  data: 0.5021  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2090 (0.8649)  acc1: 100.0000 (76.6667)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8303 s / it)
* Acc@1 76.667 loss 0.865 auroc 0.700 f1_score 0.320
Test  [  0/200]  eta: 0:01:41  loss: 0.3221 (0.3221)  acc1: 100.0000 (100.0000)  time: 0.5096  data: 0.5013  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3188 (0.8530)  acc1: 100.0000 (71.2871)  time: 0.0063  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1468 (0.7013)  acc1: 100.0000 (76.0000)  time: 0.0097  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1350 s / it)
* Acc@1 76.000 loss 0.701 auroc 0.779 f1_score 0.512


Epoch: [28]  [  0/269]  eta: 0:02:22  lr: 0.000048  bag_loss: 0.3436 (0.3436)  instance_loss: 0.8569 (0.8569)  time: 0.5286  data: 0.5010  max mem: 337
Epoch: [28]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.1041 (0.4200)  instance_loss: 0.8721 (0.9014)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [28]  [200/269]  eta: 0:00:01  lr: 0.000046  bag_loss: 0.2624 (0.5160)  instance_loss: 0.8595 (0.8966)  time: 0.0158  data: 0.0013  max mem: 337
Epoch: [28]  [268/269]  eta: 0:00:00  lr: 0.000045  bag_loss: 0.4077 (0.5070)  instance_loss: 0.7974 (0.8802)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [28] Total time: 0:00:04 (4.4527 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6086 (0.6086)  acc1: 100.0000 (100.0000)  time: 0.5315  data: 0.5201  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2405 (0.8211)  acc1: 100.0000 (76.6667)  time: 0.0081  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8751 s / it)
* Acc@1 76.667 loss 0.821 auroc 0.736 f1_score 0.402
Test  [  0/200]  eta: 0:01:47  loss: 0.8153 (0.8153)  acc1: 0.0000 (0.0000)  time: 0.5364  data: 0.5274  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3516 (0.8436)  acc1: 100.0000 (72.2772)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0965 (0.6762)  acc1: 100.0000 (78.0000)  time: 0.0088  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.0850 s / it)
* Acc@1 78.000 loss 0.676 auroc 0.779 f1_score 0.505


Epoch: [29]  [  0/269]  eta: 0:02:25  lr: 0.000045  bag_loss: 0.1391 (0.1391)  instance_loss: 0.9138 (0.9138)  time: 0.5408  data: 0.5296  max mem: 337
Epoch: [29]  [100/269]  eta: 0:00:03  lr: 0.000043  bag_loss: 0.1859 (0.4945)  instance_loss: 0.8714 (0.8602)  time: 0.0120  data: 0.0011  max mem: 337
Epoch: [29]  [200/269]  eta: 0:00:01  lr: 0.000042  bag_loss: 0.1654 (0.4823)  instance_loss: 0.8326 (0.8675)  time: 0.0139  data: 0.0012  max mem: 337
Epoch: [29]  [268/269]  eta: 0:00:00  lr: 0.000041  bag_loss: 0.1076 (0.5203)  instance_loss: 0.8838 (0.8675)  time: 0.0173  data: 0.0012  max mem: 337
Epoch: [29] Total time: 0:00:04 (4.3445 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.7628 (0.7628)  acc1: 0.0000 (0.0000)  time: 0.5347  data: 0.5239  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2767 (0.8591)  acc1: 100.0000 (70.0000)  time: 0.0074  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8650 s / it)
* Acc@1 70.000 loss 0.859 auroc 0.708 f1_score 0.308
Test  [  0/200]  eta: 0:01:35  loss: 0.1879 (0.1879)  acc1: 100.0000 (100.0000)  time: 0.4795  data: 0.4712  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4449 (0.8819)  acc1: 100.0000 (69.3069)  time: 0.0058  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2349 (0.7384)  acc1: 100.0000 (75.0000)  time: 0.0099  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.0559 s / it)
* Acc@1 75.000 loss 0.738 auroc 0.778 f1_score 0.514


Epoch: [30]  [  0/269]  eta: 0:02:14  lr: 0.000041  bag_loss: 0.5904 (0.5904)  instance_loss: 0.9372 (0.9372)  time: 0.5016  data: 0.4797  max mem: 337
Epoch: [30]  [100/269]  eta: 0:00:03  lr: 0.000040  bag_loss: 0.2158 (0.5049)  instance_loss: 0.8346 (0.8827)  time: 0.0127  data: 0.0012  max mem: 337
Epoch: [30]  [200/269]  eta: 0:00:01  lr: 0.000039  bag_loss: 0.2394 (0.5010)  instance_loss: 0.8211 (0.8759)  time: 0.0122  data: 0.0010  max mem: 337
Epoch: [30]  [268/269]  eta: 0:00:00  lr: 0.000038  bag_loss: 0.1299 (0.4812)  instance_loss: 0.8591 (0.8653)  time: 0.0159  data: 0.0013  max mem: 337
Epoch: [30] Total time: 0:00:04 (4.2831 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7275 (0.7275)  acc1: 100.0000 (100.0000)  time: 0.5065  data: 0.4941  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2652 (0.8589)  acc1: 100.0000 (76.6667)  time: 0.0074  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8534 s / it)
* Acc@1 76.667 loss 0.859 auroc 0.723 f1_score 0.402
Test  [  0/200]  eta: 0:01:45  loss: 0.2125 (0.2125)  acc1: 100.0000 (100.0000)  time: 0.5285  data: 0.5208  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4098 (0.8899)  acc1: 100.0000 (71.2871)  time: 0.0059  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1147 (0.7130)  acc1: 100.0000 (77.0000)  time: 0.0090  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0791 s / it)
* Acc@1 77.000 loss 0.713 auroc 0.780 f1_score 0.522


Epoch: [31]  [  0/269]  eta: 0:02:17  lr: 0.000038  bag_loss: 0.2299 (0.2299)  instance_loss: 0.9892 (0.9892)  time: 0.5102  data: 0.4944  max mem: 337
Epoch: [31]  [100/269]  eta: 0:00:03  lr: 0.000037  bag_loss: 0.0979 (0.3683)  instance_loss: 0.8257 (0.8472)  time: 0.0119  data: 0.0010  max mem: 337
Epoch: [31]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.4894 (0.4544)  instance_loss: 0.9131 (0.8838)  time: 0.0137  data: 0.0011  max mem: 337
Epoch: [31]  [268/269]  eta: 0:00:00  lr: 0.000035  bag_loss: 0.3513 (0.4811)  instance_loss: 0.9443 (0.8995)  time: 0.0137  data: 0.0010  max mem: 337
Epoch: [31] Total time: 0:00:04 (4.4290 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8731 (0.8731)  acc1: 0.0000 (0.0000)  time: 0.5246  data: 0.5142  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3091 (0.8659)  acc1: 100.0000 (73.3333)  time: 0.0078  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8762 s / it)
* Acc@1 73.333 loss 0.866 auroc 0.727 f1_score 0.384
Test  [  0/200]  eta: 0:01:37  loss: 0.1713 (0.1713)  acc1: 100.0000 (100.0000)  time: 0.4852  data: 0.4742  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5442 (0.9135)  acc1: 100.0000 (68.3168)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1322 (0.7280)  acc1: 100.0000 (76.0000)  time: 0.0083  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0620 s / it)
* Acc@1 76.000 loss 0.728 auroc 0.781 f1_score 0.526


Epoch: [32]  [  0/269]  eta: 0:02:18  lr: 0.000035  bag_loss: 0.0057 (0.0057)  instance_loss: 1.0472 (1.0472)  time: 0.5160  data: 0.4965  max mem: 337
Epoch: [32]  [100/269]  eta: 0:00:03  lr: 0.000033  bag_loss: 0.1251 (0.4170)  instance_loss: 0.8294 (0.8986)  time: 0.0144  data: 0.0012  max mem: 337
Epoch: [32]  [200/269]  eta: 0:00:01  lr: 0.000032  bag_loss: 0.1697 (0.4223)  instance_loss: 0.9037 (0.8887)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [32]  [268/269]  eta: 0:00:00  lr: 0.000031  bag_loss: 0.2318 (0.4684)  instance_loss: 0.8259 (0.8923)  time: 0.0122  data: 0.0011  max mem: 337
Epoch: [32] Total time: 0:00:04 (4.3942 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 1.0323 (1.0323)  acc1: 0.0000 (0.0000)  time: 0.5128  data: 0.5015  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2959 (0.8736)  acc1: 100.0000 (73.3333)  time: 0.0083  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.8516 s / it)
* Acc@1 73.333 loss 0.874 auroc 0.733 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.1098 (0.1098)  acc1: 100.0000 (100.0000)  time: 0.5120  data: 0.5033  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4703 (0.9513)  acc1: 100.0000 (69.3069)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1413 (0.7528)  acc1: 100.0000 (76.0000)  time: 0.0086  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.0769 s / it)
* Acc@1 76.000 loss 0.753 auroc 0.782 f1_score 0.509


Epoch: [33]  [  0/269]  eta: 0:02:19  lr: 0.000031  bag_loss: 0.2315 (0.2315)  instance_loss: 0.9016 (0.9016)  time: 0.5177  data: 0.5009  max mem: 337
Epoch: [33]  [100/269]  eta: 0:00:03  lr: 0.000030  bag_loss: 0.1366 (0.5165)  instance_loss: 0.8222 (0.8831)  time: 0.0128  data: 0.0010  max mem: 337
Epoch: [33]  [200/269]  eta: 0:00:01  lr: 0.000029  bag_loss: 0.1859 (0.4506)  instance_loss: 0.8416 (0.8778)  time: 0.0154  data: 0.0012  max mem: 337
Epoch: [33]  [268/269]  eta: 0:00:00  lr: 0.000028  bag_loss: 0.2026 (0.4643)  instance_loss: 0.9767 (0.8787)  time: 0.0173  data: 0.0014  max mem: 337
Epoch: [33] Total time: 0:00:04 (4.4867 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.6160 (0.6160)  acc1: 100.0000 (100.0000)  time: 0.5175  data: 0.5059  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1886 (0.8671)  acc1: 100.0000 (76.6667)  time: 0.0080  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8563 s / it)
* Acc@1 76.667 loss 0.867 auroc 0.714 f1_score 0.320
Test  [  0/200]  eta: 0:01:40  loss: 0.2304 (0.2304)  acc1: 100.0000 (100.0000)  time: 0.5029  data: 0.4934  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2777 (0.9158)  acc1: 100.0000 (72.2772)  time: 0.0059  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0971 (0.7192)  acc1: 100.0000 (78.0000)  time: 0.0085  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0646 s / it)
* Acc@1 78.000 loss 0.719 auroc 0.777 f1_score 0.539


Epoch: [34]  [  0/269]  eta: 0:02:16  lr: 0.000028  bag_loss: 0.2881 (0.2881)  instance_loss: 0.6464 (0.6464)  time: 0.5075  data: 0.4956  max mem: 337
Epoch: [34]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.2181 (0.4773)  instance_loss: 0.8197 (0.8570)  time: 0.0141  data: 0.0011  max mem: 337
Epoch: [34]  [200/269]  eta: 0:00:01  lr: 0.000026  bag_loss: 0.1254 (0.4483)  instance_loss: 0.8493 (0.8623)  time: 0.0113  data: 0.0009  max mem: 337
Epoch: [34]  [268/269]  eta: 0:00:00  lr: 0.000025  bag_loss: 0.2038 (0.4528)  instance_loss: 0.8091 (0.8628)  time: 0.0130  data: 0.0010  max mem: 337
Epoch: [34] Total time: 0:00:05 (5.1744 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.9596 (0.9596)  acc1: 0.0000 (0.0000)  time: 0.5389  data: 0.5269  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2703 (0.8742)  acc1: 100.0000 (70.0000)  time: 0.0075  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8835 s / it)
* Acc@1 70.000 loss 0.874 auroc 0.741 f1_score 0.361
Test  [  0/200]  eta: 0:01:42  loss: 0.2183 (0.2183)  acc1: 100.0000 (100.0000)  time: 0.5126  data: 0.5028  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5707 (0.9788)  acc1: 100.0000 (68.3168)  time: 0.0068  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1137 (0.7502)  acc1: 100.0000 (77.0000)  time: 0.0085  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0744 s / it)
* Acc@1 77.000 loss 0.750 auroc 0.779 f1_score 0.539


Epoch: [35]  [  0/269]  eta: 0:02:26  lr: 0.000025  bag_loss: 0.2103 (0.2103)  instance_loss: 1.0081 (1.0081)  time: 0.5430  data: 0.5173  max mem: 337
Epoch: [35]  [100/269]  eta: 0:00:03  lr: 0.000024  bag_loss: 0.1580 (0.4341)  instance_loss: 0.8075 (0.8725)  time: 0.0156  data: 0.0011  max mem: 337
Epoch: [35]  [200/269]  eta: 0:00:01  lr: 0.000023  bag_loss: 0.1520 (0.4598)  instance_loss: 0.8210 (0.8751)  time: 0.0153  data: 0.0011  max mem: 337
Epoch: [35]  [268/269]  eta: 0:00:00  lr: 0.000022  bag_loss: 0.3005 (0.4638)  instance_loss: 0.8534 (0.8749)  time: 0.0137  data: 0.0011  max mem: 337
Epoch: [35] Total time: 0:00:04 (4.3809 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8878 (0.8878)  acc1: 0.0000 (0.0000)  time: 0.5048  data: 0.4841  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2688 (0.8834)  acc1: 100.0000 (73.3333)  time: 0.0077  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8374 s / it)
* Acc@1 73.333 loss 0.883 auroc 0.741 f1_score 0.384
Test  [  0/200]  eta: 0:01:43  loss: 0.2435 (0.2435)  acc1: 100.0000 (100.0000)  time: 0.5179  data: 0.5094  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4609 (0.9998)  acc1: 100.0000 (65.3465)  time: 0.0059  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1093 (0.7607)  acc1: 100.0000 (74.5000)  time: 0.0086  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0365 s / it)
* Acc@1 74.500 loss 0.761 auroc 0.776 f1_score 0.531


Epoch: [36]  [  0/269]  eta: 0:02:17  lr: 0.000022  bag_loss: 0.4092 (0.4092)  instance_loss: 0.8398 (0.8398)  time: 0.5124  data: 0.4977  max mem: 337
Epoch: [36]  [100/269]  eta: 0:00:03  lr: 0.000021  bag_loss: 0.2400 (0.4367)  instance_loss: 0.8143 (0.8395)  time: 0.0114  data: 0.0010  max mem: 337
Epoch: [36]  [200/269]  eta: 0:00:01  lr: 0.000020  bag_loss: 0.2539 (0.4495)  instance_loss: 0.8703 (0.8485)  time: 0.0139  data: 0.0011  max mem: 337
Epoch: [36]  [268/269]  eta: 0:00:00  lr: 0.000019  bag_loss: 0.2921 (0.4613)  instance_loss: 0.8167 (0.8621)  time: 0.0150  data: 0.0012  max mem: 337
Epoch: [36] Total time: 0:00:04 (4.3615 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8814 (0.8814)  acc1: 0.0000 (0.0000)  time: 0.5163  data: 0.5057  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2758 (0.8681)  acc1: 100.0000 (73.3333)  time: 0.0081  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8638 s / it)
* Acc@1 73.333 loss 0.868 auroc 0.741 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.2298 (0.2298)  acc1: 100.0000 (100.0000)  time: 0.5124  data: 0.4962  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5485 (0.9336)  acc1: 100.0000 (68.3168)  time: 0.0069  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1290 (0.7304)  acc1: 100.0000 (77.0000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0905 s / it)
* Acc@1 77.000 loss 0.730 auroc 0.779 f1_score 0.542


Epoch: [37]  [  0/269]  eta: 0:02:25  lr: 0.000019  bag_loss: 0.3578 (0.3578)  instance_loss: 0.9159 (0.9159)  time: 0.5398  data: 0.5098  max mem: 337
Epoch: [37]  [100/269]  eta: 0:00:03  lr: 0.000018  bag_loss: 0.2253 (0.3861)  instance_loss: 0.8346 (0.8519)  time: 0.0131  data: 0.0010  max mem: 337
Epoch: [37]  [200/269]  eta: 0:00:01  lr: 0.000017  bag_loss: 0.1176 (0.4587)  instance_loss: 0.8049 (0.8651)  time: 0.0156  data: 0.0014  max mem: 337
Epoch: [37]  [268/269]  eta: 0:00:00  lr: 0.000017  bag_loss: 0.1587 (0.4367)  instance_loss: 0.8303 (0.8628)  time: 0.0131  data: 0.0012  max mem: 337
Epoch: [37] Total time: 0:00:04 (4.4308 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7827 (0.7827)  acc1: 0.0000 (0.0000)  time: 0.5110  data: 0.4976  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2351 (0.8736)  acc1: 100.0000 (70.0000)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8386 s / it)
* Acc@1 70.000 loss 0.874 auroc 0.741 f1_score 0.361
Test  [  0/200]  eta: 0:01:45  loss: 0.4713 (0.4713)  acc1: 100.0000 (100.0000)  time: 0.5264  data: 0.5167  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4120 (0.9473)  acc1: 100.0000 (70.2970)  time: 0.0071  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1032 (0.7273)  acc1: 100.0000 (77.5000)  time: 0.0091  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1799 s / it)
* Acc@1 77.500 loss 0.727 auroc 0.776 f1_score 0.509


Epoch: [38]  [  0/269]  eta: 0:02:21  lr: 0.000017  bag_loss: 0.3357 (0.3357)  instance_loss: 0.9067 (0.9067)  time: 0.5267  data: 0.5120  max mem: 337
Epoch: [38]  [100/269]  eta: 0:00:03  lr: 0.000016  bag_loss: 0.1432 (0.3857)  instance_loss: 0.8144 (0.8530)  time: 0.0142  data: 0.0013  max mem: 337
Epoch: [38]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.1949 (0.3995)  instance_loss: 0.8516 (0.8703)  time: 0.0124  data: 0.0011  max mem: 337
Epoch: [38]  [268/269]  eta: 0:00:00  lr: 0.000014  bag_loss: 0.2712 (0.4410)  instance_loss: 0.8535 (0.8718)  time: 0.0152  data: 0.0013  max mem: 337
Epoch: [38] Total time: 0:00:04 (4.4433 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.9979 (0.9979)  acc1: 0.0000 (0.0000)  time: 0.5398  data: 0.5274  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2818 (0.8945)  acc1: 100.0000 (66.6667)  time: 0.0075  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8785 s / it)
* Acc@1 66.667 loss 0.895 auroc 0.743 f1_score 0.346
Test  [  0/200]  eta: 0:01:43  loss: 0.3115 (0.3115)  acc1: 100.0000 (100.0000)  time: 0.5190  data: 0.5046  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4673 (0.9970)  acc1: 100.0000 (67.3267)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1178 (0.7586)  acc1: 100.0000 (75.5000)  time: 0.0088  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1026 s / it)
* Acc@1 75.500 loss 0.759 auroc 0.776 f1_score 0.511


Epoch: [39]  [  0/269]  eta: 0:02:17  lr: 0.000014  bag_loss: 0.0283 (0.0283)  instance_loss: 0.7803 (0.7803)  time: 0.5109  data: 0.4979  max mem: 337
Epoch: [39]  [100/269]  eta: 0:00:03  lr: 0.000013  bag_loss: 0.1355 (0.4587)  instance_loss: 0.9046 (0.8724)  time: 0.0115  data: 0.0010  max mem: 337
Epoch: [39]  [200/269]  eta: 0:00:01  lr: 0.000012  bag_loss: 0.1452 (0.4513)  instance_loss: 0.8460 (0.8715)  time: 0.0162  data: 0.0012  max mem: 337
Epoch: [39]  [268/269]  eta: 0:00:00  lr: 0.000012  bag_loss: 0.0874 (0.4362)  instance_loss: 0.7817 (0.8591)  time: 0.0126  data: 0.0010  max mem: 337
Epoch: [39] Total time: 0:00:04 (4.3684 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.7479 (0.7479)  acc1: 0.0000 (0.0000)  time: 0.5150  data: 0.5021  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2134 (0.8852)  acc1: 100.0000 (73.3333)  time: 0.0072  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8323 s / it)
* Acc@1 73.333 loss 0.885 auroc 0.725 f1_score 0.384
Test  [  0/200]  eta: 0:01:44  loss: 0.2121 (0.2121)  acc1: 100.0000 (100.0000)  time: 0.5207  data: 0.5126  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3360 (0.9679)  acc1: 100.0000 (71.2871)  time: 0.0061  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0823 (0.7437)  acc1: 100.0000 (77.5000)  time: 0.0081  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0854 s / it)
* Acc@1 77.500 loss 0.744 auroc 0.775 f1_score 0.521


Epoch: [40]  [  0/269]  eta: 0:02:15  lr: 0.000012  bag_loss: 0.5313 (0.5313)  instance_loss: 1.1091 (1.1091)  time: 0.5025  data: 0.4873  max mem: 337
Epoch: [40]  [100/269]  eta: 0:00:03  lr: 0.000011  bag_loss: 0.1457 (0.3832)  instance_loss: 0.8533 (0.8658)  time: 0.0158  data: 0.0011  max mem: 337
Epoch: [40]  [200/269]  eta: 0:00:01  lr: 0.000010  bag_loss: 0.3442 (0.4380)  instance_loss: 0.8839 (0.8509)  time: 0.0139  data: 0.0011  max mem: 337
Epoch: [40]  [268/269]  eta: 0:00:00  lr: 0.000010  bag_loss: 0.2785 (0.4252)  instance_loss: 0.8924 (0.8579)  time: 0.0120  data: 0.0011  max mem: 337
Epoch: [40] Total time: 0:00:04 (4.3787 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.9339 (0.9339)  acc1: 0.0000 (0.0000)  time: 0.5121  data: 0.5013  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2631 (0.8970)  acc1: 100.0000 (70.0000)  time: 0.0083  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8595 s / it)
* Acc@1 70.000 loss 0.897 auroc 0.735 f1_score 0.361
Test  [  0/200]  eta: 0:01:44  loss: 0.2243 (0.2243)  acc1: 100.0000 (100.0000)  time: 0.5225  data: 0.5066  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4804 (0.9941)  acc1: 100.0000 (67.3267)  time: 0.0066  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1008 (0.7567)  acc1: 100.0000 (76.5000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1014 s / it)
* Acc@1 76.500 loss 0.757 auroc 0.775 f1_score 0.530


Epoch: [41]  [  0/269]  eta: 0:02:57  lr: 0.000010  bag_loss: 0.4160 (0.4160)  instance_loss: 0.9543 (0.9543)  time: 0.6598  data: 0.6365  max mem: 337
Epoch: [41]  [100/269]  eta: 0:00:03  lr: 0.000009  bag_loss: 0.2565 (0.4311)  instance_loss: 0.8687 (0.8750)  time: 0.0122  data: 0.0012  max mem: 337
Epoch: [41]  [200/269]  eta: 0:00:01  lr: 0.000008  bag_loss: 0.1872 (0.4384)  instance_loss: 0.8534 (0.8658)  time: 0.0152  data: 0.0011  max mem: 337
Epoch: [41]  [268/269]  eta: 0:00:00  lr: 0.000008  bag_loss: 0.3202 (0.4379)  instance_loss: 0.8656 (0.8682)  time: 0.0152  data: 0.0013  max mem: 337
Epoch: [41] Total time: 0:00:04 (4.6638 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8922 (0.8922)  acc1: 0.0000 (0.0000)  time: 0.5322  data: 0.5160  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2233 (0.8871)  acc1: 100.0000 (73.3333)  time: 0.0076  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8551 s / it)
* Acc@1 73.333 loss 0.887 auroc 0.739 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.1873 (0.1873)  acc1: 100.0000 (100.0000)  time: 0.5124  data: 0.5047  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3606 (0.9757)  acc1: 100.0000 (71.2871)  time: 0.0058  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0862 (0.7507)  acc1: 100.0000 (77.0000)  time: 0.0098  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.1190 s / it)
* Acc@1 77.000 loss 0.751 auroc 0.776 f1_score 0.517


Epoch: [42]  [  0/269]  eta: 0:02:18  lr: 0.000008  bag_loss: 1.5919 (1.5919)  instance_loss: 0.8722 (0.8722)  time: 0.5166  data: 0.4973  max mem: 337
Epoch: [42]  [100/269]  eta: 0:00:03  lr: 0.000007  bag_loss: 0.1782 (0.4698)  instance_loss: 0.8821 (0.8812)  time: 0.0123  data: 0.0010  max mem: 337
Epoch: [42]  [200/269]  eta: 0:00:01  lr: 0.000006  bag_loss: 0.2447 (0.4278)  instance_loss: 0.8363 (0.8696)  time: 0.0114  data: 0.0010  max mem: 337
Epoch: [42]  [268/269]  eta: 0:00:00  lr: 0.000006  bag_loss: 0.2111 (0.4462)  instance_loss: 0.9231 (0.8695)  time: 0.0148  data: 0.0010  max mem: 337
Epoch: [42] Total time: 0:00:04 (4.3303 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.8701 (0.8701)  acc1: 0.0000 (0.0000)  time: 0.5383  data: 0.5254  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2251 (0.8830)  acc1: 100.0000 (73.3333)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8676 s / it)
* Acc@1 73.333 loss 0.883 auroc 0.738 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.1978 (0.1978)  acc1: 100.0000 (100.0000)  time: 0.5114  data: 0.5030  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4090 (0.9797)  acc1: 100.0000 (71.2871)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0884 (0.7516)  acc1: 100.0000 (77.5000)  time: 0.0093  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.0984 s / it)
* Acc@1 77.500 loss 0.752 auroc 0.777 f1_score 0.521


Epoch: [43]  [  0/269]  eta: 0:02:28  lr: 0.000006  bag_loss: 0.3555 (0.3555)  instance_loss: 0.9338 (0.9338)  time: 0.5533  data: 0.5292  max mem: 337
Epoch: [43]  [100/269]  eta: 0:00:03  lr: 0.000005  bag_loss: 0.2394 (0.4403)  instance_loss: 0.8568 (0.8660)  time: 0.0132  data: 0.0010  max mem: 337
Epoch: [43]  [200/269]  eta: 0:00:01  lr: 0.000005  bag_loss: 0.3020 (0.4347)  instance_loss: 0.8371 (0.8558)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [43]  [268/269]  eta: 0:00:00  lr: 0.000004  bag_loss: 0.1398 (0.4173)  instance_loss: 0.8388 (0.8560)  time: 0.0167  data: 0.0012  max mem: 337
Epoch: [43] Total time: 0:00:04 (4.3282 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8346 (0.8346)  acc1: 0.0000 (0.0000)  time: 0.5143  data: 0.5020  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2152 (0.8802)  acc1: 100.0000 (73.3333)  time: 0.0078  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8568 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.738 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.2460 (0.2460)  acc1: 100.0000 (100.0000)  time: 0.5118  data: 0.5037  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4146 (0.9741)  acc1: 100.0000 (71.2871)  time: 0.0065  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0863 (0.7458)  acc1: 100.0000 (78.0000)  time: 0.0095  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1184 s / it)
* Acc@1 78.000 loss 0.746 auroc 0.776 f1_score 0.533


Epoch: [44]  [  0/269]  eta: 0:02:19  lr: 0.000004  bag_loss: 0.2767 (0.2767)  instance_loss: 0.9312 (0.9312)  time: 0.5203  data: 0.5053  max mem: 337
Epoch: [44]  [100/269]  eta: 0:00:03  lr: 0.000004  bag_loss: 0.0600 (0.4985)  instance_loss: 0.8204 (0.8622)  time: 0.0141  data: 0.0010  max mem: 337
Epoch: [44]  [200/269]  eta: 0:00:01  lr: 0.000003  bag_loss: 0.2319 (0.4583)  instance_loss: 0.8537 (0.8630)  time: 0.0137  data: 0.0012  max mem: 337
Epoch: [44]  [268/269]  eta: 0:00:00  lr: 0.000003  bag_loss: 0.1942 (0.4266)  instance_loss: 0.8791 (0.8577)  time: 0.0133  data: 0.0012  max mem: 337
Epoch: [44] Total time: 0:00:04 (4.3928 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8569 (0.8569)  acc1: 0.0000 (0.0000)  time: 0.5232  data: 0.5132  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2210 (0.8805)  acc1: 100.0000 (73.3333)  time: 0.0079  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8633 s / it)
* Acc@1 73.333 loss 0.881 auroc 0.741 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.2446 (0.2446)  acc1: 100.0000 (100.0000)  time: 0.5120  data: 0.5027  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4387 (0.9770)  acc1: 100.0000 (70.2970)  time: 0.0067  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0891 (0.7476)  acc1: 100.0000 (78.0000)  time: 0.0094  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.0851 s / it)
* Acc@1 78.000 loss 0.748 auroc 0.776 f1_score 0.536


Epoch: [45]  [  0/269]  eta: 0:02:26  lr: 0.000003  bag_loss: 1.4399 (1.4399)  instance_loss: 1.1570 (1.1570)  time: 0.5464  data: 0.5148  max mem: 337
Epoch: [45]  [100/269]  eta: 0:00:03  lr: 0.000003  bag_loss: 0.2750 (0.4357)  instance_loss: 0.8679 (0.8442)  time: 0.0142  data: 0.0012  max mem: 337
Epoch: [45]  [200/269]  eta: 0:00:01  lr: 0.000002  bag_loss: 0.1368 (0.4359)  instance_loss: 0.8256 (0.8597)  time: 0.0136  data: 0.0012  max mem: 337
Epoch: [45]  [268/269]  eta: 0:00:00  lr: 0.000002  bag_loss: 0.2092 (0.4365)  instance_loss: 0.8130 (0.8556)  time: 0.0156  data: 0.0013  max mem: 337
Epoch: [45] Total time: 0:00:04 (4.4397 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8519 (0.8519)  acc1: 0.0000 (0.0000)  time: 0.5271  data: 0.5142  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2209 (0.8796)  acc1: 100.0000 (73.3333)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8446 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.738 f1_score 0.384
Test  [  0/200]  eta: 0:01:46  loss: 0.2575 (0.2575)  acc1: 100.0000 (100.0000)  time: 0.5313  data: 0.5231  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4468 (0.9727)  acc1: 100.0000 (71.2871)  time: 0.0064  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0891 (0.7451)  acc1: 100.0000 (78.5000)  time: 0.0095  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1598 s / it)
* Acc@1 78.500 loss 0.745 auroc 0.776 f1_score 0.537


Epoch: [46]  [  0/269]  eta: 0:02:21  lr: 0.000002  bag_loss: 0.0356 (0.0356)  instance_loss: 0.7035 (0.7035)  time: 0.5251  data: 0.5078  max mem: 337
Epoch: [46]  [100/269]  eta: 0:00:03  lr: 0.000002  bag_loss: 0.1098 (0.5136)  instance_loss: 0.7940 (0.8772)  time: 0.0148  data: 0.0012  max mem: 337
Epoch: [46]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.2247 (0.4383)  instance_loss: 0.8082 (0.8637)  time: 0.0159  data: 0.0012  max mem: 337
Epoch: [46]  [268/269]  eta: 0:00:00  lr: 0.000001  bag_loss: 0.1535 (0.4193)  instance_loss: 0.8516 (0.8616)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [46] Total time: 0:00:04 (4.4936 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8372 (0.8372)  acc1: 0.0000 (0.0000)  time: 0.5180  data: 0.5056  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2180 (0.8792)  acc1: 100.0000 (73.3333)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8444 s / it)
* Acc@1 73.333 loss 0.879 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:46  loss: 0.2574 (0.2574)  acc1: 100.0000 (100.0000)  time: 0.5312  data: 0.5213  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4318 (0.9693)  acc1: 100.0000 (71.2871)  time: 0.0069  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0880 (0.7435)  acc1: 100.0000 (78.5000)  time: 0.0098  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1379 s / it)
* Acc@1 78.500 loss 0.743 auroc 0.776 f1_score 0.537


Epoch: [47]  [  0/269]  eta: 0:02:22  lr: 0.000001  bag_loss: 0.0677 (0.0677)  instance_loss: 0.9623 (0.9623)  time: 0.5305  data: 0.5020  max mem: 337
Epoch: [47]  [100/269]  eta: 0:00:03  lr: 0.000001  bag_loss: 0.2559 (0.3722)  instance_loss: 0.8483 (0.8570)  time: 0.0180  data: 0.0013  max mem: 337
Epoch: [47]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.0829 (0.4159)  instance_loss: 0.8034 (0.8551)  time: 0.0149  data: 0.0011  max mem: 337
Epoch: [47]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1989 (0.4170)  instance_loss: 0.8979 (0.8631)  time: 0.0138  data: 0.0013  max mem: 337
Epoch: [47] Total time: 0:00:04 (4.4400 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.8420 (0.8420)  acc1: 0.0000 (0.0000)  time: 0.5387  data: 0.5210  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2188 (0.8793)  acc1: 100.0000 (73.3333)  time: 0.0074  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.8694 s / it)
* Acc@1 73.333 loss 0.879 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.2559 (0.2559)  acc1: 100.0000 (100.0000)  time: 0.5119  data: 0.5038  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4322 (0.9697)  acc1: 100.0000 (71.2871)  time: 0.0062  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0882 (0.7439)  acc1: 100.0000 (78.5000)  time: 0.0093  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.0886 s / it)
* Acc@1 78.500 loss 0.744 auroc 0.776 f1_score 0.537


Epoch: [48]  [  0/269]  eta: 0:02:18  lr: 0.000000  bag_loss: 0.0369 (0.0369)  instance_loss: 0.6288 (0.6288)  time: 0.5145  data: 0.4989  max mem: 337
Epoch: [48]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.1730 (0.4050)  instance_loss: 0.7826 (0.8525)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [48]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1848 (0.4460)  instance_loss: 0.9056 (0.8780)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [48]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1166 (0.4178)  instance_loss: 0.9123 (0.8692)  time: 0.0130  data: 0.0009  max mem: 337
Epoch: [48] Total time: 0:00:04 (4.4484 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8472 (0.8472)  acc1: 0.0000 (0.0000)  time: 0.5147  data: 0.5005  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2202 (0.8797)  acc1: 100.0000 (73.3333)  time: 0.0087  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8780 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:43  loss: 0.2556 (0.2556)  acc1: 100.0000 (100.0000)  time: 0.5179  data: 0.5086  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4365 (0.9704)  acc1: 100.0000 (71.2871)  time: 0.0061  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0891 (0.7444)  acc1: 100.0000 (78.5000)  time: 0.0084  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.0926 s / it)
* Acc@1 78.500 loss 0.744 auroc 0.776 f1_score 0.537


Epoch: [49]  [  0/269]  eta: 0:02:19  lr: 0.000000  bag_loss: 2.0841 (2.0841)  instance_loss: 1.1751 (1.1751)  time: 0.5181  data: 0.5056  max mem: 337
Epoch: [49]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.1373 (0.4280)  instance_loss: 0.7949 (0.8584)  time: 0.0129  data: 0.0012  max mem: 337
Epoch: [49]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1772 (0.4115)  instance_loss: 0.8683 (0.8498)  time: 0.0110  data: 0.0010  max mem: 337
Epoch: [49]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1795 (0.4107)  instance_loss: 0.8143 (0.8523)  time: 0.0175  data: 0.0014  max mem: 337
Epoch: [49] Total time: 0:00:04 (4.4562 s / it)
Val  [ 0/30]  eta: 0:00:15  loss: 0.8461 (0.8461)  acc1: 0.0000 (0.0000)  time: 0.5180  data: 0.5055  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2200 (0.8797)  acc1: 100.0000 (73.3333)  time: 0.0077  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.8494 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:42  loss: 0.2566 (0.2566)  acc1: 100.0000 (100.0000)  time: 0.5146  data: 0.5061  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4353 (0.9704)  acc1: 100.0000 (71.2871)  time: 0.0063  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0889 (0.7443)  acc1: 100.0000 (78.5000)  time: 0.0091  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1324 s / it)
* Acc@1 78.500 loss 0.744 auroc 0.776 f1_score 0.537


Results on best epoch:
{'epoch': 28, 'val_acc': 76.66666666666667, 'val_auc': 0.7363314628601074, 'val_f1': 0.4020833373069763, 'test_acc': 78.0, 'test_auc': 0.7786926031112671, 'test_f1': 0.5049492716789246}
Wandb run dir: /fs2/comm/kpgrp/yelinfen/Documents/ACMIL/wandb/offline-run-20250807_011511-hgdvr19c/files
Used config:
{'B': 1,
 'D_feat': 512,
 'D_inner': 256,
 'arch': 'clam_sb',
 'augment_epoch': 1,
 'backbone': 'Resnet18',
 'config': 'config/patch_classification_camelyon17_config.yml',
 'data_dir': './Features/CAM17_res18',
 'dataset': 'camelyon17',
 'heatmap_arguments': {'alpha': 0.4,
                       'binarize': False,
                       'blank_canvas': False,
                       'blur': True,
                       'cmap': 'jet',
                       'custom_downsample': 1,
                       'vis_level': -1},
 'load_head_checkpoints': False,
 'lr': 0.0001,
 'min_lr': 0,
 'n_class': 4,
 'n_shot': -1,
 'n_token': 4,
 'n_worker': 8,
 'optim': 'sgd',
 'pin_memory': False,
 'pretrain': 'natural_supervsied',
 'seed': 5,
 'start_epoch': 0,
 'train_epoch': 50,
 'w_loss': 1.0,
 'wandb_mode': 'offline',
 'warmup_epoch': 5,
 'wd': 0.0005}
get dataset
Epoch: [0]  [  0/269]  eta: 0:04:33  lr: 0.000000  bag_loss: 2.0408 (2.0408)  instance_loss: 1.1297 (1.1297)  time: 1.0172  data: 0.5044  max mem: 88
Epoch: [0]  [100/269]  eta: 0:00:04  lr: 0.000007  bag_loss: 1.5611 (1.5891)  instance_loss: 1.2793 (1.3641)  time: 0.0126  data: 0.0011  max mem: 337
Epoch: [0]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.6874 (1.3846)  instance_loss: 1.3703 (1.3876)  time: 0.0130  data: 0.0012  max mem: 337
Epoch: [0]  [268/269]  eta: 0:00:00  lr: 0.000020  bag_loss: 0.5244 (1.2896)  instance_loss: 1.4212 (1.4006)  time: 0.0134  data: 0.0012  max mem: 337
Epoch: [0] Total time: 0:00:04 (4.9484 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.3923 (0.3923)  acc1: 100.0000 (100.0000)  time: 0.5596  data: 0.5342  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4292 (0.8534)  acc1: 100.0000 (73.3333)  time: 0.0081  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9014 s / it)
* Acc@1 73.333 loss 0.853 auroc 0.701 f1_score 0.212
Test  [  0/200]  eta: 0:01:47  loss: 1.9171 (1.9171)  acc1: 0.0000 (0.0000)  time: 0.5380  data: 0.5313  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4859 (1.1123)  acc1: 100.0000 (59.4059)  time: 0.0069  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5514 (1.0779)  acc1: 100.0000 (60.5000)  time: 0.0115  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.2902 s / it)
* Acc@1 60.500 loss 1.078 auroc 0.550 f1_score 0.188


Epoch: [1]  [  0/269]  eta: 0:03:19  lr: 0.000020  bag_loss: 0.5400 (0.5400)  instance_loss: 1.5285 (1.5285)  time: 0.7405  data: 0.7061  max mem: 337
Epoch: [1]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.5600 (1.0040)  instance_loss: 1.4202 (1.5052)  time: 0.0146  data: 0.0010  max mem: 337
Epoch: [1]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.4729 (1.0115)  instance_loss: 1.3555 (1.4769)  time: 0.0124  data: 0.0010  max mem: 337
Epoch: [1]  [268/269]  eta: 0:00:00  lr: 0.000040  bag_loss: 0.5602 (1.0369)  instance_loss: 1.3314 (1.4654)  time: 0.0131  data: 0.0012  max mem: 337
Epoch: [1] Total time: 0:00:04 (4.5813 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.5193 (0.5193)  acc1: 100.0000 (100.0000)  time: 0.5733  data: 0.5632  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5063 (0.8556)  acc1: 100.0000 (73.3333)  time: 0.0073  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9139 s / it)
* Acc@1 73.333 loss 0.856 auroc 0.684 f1_score 0.212
Test  [  0/200]  eta: 0:01:58  loss: 1.4550 (1.4550)  acc1: 0.0000 (0.0000)  time: 0.5925  data: 0.5785  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5655 (1.1265)  acc1: 100.0000 (59.4059)  time: 0.0060  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5673 (1.0973)  acc1: 100.0000 (60.5000)  time: 0.0102  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.3007 s / it)
* Acc@1 60.500 loss 1.097 auroc 0.580 f1_score 0.188


Epoch: [2]  [  0/269]  eta: 0:02:46  lr: 0.000040  bag_loss: 0.5860 (0.5860)  instance_loss: 1.2733 (1.2733)  time: 0.6192  data: 0.6038  max mem: 337
Epoch: [2]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.2876 (0.9401)  instance_loss: 1.3984 (1.4373)  time: 0.0149  data: 0.0013  max mem: 337
Epoch: [2]  [200/269]  eta: 0:00:01  lr: 0.000055  bag_loss: 1.5218 (1.0187)  instance_loss: 1.4241 (1.4530)  time: 0.0127  data: 0.0012  max mem: 337
Epoch: [2]  [268/269]  eta: 0:00:00  lr: 0.000060  bag_loss: 1.8610 (1.0327)  instance_loss: 1.4700 (1.4387)  time: 0.0158  data: 0.0013  max mem: 337
Epoch: [2] Total time: 0:00:04 (4.5365 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.5201 (0.5201)  acc1: 100.0000 (100.0000)  time: 0.5800  data: 0.5587  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4165 (0.8338)  acc1: 100.0000 (73.3333)  time: 0.0074  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9268 s / it)
* Acc@1 73.333 loss 0.834 auroc 0.706 f1_score 0.212
Test  [  0/200]  eta: 0:01:54  loss: 1.5565 (1.5565)  acc1: 0.0000 (0.0000)  time: 0.5736  data: 0.5626  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5380 (1.1128)  acc1: 100.0000 (59.4059)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.4865 (1.0735)  acc1: 100.0000 (60.5000)  time: 0.0082  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1175 s / it)
* Acc@1 60.500 loss 1.073 auroc 0.591 f1_score 0.188


Epoch: [3]  [  0/269]  eta: 0:02:40  lr: 0.000060  bag_loss: 0.3753 (0.3753)  instance_loss: 1.2302 (1.2302)  time: 0.5959  data: 0.5680  max mem: 337
Epoch: [3]  [100/269]  eta: 0:00:03  lr: 0.000067  bag_loss: 0.4542 (0.9073)  instance_loss: 1.1733 (1.2678)  time: 0.0127  data: 0.0011  max mem: 337
Epoch: [3]  [200/269]  eta: 0:00:01  lr: 0.000075  bag_loss: 0.4451 (0.9754)  instance_loss: 1.3559 (1.3199)  time: 0.0149  data: 0.0012  max mem: 337
Epoch: [3]  [268/269]  eta: 0:00:00  lr: 0.000080  bag_loss: 0.8925 (1.0300)  instance_loss: 1.2312 (1.3190)  time: 0.0119  data: 0.0010  max mem: 337
Epoch: [3] Total time: 0:00:04 (4.3919 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.8946 (0.8946)  acc1: 100.0000 (100.0000)  time: 0.5844  data: 0.5728  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.6875 (0.9417)  acc1: 100.0000 (73.3333)  time: 0.0073  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9271 s / it)
* Acc@1 73.333 loss 0.942 auroc 0.728 f1_score 0.212
Test  [  0/200]  eta: 0:01:57  loss: 1.3929 (1.3929)  acc1: 0.0000 (0.0000)  time: 0.5872  data: 0.5793  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.8862 (1.1310)  acc1: 100.0000 (59.4059)  time: 0.0060  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.8479 (1.0834)  acc1: 100.0000 (60.5000)  time: 0.0094  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1792 s / it)
* Acc@1 60.500 loss 1.083 auroc 0.641 f1_score 0.188


Epoch: [4]  [  0/269]  eta: 0:02:37  lr: 0.000080  bag_loss: 0.5954 (0.5954)  instance_loss: 1.4286 (1.4286)  time: 0.5842  data: 0.5682  max mem: 337
Epoch: [4]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.6522 (1.0712)  instance_loss: 1.1156 (1.1918)  time: 0.0146  data: 0.0011  max mem: 337
Epoch: [4]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.6277 (1.0101)  instance_loss: 1.1510 (1.1877)  time: 0.0117  data: 0.0011  max mem: 337
Epoch: [4]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.4943 (1.0165)  instance_loss: 1.0961 (1.1780)  time: 0.0105  data: 0.0009  max mem: 337
Epoch: [4] Total time: 0:00:04 (4.2420 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.7426 (0.7426)  acc1: 100.0000 (100.0000)  time: 0.5947  data: 0.5834  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5389 (0.9452)  acc1: 100.0000 (73.3333)  time: 0.0069  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9293 s / it)
* Acc@1 73.333 loss 0.945 auroc 0.671 f1_score 0.212
Test  [  0/200]  eta: 0:01:57  loss: 2.2429 (2.2429)  acc1: 0.0000 (0.0000)  time: 0.5852  data: 0.5774  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7801 (1.1228)  acc1: 100.0000 (60.3960)  time: 0.0061  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6611 (1.0508)  acc1: 100.0000 (61.0000)  time: 0.0085  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1505 s / it)
* Acc@1 61.000 loss 1.051 auroc 0.637 f1_score 0.200


Epoch: [5]  [  0/269]  eta: 0:02:33  lr: 0.000100  bag_loss: 1.5243 (1.5243)  instance_loss: 1.0512 (1.0512)  time: 0.5703  data: 0.5540  max mem: 337
Epoch: [5]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.3065 (1.0574)  instance_loss: 1.3322 (1.1712)  time: 0.0145  data: 0.0012  max mem: 337
Epoch: [5]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.4579 (1.0315)  instance_loss: 1.2696 (1.1937)  time: 0.0158  data: 0.0012  max mem: 337
Epoch: [5]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.7772 (1.0163)  instance_loss: 1.1304 (1.1857)  time: 0.0126  data: 0.0011  max mem: 337
Epoch: [5] Total time: 0:00:04 (4.3456 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.7753 (0.7753)  acc1: 100.0000 (100.0000)  time: 0.5872  data: 0.5733  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5492 (0.9064)  acc1: 100.0000 (73.3333)  time: 0.0085  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.9764 s / it)
* Acc@1 73.333 loss 0.906 auroc 0.697 f1_score 0.310
Test  [  0/200]  eta: 0:02:04  loss: 1.7764 (1.7764)  acc1: 0.0000 (0.0000)  time: 0.6244  data: 0.6164  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7755 (1.0836)  acc1: 100.0000 (70.2970)  time: 0.0062  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6185 (1.0129)  acc1: 100.0000 (70.5000)  time: 0.0083  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.1585 s / it)
* Acc@1 70.500 loss 1.013 auroc 0.706 f1_score 0.352


Epoch: [6]  [  0/269]  eta: 0:02:41  lr: 0.000100  bag_loss: 0.9379 (0.9379)  instance_loss: 1.1581 (1.1581)  time: 0.5991  data: 0.5874  max mem: 337
Epoch: [6]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.3803 (0.9727)  instance_loss: 1.0987 (1.1329)  time: 0.0152  data: 0.0011  max mem: 337
Epoch: [6]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.2107 (0.9054)  instance_loss: 1.1538 (1.1599)  time: 0.0129  data: 0.0010  max mem: 337
Epoch: [6]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.6152 (0.9349)  instance_loss: 1.1400 (1.1841)  time: 0.0139  data: 0.0012  max mem: 337
Epoch: [6] Total time: 0:00:04 (4.3891 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.8416 (0.8416)  acc1: 100.0000 (100.0000)  time: 0.6000  data: 0.5899  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3704 (0.8402)  acc1: 100.0000 (76.6667)  time: 0.0076  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9517 s / it)
* Acc@1 76.667 loss 0.840 auroc 0.670 f1_score 0.341
Test  [  0/200]  eta: 0:01:54  loss: 1.2313 (1.2313)  acc1: 0.0000 (0.0000)  time: 0.5733  data: 0.5652  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7825 (0.9490)  acc1: 100.0000 (66.3366)  time: 0.0064  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.4777 (0.9076)  acc1: 100.0000 (68.5000)  time: 0.0088  data: 0.0010  max mem: 337
Test Total time: 0:00:03 (3.7305 s / it)
* Acc@1 68.500 loss 0.908 auroc 0.733 f1_score 0.370


Epoch: [7]  [  0/269]  eta: 0:02:47  lr: 0.000100  bag_loss: 0.3426 (0.3426)  instance_loss: 1.1473 (1.1473)  time: 0.6215  data: 0.6066  max mem: 337
Epoch: [7]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.4474 (0.9173)  instance_loss: 1.2217 (1.2263)  time: 0.0144  data: 0.0011  max mem: 337
Epoch: [7]  [200/269]  eta: 0:00:01  lr: 0.000099  bag_loss: 0.2981 (0.8272)  instance_loss: 1.1228 (1.2135)  time: 0.0138  data: 0.0012  max mem: 337
Epoch: [7]  [268/269]  eta: 0:00:00  lr: 0.000099  bag_loss: 0.3556 (0.8088)  instance_loss: 1.2183 (1.2241)  time: 0.0151  data: 0.0012  max mem: 337
Epoch: [7] Total time: 0:00:04 (4.4140 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.4263 (0.4263)  acc1: 100.0000 (100.0000)  time: 0.5851  data: 0.5723  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2092 (0.7697)  acc1: 100.0000 (76.6667)  time: 0.0083  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9701 s / it)
* Acc@1 76.667 loss 0.770 auroc 0.698 f1_score 0.320
Test  [  0/200]  eta: 0:01:59  loss: 1.4667 (1.4667)  acc1: 0.0000 (0.0000)  time: 0.5992  data: 0.5903  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2932 (0.7966)  acc1: 100.0000 (76.2376)  time: 0.0063  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2008 (0.7511)  acc1: 100.0000 (78.5000)  time: 0.0084  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.1416 s / it)
* Acc@1 78.500 loss 0.751 auroc 0.760 f1_score 0.431


Epoch: [8]  [  0/269]  eta: 0:02:42  lr: 0.000099  bag_loss: 0.3202 (0.3202)  instance_loss: 1.0728 (1.0728)  time: 0.6048  data: 0.5876  max mem: 337
Epoch: [8]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.2226 (0.5991)  instance_loss: 1.1991 (1.2174)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [8]  [200/269]  eta: 0:00:01  lr: 0.000098  bag_loss: 0.5096 (0.7195)  instance_loss: 1.1538 (1.2466)  time: 0.0117  data: 0.0010  max mem: 337
Epoch: [8]  [268/269]  eta: 0:00:00  lr: 0.000098  bag_loss: 0.2494 (0.7665)  instance_loss: 1.1694 (1.2381)  time: 0.0164  data: 0.0012  max mem: 337
Epoch: [8] Total time: 0:00:04 (4.3781 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.3677 (0.3677)  acc1: 100.0000 (100.0000)  time: 0.6004  data: 0.5880  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2718 (0.8780)  acc1: 100.0000 (76.6667)  time: 0.0081  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9543 s / it)
* Acc@1 76.667 loss 0.878 auroc 0.731 f1_score 0.320
Test  [  0/200]  eta: 0:01:58  loss: 2.5418 (2.5418)  acc1: 0.0000 (0.0000)  time: 0.5917  data: 0.5834  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2774 (0.8178)  acc1: 100.0000 (77.2277)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2251 (0.7133)  acc1: 100.0000 (80.0000)  time: 0.0083  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1731 s / it)
* Acc@1 80.000 loss 0.713 auroc 0.753 f1_score 0.438


Epoch: [9]  [  0/269]  eta: 0:02:40  lr: 0.000098  bag_loss: 1.5887 (1.5887)  instance_loss: 0.9746 (0.9746)  time: 0.5977  data: 0.5811  max mem: 337
Epoch: [9]  [100/269]  eta: 0:00:03  lr: 0.000098  bag_loss: 0.2662 (0.7012)  instance_loss: 1.1000 (1.1620)  time: 0.0127  data: 0.0011  max mem: 337
Epoch: [9]  [200/269]  eta: 0:00:01  lr: 0.000097  bag_loss: 0.4729 (0.7209)  instance_loss: 1.0427 (1.1689)  time: 0.0141  data: 0.0010  max mem: 337
Epoch: [9]  [268/269]  eta: 0:00:00  lr: 0.000097  bag_loss: 0.3234 (0.7443)  instance_loss: 1.1218 (1.1644)  time: 0.0164  data: 0.0013  max mem: 337
Epoch: [9] Total time: 0:00:04 (4.4789 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.4146 (0.4146)  acc1: 100.0000 (100.0000)  time: 0.5876  data: 0.5775  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3071 (0.8474)  acc1: 100.0000 (70.0000)  time: 0.0077  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9397 s / it)
* Acc@1 70.000 loss 0.847 auroc 0.712 f1_score 0.280
Test  [  0/200]  eta: 0:01:56  loss: 1.6164 (1.6164)  acc1: 0.0000 (0.0000)  time: 0.5808  data: 0.5705  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3023 (0.7618)  acc1: 100.0000 (77.2277)  time: 0.0064  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2013 (0.6833)  acc1: 100.0000 (81.0000)  time: 0.0090  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2468 s / it)
* Acc@1 81.000 loss 0.683 auroc 0.767 f1_score 0.444


Epoch: [10]  [  0/269]  eta: 0:02:43  lr: 0.000097  bag_loss: 0.1212 (0.1212)  instance_loss: 0.9991 (0.9991)  time: 0.6066  data: 0.5953  max mem: 337
Epoch: [10]  [100/269]  eta: 0:00:03  lr: 0.000097  bag_loss: 0.1540 (0.6606)  instance_loss: 1.0544 (1.1229)  time: 0.0132  data: 0.0011  max mem: 337
Epoch: [10]  [200/269]  eta: 0:00:01  lr: 0.000096  bag_loss: 0.2042 (0.7027)  instance_loss: 1.0459 (1.1120)  time: 0.0126  data: 0.0011  max mem: 337
Epoch: [10]  [268/269]  eta: 0:00:00  lr: 0.000096  bag_loss: 0.2991 (0.7070)  instance_loss: 1.0889 (1.1195)  time: 0.0133  data: 0.0011  max mem: 337
Epoch: [10] Total time: 0:00:04 (4.4840 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.4894 (0.4894)  acc1: 100.0000 (100.0000)  time: 0.5911  data: 0.5780  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2915 (0.8288)  acc1: 100.0000 (73.3333)  time: 0.0074  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9422 s / it)
* Acc@1 73.333 loss 0.829 auroc 0.696 f1_score 0.298
Test  [  0/200]  eta: 0:01:55  loss: 1.5689 (1.5689)  acc1: 0.0000 (0.0000)  time: 0.5778  data: 0.5694  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3518 (0.7120)  acc1: 100.0000 (77.2277)  time: 0.0069  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2538 (0.6430)  acc1: 100.0000 (80.0000)  time: 0.0086  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1736 s / it)
* Acc@1 80.000 loss 0.643 auroc 0.778 f1_score 0.436


Epoch: [11]  [  0/269]  eta: 0:02:38  lr: 0.000096  bag_loss: 0.4424 (0.4424)  instance_loss: 0.9280 (0.9280)  time: 0.5874  data: 0.5706  max mem: 337
Epoch: [11]  [100/269]  eta: 0:00:03  lr: 0.000095  bag_loss: 0.2074 (0.7929)  instance_loss: 1.0391 (1.0573)  time: 0.0163  data: 0.0014  max mem: 337
Epoch: [11]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.1214 (0.7238)  instance_loss: 1.1759 (1.0800)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [11]  [268/269]  eta: 0:00:00  lr: 0.000094  bag_loss: 0.2474 (0.7042)  instance_loss: 0.9680 (1.0902)  time: 0.0164  data: 0.0014  max mem: 337
Epoch: [11] Total time: 0:00:04 (4.5252 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.6940 (0.6940)  acc1: 100.0000 (100.0000)  time: 0.5920  data: 0.5801  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3816 (0.8019)  acc1: 100.0000 (80.0000)  time: 0.0076  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9383 s / it)
* Acc@1 80.000 loss 0.802 auroc 0.741 f1_score 0.391
Test  [  0/200]  eta: 0:01:56  loss: 0.8070 (0.8070)  acc1: 100.0000 (100.0000)  time: 0.5815  data: 0.5689  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4577 (0.7535)  acc1: 100.0000 (77.2277)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2362 (0.6660)  acc1: 100.0000 (81.0000)  time: 0.0085  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1715 s / it)
* Acc@1 81.000 loss 0.666 auroc 0.771 f1_score 0.521


Epoch: [12]  [  0/269]  eta: 0:02:38  lr: 0.000094  bag_loss: 1.5082 (1.5082)  instance_loss: 0.8020 (0.8020)  time: 0.5884  data: 0.5714  max mem: 337
Epoch: [12]  [100/269]  eta: 0:00:03  lr: 0.000094  bag_loss: 0.1710 (0.7004)  instance_loss: 1.0085 (1.0413)  time: 0.0145  data: 0.0011  max mem: 337
Epoch: [12]  [200/269]  eta: 0:00:01  lr: 0.000093  bag_loss: 0.1676 (0.6553)  instance_loss: 0.9888 (1.0452)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [12]  [268/269]  eta: 0:00:00  lr: 0.000092  bag_loss: 0.3906 (0.6650)  instance_loss: 0.9704 (1.0417)  time: 0.0135  data: 0.0010  max mem: 337
Epoch: [12] Total time: 0:00:04 (4.3215 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.6544 (0.6544)  acc1: 100.0000 (100.0000)  time: 0.5856  data: 0.5721  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3713 (0.8362)  acc1: 100.0000 (73.3333)  time: 0.0075  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9336 s / it)
* Acc@1 73.333 loss 0.836 auroc 0.722 f1_score 0.298
Test  [  0/200]  eta: 0:01:58  loss: 1.0951 (1.0951)  acc1: 100.0000 (100.0000)  time: 0.5922  data: 0.5848  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4215 (0.7176)  acc1: 100.0000 (80.1980)  time: 0.0059  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2628 (0.6337)  acc1: 100.0000 (82.5000)  time: 0.0086  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1872 s / it)
* Acc@1 82.500 loss 0.634 auroc 0.775 f1_score 0.522


Epoch: [13]  [  0/269]  eta: 0:02:37  lr: 0.000092  bag_loss: 0.4682 (0.4682)  instance_loss: 0.8966 (0.8966)  time: 0.5844  data: 0.5676  max mem: 337
Epoch: [13]  [100/269]  eta: 0:00:03  lr: 0.000092  bag_loss: 0.8196 (0.8052)  instance_loss: 0.9626 (1.0594)  time: 0.0139  data: 0.0012  max mem: 337
Epoch: [13]  [200/269]  eta: 0:00:01  lr: 0.000091  bag_loss: 0.2571 (0.6319)  instance_loss: 1.0389 (1.0721)  time: 0.0115  data: 0.0010  max mem: 337
Epoch: [13]  [268/269]  eta: 0:00:00  lr: 0.000090  bag_loss: 0.2291 (0.6531)  instance_loss: 1.0024 (1.0716)  time: 0.0124  data: 0.0011  max mem: 337
Epoch: [13] Total time: 0:00:04 (4.4378 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.2749 (0.2749)  acc1: 100.0000 (100.0000)  time: 0.6047  data: 0.5931  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1441 (0.8733)  acc1: 100.0000 (76.6667)  time: 0.0075  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9709 s / it)
* Acc@1 76.667 loss 0.873 auroc 0.663 f1_score 0.320
Test  [  0/200]  eta: 0:01:59  loss: 1.6159 (1.6159)  acc1: 0.0000 (0.0000)  time: 0.5959  data: 0.5887  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1809 (0.7353)  acc1: 100.0000 (75.2475)  time: 0.0058  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1517 (0.6712)  acc1: 100.0000 (78.5000)  time: 0.0084  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1498 s / it)
* Acc@1 78.500 loss 0.671 auroc 0.767 f1_score 0.434


Epoch: [14]  [  0/269]  eta: 0:02:42  lr: 0.000090  bag_loss: 0.1009 (0.1009)  instance_loss: 0.9579 (0.9579)  time: 0.6023  data: 0.5892  max mem: 337
Epoch: [14]  [100/269]  eta: 0:00:03  lr: 0.000090  bag_loss: 0.3900 (0.5632)  instance_loss: 1.0490 (1.0559)  time: 0.0139  data: 0.0011  max mem: 337
Epoch: [14]  [200/269]  eta: 0:00:01  lr: 0.000089  bag_loss: 0.2869 (0.5674)  instance_loss: 0.9643 (1.0207)  time: 0.0139  data: 0.0013  max mem: 337
Epoch: [14]  [268/269]  eta: 0:00:00  lr: 0.000088  bag_loss: 0.3030 (0.6701)  instance_loss: 0.9416 (1.0167)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [14] Total time: 0:00:04 (4.5407 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.6224 (0.6224)  acc1: 100.0000 (100.0000)  time: 0.5917  data: 0.5800  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2833 (0.8163)  acc1: 100.0000 (76.6667)  time: 0.0078  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9616 s / it)
* Acc@1 76.667 loss 0.816 auroc 0.684 f1_score 0.320
Test  [  0/200]  eta: 0:01:57  loss: 1.1044 (1.1044)  acc1: 0.0000 (0.0000)  time: 0.5868  data: 0.5780  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3309 (0.6867)  acc1: 100.0000 (77.2277)  time: 0.0063  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2330 (0.6446)  acc1: 100.0000 (79.5000)  time: 0.0087  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1429 s / it)
* Acc@1 79.500 loss 0.645 auroc 0.773 f1_score 0.485


Epoch: [15]  [  0/269]  eta: 0:02:42  lr: 0.000088  bag_loss: 0.0825 (0.0825)  instance_loss: 0.9936 (0.9936)  time: 0.6027  data: 0.5874  max mem: 337
Epoch: [15]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.1329 (0.5934)  instance_loss: 0.8779 (0.9468)  time: 0.0160  data: 0.0013  max mem: 337
Epoch: [15]  [200/269]  eta: 0:00:01  lr: 0.000087  bag_loss: 0.2509 (0.6628)  instance_loss: 0.9195 (0.9496)  time: 0.0140  data: 0.0012  max mem: 337
Epoch: [15]  [268/269]  eta: 0:00:00  lr: 0.000086  bag_loss: 0.2563 (0.6355)  instance_loss: 0.9394 (0.9476)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [15] Total time: 0:00:04 (4.4673 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.5271 (0.5271)  acc1: 100.0000 (100.0000)  time: 0.5874  data: 0.5761  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1953 (0.7860)  acc1: 100.0000 (76.6667)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9199 s / it)
* Acc@1 76.667 loss 0.786 auroc 0.726 f1_score 0.320
Test  [  0/200]  eta: 0:01:59  loss: 0.4796 (0.4796)  acc1: 100.0000 (100.0000)  time: 0.5999  data: 0.5925  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4096 (0.7581)  acc1: 100.0000 (71.2871)  time: 0.0067  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1509 (0.6822)  acc1: 100.0000 (76.0000)  time: 0.0086  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2384 s / it)
* Acc@1 76.000 loss 0.682 auroc 0.768 f1_score 0.500


Epoch: [16]  [  0/269]  eta: 0:02:37  lr: 0.000086  bag_loss: 0.3401 (0.3401)  instance_loss: 1.0022 (1.0022)  time: 0.5847  data: 0.5720  max mem: 337
Epoch: [16]  [100/269]  eta: 0:00:03  lr: 0.000085  bag_loss: 0.1362 (0.5802)  instance_loss: 0.9648 (0.9667)  time: 0.0119  data: 0.0011  max mem: 337
Epoch: [16]  [200/269]  eta: 0:00:01  lr: 0.000084  bag_loss: 0.3155 (0.6178)  instance_loss: 0.8321 (0.9520)  time: 0.0161  data: 0.0014  max mem: 337
Epoch: [16]  [268/269]  eta: 0:00:00  lr: 0.000083  bag_loss: 0.2666 (0.6104)  instance_loss: 0.9318 (0.9331)  time: 0.0133  data: 0.0010  max mem: 337
Epoch: [16] Total time: 0:00:04 (4.3893 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.5314 (0.5314)  acc1: 100.0000 (100.0000)  time: 0.5924  data: 0.5804  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2167 (0.8131)  acc1: 100.0000 (76.6667)  time: 0.0076  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9371 s / it)
* Acc@1 76.667 loss 0.813 auroc 0.722 f1_score 0.320
Test  [  0/200]  eta: 0:01:57  loss: 0.6623 (0.6623)  acc1: 100.0000 (100.0000)  time: 0.5899  data: 0.5817  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2262 (0.6913)  acc1: 100.0000 (78.2178)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1638 (0.6410)  acc1: 100.0000 (80.0000)  time: 0.0086  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1545 s / it)
* Acc@1 80.000 loss 0.641 auroc 0.780 f1_score 0.502


Epoch: [17]  [  0/269]  eta: 0:02:37  lr: 0.000083  bag_loss: 0.3257 (0.3257)  instance_loss: 1.1009 (1.1009)  time: 0.5870  data: 0.5700  max mem: 337
Epoch: [17]  [100/269]  eta: 0:00:03  lr: 0.000082  bag_loss: 0.3568 (0.6540)  instance_loss: 0.8304 (0.8947)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [17]  [200/269]  eta: 0:00:01  lr: 0.000081  bag_loss: 0.2194 (0.5984)  instance_loss: 0.8330 (0.8683)  time: 0.0137  data: 0.0012  max mem: 337
Epoch: [17]  [268/269]  eta: 0:00:00  lr: 0.000081  bag_loss: 0.2009 (0.5962)  instance_loss: 0.8670 (0.8666)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [17] Total time: 0:00:04 (4.4440 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.4369 (0.4369)  acc1: 100.0000 (100.0000)  time: 0.6055  data: 0.5921  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1342 (0.8366)  acc1: 100.0000 (76.6667)  time: 0.0079  data: 0.0011  max mem: 337
Val Total time: 0:00:00 (0.9741 s / it)
* Acc@1 76.667 loss 0.837 auroc 0.701 f1_score 0.320
Test  [  0/200]  eta: 0:01:55  loss: 1.1394 (1.1394)  acc1: 0.0000 (0.0000)  time: 0.5757  data: 0.5648  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1841 (0.6977)  acc1: 100.0000 (77.2277)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1462 (0.6820)  acc1: 100.0000 (77.5000)  time: 0.0090  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.2082 s / it)
* Acc@1 77.500 loss 0.682 auroc 0.776 f1_score 0.445


Epoch: [18]  [  0/269]  eta: 0:02:41  lr: 0.000081  bag_loss: 1.7160 (1.7160)  instance_loss: 0.9473 (0.9473)  time: 0.5997  data: 0.5832  max mem: 337
Epoch: [18]  [100/269]  eta: 0:00:03  lr: 0.000080  bag_loss: 0.1245 (0.6329)  instance_loss: 0.8978 (0.8987)  time: 0.0138  data: 0.0010  max mem: 337
Epoch: [18]  [200/269]  eta: 0:00:01  lr: 0.000079  bag_loss: 0.1427 (0.6084)  instance_loss: 0.9717 (0.9182)  time: 0.0153  data: 0.0013  max mem: 337
Epoch: [18]  [268/269]  eta: 0:00:00  lr: 0.000078  bag_loss: 0.2241 (0.6035)  instance_loss: 0.8952 (0.9105)  time: 0.0117  data: 0.0010  max mem: 337
Epoch: [18] Total time: 0:00:04 (4.4950 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.4428 (0.4428)  acc1: 100.0000 (100.0000)  time: 0.5820  data: 0.5686  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2112 (0.8217)  acc1: 100.0000 (76.6667)  time: 0.0075  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9255 s / it)
* Acc@1 76.667 loss 0.822 auroc 0.717 f1_score 0.320
Test  [  0/200]  eta: 0:01:59  loss: 0.7411 (0.7411)  acc1: 100.0000 (100.0000)  time: 0.5977  data: 0.5884  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2051 (0.7232)  acc1: 100.0000 (79.2079)  time: 0.0059  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1492 (0.6380)  acc1: 100.0000 (80.5000)  time: 0.0086  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.1721 s / it)
* Acc@1 80.500 loss 0.638 auroc 0.781 f1_score 0.505


Epoch: [19]  [  0/269]  eta: 0:02:40  lr: 0.000078  bag_loss: 0.0531 (0.0531)  instance_loss: 0.6379 (0.6379)  time: 0.5962  data: 0.5828  max mem: 337
Epoch: [19]  [100/269]  eta: 0:00:03  lr: 0.000077  bag_loss: 0.1841 (0.5640)  instance_loss: 0.7910 (0.8820)  time: 0.0163  data: 0.0011  max mem: 337
Epoch: [19]  [200/269]  eta: 0:00:01  lr: 0.000076  bag_loss: 0.6684 (0.5863)  instance_loss: 0.8151 (0.8790)  time: 0.0115  data: 0.0011  max mem: 337
Epoch: [19]  [268/269]  eta: 0:00:00  lr: 0.000075  bag_loss: 0.6191 (0.6122)  instance_loss: 0.9571 (0.8917)  time: 0.0131  data: 0.0011  max mem: 337
Epoch: [19] Total time: 0:00:04 (4.5048 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.6236 (0.6236)  acc1: 100.0000 (100.0000)  time: 0.5904  data: 0.5795  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2359 (0.8155)  acc1: 100.0000 (76.6667)  time: 0.0071  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9205 s / it)
* Acc@1 76.667 loss 0.816 auroc 0.731 f1_score 0.320
Test  [  0/200]  eta: 0:01:57  loss: 0.6464 (0.6464)  acc1: 100.0000 (100.0000)  time: 0.5875  data: 0.5739  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4178 (0.6996)  acc1: 100.0000 (75.2475)  time: 0.0063  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2420 (0.6618)  acc1: 100.0000 (77.5000)  time: 0.0090  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1994 s / it)
* Acc@1 77.500 loss 0.662 auroc 0.782 f1_score 0.545


Epoch: [20]  [  0/269]  eta: 0:02:45  lr: 0.000075  bag_loss: 0.1464 (0.1464)  instance_loss: 0.9002 (0.9002)  time: 0.6170  data: 0.5854  max mem: 337
Epoch: [20]  [100/269]  eta: 0:00:03  lr: 0.000074  bag_loss: 0.1952 (0.6566)  instance_loss: 0.9354 (0.9124)  time: 0.0143  data: 0.0012  max mem: 337
Epoch: [20]  [200/269]  eta: 0:00:01  lr: 0.000073  bag_loss: 0.1715 (0.5615)  instance_loss: 0.8337 (0.8858)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [20]  [268/269]  eta: 0:00:00  lr: 0.000072  bag_loss: 0.3627 (0.5811)  instance_loss: 0.9011 (0.8832)  time: 0.0135  data: 0.0013  max mem: 337
Epoch: [20] Total time: 0:00:04 (4.3727 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.6517 (0.6517)  acc1: 100.0000 (100.0000)  time: 0.5962  data: 0.5830  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1973 (0.8194)  acc1: 100.0000 (76.6667)  time: 0.0074  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9518 s / it)
* Acc@1 76.667 loss 0.819 auroc 0.707 f1_score 0.320
Test  [  0/200]  eta: 0:01:57  loss: 0.4421 (0.4421)  acc1: 100.0000 (100.0000)  time: 0.5889  data: 0.5776  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3509 (0.7318)  acc1: 100.0000 (75.2475)  time: 0.0066  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1901 (0.6653)  acc1: 100.0000 (78.0000)  time: 0.0089  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1913 s / it)
* Acc@1 78.000 loss 0.665 auroc 0.783 f1_score 0.529


Epoch: [21]  [  0/269]  eta: 0:02:40  lr: 0.000072  bag_loss: 0.6675 (0.6675)  instance_loss: 0.7444 (0.7444)  time: 0.5959  data: 0.5819  max mem: 337
Epoch: [21]  [100/269]  eta: 0:00:03  lr: 0.000071  bag_loss: 0.1620 (0.6255)  instance_loss: 0.8092 (0.8833)  time: 0.0146  data: 0.0013  max mem: 337
Epoch: [21]  [200/269]  eta: 0:00:01  lr: 0.000070  bag_loss: 0.2216 (0.5895)  instance_loss: 0.9198 (0.8817)  time: 0.0138  data: 0.0011  max mem: 337
Epoch: [21]  [268/269]  eta: 0:00:00  lr: 0.000069  bag_loss: 0.4125 (0.5879)  instance_loss: 0.9545 (0.9001)  time: 0.0100  data: 0.0010  max mem: 337
Epoch: [21] Total time: 0:00:04 (4.4730 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.6467 (0.6467)  acc1: 100.0000 (100.0000)  time: 0.6214  data: 0.6084  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3005 (0.8125)  acc1: 100.0000 (76.6667)  time: 0.0079  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9767 s / it)
* Acc@1 76.667 loss 0.812 auroc 0.745 f1_score 0.320
Test  [  0/200]  eta: 0:01:58  loss: 0.7439 (0.7439)  acc1: 100.0000 (100.0000)  time: 0.5904  data: 0.5833  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4979 (0.7655)  acc1: 100.0000 (70.2970)  time: 0.0063  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1754 (0.6553)  acc1: 100.0000 (77.0000)  time: 0.0087  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1983 s / it)
* Acc@1 77.000 loss 0.655 auroc 0.780 f1_score 0.526


Epoch: [22]  [  0/269]  eta: 0:02:42  lr: 0.000069  bag_loss: 0.0651 (0.0651)  instance_loss: 0.8580 (0.8580)  time: 0.6053  data: 0.5905  max mem: 337
Epoch: [22]  [100/269]  eta: 0:00:03  lr: 0.000068  bag_loss: 0.1985 (0.5219)  instance_loss: 0.8804 (0.9033)  time: 0.0119  data: 0.0011  max mem: 337
Epoch: [22]  [200/269]  eta: 0:00:01  lr: 0.000066  bag_loss: 0.3873 (0.5607)  instance_loss: 0.9181 (0.9154)  time: 0.0120  data: 0.0010  max mem: 337
Epoch: [22]  [268/269]  eta: 0:00:00  lr: 0.000065  bag_loss: 0.1512 (0.5713)  instance_loss: 0.9108 (0.9044)  time: 0.0124  data: 0.0011  max mem: 337
Epoch: [22] Total time: 0:00:04 (4.3862 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 1.0573 (1.0573)  acc1: 0.0000 (0.0000)  time: 0.5952  data: 0.5814  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3801 (0.8412)  acc1: 100.0000 (70.0000)  time: 0.0079  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9543 s / it)
* Acc@1 70.000 loss 0.841 auroc 0.723 f1_score 0.308
Test  [  0/200]  eta: 0:02:04  loss: 0.1645 (0.1645)  acc1: 100.0000 (100.0000)  time: 0.6235  data: 0.6157  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7718 (0.8385)  acc1: 100.0000 (69.3069)  time: 0.0061  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2417 (0.7109)  acc1: 100.0000 (76.0000)  time: 0.0091  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2157 s / it)
* Acc@1 76.000 loss 0.711 auroc 0.785 f1_score 0.517


Epoch: [23]  [  0/269]  eta: 0:02:41  lr: 0.000065  bag_loss: 0.3103 (0.3103)  instance_loss: 1.0612 (1.0612)  time: 0.6016  data: 0.5865  max mem: 337
Epoch: [23]  [100/269]  eta: 0:00:03  lr: 0.000064  bag_loss: 0.1747 (0.5837)  instance_loss: 0.9134 (0.9170)  time: 0.0123  data: 0.0010  max mem: 337
Epoch: [23]  [200/269]  eta: 0:00:01  lr: 0.000063  bag_loss: 0.2661 (0.5774)  instance_loss: 0.9345 (0.9244)  time: 0.0163  data: 0.0013  max mem: 337
Epoch: [23]  [268/269]  eta: 0:00:00  lr: 0.000062  bag_loss: 0.1389 (0.5519)  instance_loss: 0.9517 (0.9356)  time: 0.0162  data: 0.0013  max mem: 337
Epoch: [23] Total time: 0:00:04 (4.4500 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.6350 (0.6350)  acc1: 100.0000 (100.0000)  time: 0.5875  data: 0.5765  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1440 (0.8765)  acc1: 100.0000 (76.6667)  time: 0.0079  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9420 s / it)
* Acc@1 76.667 loss 0.876 auroc 0.685 f1_score 0.320
Test  [  0/200]  eta: 0:01:58  loss: 0.4715 (0.4715)  acc1: 100.0000 (100.0000)  time: 0.5921  data: 0.5842  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4536 (0.8969)  acc1: 100.0000 (68.3168)  time: 0.0062  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1651 (0.7431)  acc1: 100.0000 (73.5000)  time: 0.0089  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1911 s / it)
* Acc@1 73.500 loss 0.743 auroc 0.766 f1_score 0.523


Epoch: [24]  [  0/269]  eta: 0:02:39  lr: 0.000062  bag_loss: 0.3144 (0.3144)  instance_loss: 0.9218 (0.9218)  time: 0.5914  data: 0.5687  max mem: 337
Epoch: [24]  [100/269]  eta: 0:00:03  lr: 0.000061  bag_loss: 0.1766 (0.5299)  instance_loss: 0.9437 (0.9439)  time: 0.0138  data: 0.0010  max mem: 337
Epoch: [24]  [200/269]  eta: 0:00:01  lr: 0.000060  bag_loss: 0.1510 (0.5445)  instance_loss: 0.9143 (0.9403)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [24]  [268/269]  eta: 0:00:00  lr: 0.000059  bag_loss: 0.5419 (0.5544)  instance_loss: 0.8931 (0.9425)  time: 0.0137  data: 0.0013  max mem: 337
Epoch: [24] Total time: 0:00:04 (4.4641 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.6326 (0.6326)  acc1: 100.0000 (100.0000)  time: 0.5861  data: 0.5736  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2381 (0.8226)  acc1: 100.0000 (76.6667)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9404 s / it)
* Acc@1 76.667 loss 0.823 auroc 0.709 f1_score 0.320
Test  [  0/200]  eta: 0:01:56  loss: 0.4059 (0.4059)  acc1: 100.0000 (100.0000)  time: 0.5804  data: 0.5720  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3413 (0.7497)  acc1: 100.0000 (76.2376)  time: 0.0070  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1513 (0.6441)  acc1: 100.0000 (80.0000)  time: 0.0093  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1787 s / it)
* Acc@1 80.000 loss 0.644 auroc 0.787 f1_score 0.528


Epoch: [25]  [  0/269]  eta: 0:02:43  lr: 0.000059  bag_loss: 0.2839 (0.2839)  instance_loss: 0.9319 (0.9319)  time: 0.6090  data: 0.5949  max mem: 337
Epoch: [25]  [100/269]  eta: 0:00:03  lr: 0.000057  bag_loss: 0.1596 (0.4994)  instance_loss: 0.9427 (0.9314)  time: 0.0156  data: 0.0013  max mem: 337
Epoch: [25]  [200/269]  eta: 0:00:01  lr: 0.000056  bag_loss: 0.1460 (0.5306)  instance_loss: 0.9403 (0.9326)  time: 0.0153  data: 0.0011  max mem: 337
Epoch: [25]  [268/269]  eta: 0:00:00  lr: 0.000055  bag_loss: 0.3151 (0.5277)  instance_loss: 0.9434 (0.9350)  time: 0.0131  data: 0.0013  max mem: 337
Epoch: [25] Total time: 0:00:04 (4.4581 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.8464 (0.8464)  acc1: 0.0000 (0.0000)  time: 0.5767  data: 0.5662  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2452 (0.8503)  acc1: 100.0000 (70.0000)  time: 0.0072  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9164 s / it)
* Acc@1 70.000 loss 0.850 auroc 0.698 f1_score 0.308
Test  [  0/200]  eta: 0:01:55  loss: 0.1907 (0.1907)  acc1: 100.0000 (100.0000)  time: 0.5761  data: 0.5671  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5145 (0.8585)  acc1: 100.0000 (70.2970)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2008 (0.7197)  acc1: 100.0000 (75.0000)  time: 0.0088  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1607 s / it)
* Acc@1 75.000 loss 0.720 auroc 0.778 f1_score 0.517


Epoch: [26]  [  0/269]  eta: 0:02:43  lr: 0.000055  bag_loss: 1.7215 (1.7215)  instance_loss: 0.9462 (0.9462)  time: 0.6079  data: 0.5961  max mem: 337
Epoch: [26]  [100/269]  eta: 0:00:03  lr: 0.000054  bag_loss: 0.3379 (0.5750)  instance_loss: 0.9428 (0.9200)  time: 0.0122  data: 0.0010  max mem: 337
Epoch: [26]  [200/269]  eta: 0:00:01  lr: 0.000053  bag_loss: 0.2793 (0.5496)  instance_loss: 0.8575 (0.9121)  time: 0.0121  data: 0.0011  max mem: 337
Epoch: [26]  [268/269]  eta: 0:00:00  lr: 0.000052  bag_loss: 0.1500 (0.5316)  instance_loss: 0.7835 (0.8966)  time: 0.0114  data: 0.0010  max mem: 337
Epoch: [26] Total time: 0:00:04 (4.3990 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.4177 (0.4177)  acc1: 100.0000 (100.0000)  time: 0.5983  data: 0.5877  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1448 (0.8183)  acc1: 100.0000 (76.6667)  time: 0.0074  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9458 s / it)
* Acc@1 76.667 loss 0.818 auroc 0.716 f1_score 0.320
Test  [  0/200]  eta: 0:01:56  loss: 0.5112 (0.5112)  acc1: 100.0000 (100.0000)  time: 0.5828  data: 0.5750  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1958 (0.8023)  acc1: 100.0000 (79.2079)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1103 (0.6683)  acc1: 100.0000 (81.0000)  time: 0.0082  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1634 s / it)
* Acc@1 81.000 loss 0.668 auroc 0.782 f1_score 0.521


Epoch: [27]  [  0/269]  eta: 0:02:48  lr: 0.000052  bag_loss: 1.8843 (1.8843)  instance_loss: 1.0743 (1.0743)  time: 0.6261  data: 0.6082  max mem: 337
Epoch: [27]  [100/269]  eta: 0:00:03  lr: 0.000050  bag_loss: 0.1436 (0.4858)  instance_loss: 0.8105 (0.8493)  time: 0.0131  data: 0.0011  max mem: 337
Epoch: [27]  [200/269]  eta: 0:00:01  lr: 0.000049  bag_loss: 0.2385 (0.4993)  instance_loss: 0.9262 (0.8658)  time: 0.0129  data: 0.0012  max mem: 337
Epoch: [27]  [268/269]  eta: 0:00:00  lr: 0.000048  bag_loss: 0.1522 (0.5278)  instance_loss: 0.8204 (0.8710)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [27] Total time: 0:00:04 (4.4518 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.5125 (0.5125)  acc1: 100.0000 (100.0000)  time: 0.5921  data: 0.5815  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2090 (0.8649)  acc1: 100.0000 (76.6667)  time: 0.0073  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9247 s / it)
* Acc@1 76.667 loss 0.865 auroc 0.700 f1_score 0.320
Test  [  0/200]  eta: 0:01:56  loss: 0.3221 (0.3221)  acc1: 100.0000 (100.0000)  time: 0.5805  data: 0.5705  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3188 (0.8530)  acc1: 100.0000 (71.2871)  time: 0.0064  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1468 (0.7013)  acc1: 100.0000 (76.0000)  time: 0.0095  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2302 s / it)
* Acc@1 76.000 loss 0.701 auroc 0.779 f1_score 0.512


Epoch: [28]  [  0/269]  eta: 0:02:48  lr: 0.000048  bag_loss: 0.3436 (0.3436)  instance_loss: 0.8569 (0.8569)  time: 0.6275  data: 0.6001  max mem: 337
Epoch: [28]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.1041 (0.4200)  instance_loss: 0.8721 (0.9014)  time: 0.0133  data: 0.0011  max mem: 337
Epoch: [28]  [200/269]  eta: 0:00:01  lr: 0.000046  bag_loss: 0.2624 (0.5160)  instance_loss: 0.8595 (0.8966)  time: 0.0140  data: 0.0012  max mem: 337
Epoch: [28]  [268/269]  eta: 0:00:00  lr: 0.000045  bag_loss: 0.4077 (0.5070)  instance_loss: 0.7974 (0.8802)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [28] Total time: 0:00:04 (4.3932 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.6086 (0.6086)  acc1: 100.0000 (100.0000)  time: 0.5916  data: 0.5804  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2405 (0.8211)  acc1: 100.0000 (76.6667)  time: 0.0071  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9230 s / it)
* Acc@1 76.667 loss 0.821 auroc 0.736 f1_score 0.402
Test  [  0/200]  eta: 0:01:58  loss: 0.8153 (0.8153)  acc1: 0.0000 (0.0000)  time: 0.5921  data: 0.5826  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3516 (0.8436)  acc1: 100.0000 (72.2772)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0965 (0.6762)  acc1: 100.0000 (78.0000)  time: 0.0088  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1399 s / it)
* Acc@1 78.000 loss 0.676 auroc 0.779 f1_score 0.505


Epoch: [29]  [  0/269]  eta: 0:02:42  lr: 0.000045  bag_loss: 0.1391 (0.1391)  instance_loss: 0.9138 (0.9138)  time: 0.6053  data: 0.5934  max mem: 337
Epoch: [29]  [100/269]  eta: 0:00:03  lr: 0.000043  bag_loss: 0.1859 (0.4945)  instance_loss: 0.8714 (0.8602)  time: 0.0116  data: 0.0011  max mem: 337
Epoch: [29]  [200/269]  eta: 0:00:01  lr: 0.000042  bag_loss: 0.1654 (0.4823)  instance_loss: 0.8326 (0.8675)  time: 0.0121  data: 0.0010  max mem: 337
Epoch: [29]  [268/269]  eta: 0:00:00  lr: 0.000041  bag_loss: 0.1076 (0.5203)  instance_loss: 0.8838 (0.8675)  time: 0.0172  data: 0.0012  max mem: 337
Epoch: [29] Total time: 0:00:04 (4.4286 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.7628 (0.7628)  acc1: 0.0000 (0.0000)  time: 0.6056  data: 0.5933  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2767 (0.8591)  acc1: 100.0000 (70.0000)  time: 0.0070  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9492 s / it)
* Acc@1 70.000 loss 0.859 auroc 0.708 f1_score 0.308
Test  [  0/200]  eta: 0:01:52  loss: 0.1879 (0.1879)  acc1: 100.0000 (100.0000)  time: 0.5601  data: 0.5526  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4449 (0.8819)  acc1: 100.0000 (69.3069)  time: 0.0069  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2349 (0.7384)  acc1: 100.0000 (75.0000)  time: 0.0082  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1068 s / it)
* Acc@1 75.000 loss 0.738 auroc 0.778 f1_score 0.514


Epoch: [30]  [  0/269]  eta: 0:02:36  lr: 0.000041  bag_loss: 0.5904 (0.5904)  instance_loss: 0.9372 (0.9372)  time: 0.5831  data: 0.5721  max mem: 337
Epoch: [30]  [100/269]  eta: 0:00:03  lr: 0.000040  bag_loss: 0.2158 (0.5049)  instance_loss: 0.8346 (0.8827)  time: 0.0119  data: 0.0009  max mem: 337
Epoch: [30]  [200/269]  eta: 0:00:01  lr: 0.000039  bag_loss: 0.2394 (0.5010)  instance_loss: 0.8211 (0.8759)  time: 0.0119  data: 0.0010  max mem: 337
Epoch: [30]  [268/269]  eta: 0:00:00  lr: 0.000038  bag_loss: 0.1299 (0.4812)  instance_loss: 0.8591 (0.8653)  time: 0.0165  data: 0.0013  max mem: 337
Epoch: [30] Total time: 0:00:04 (4.3515 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.7275 (0.7275)  acc1: 100.0000 (100.0000)  time: 0.5920  data: 0.5804  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2652 (0.8589)  acc1: 100.0000 (76.6667)  time: 0.0072  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9323 s / it)
* Acc@1 76.667 loss 0.859 auroc 0.723 f1_score 0.402
Test  [  0/200]  eta: 0:01:56  loss: 0.2125 (0.2125)  acc1: 100.0000 (100.0000)  time: 0.5832  data: 0.5746  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4098 (0.8899)  acc1: 100.0000 (71.2871)  time: 0.0064  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1147 (0.7130)  acc1: 100.0000 (77.0000)  time: 0.0083  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2086 s / it)
* Acc@1 77.000 loss 0.713 auroc 0.780 f1_score 0.522


Epoch: [31]  [  0/269]  eta: 0:02:40  lr: 0.000038  bag_loss: 0.2299 (0.2299)  instance_loss: 0.9892 (0.9892)  time: 0.5970  data: 0.5802  max mem: 337
Epoch: [31]  [100/269]  eta: 0:00:03  lr: 0.000037  bag_loss: 0.0979 (0.3683)  instance_loss: 0.8257 (0.8472)  time: 0.0122  data: 0.0012  max mem: 337
Epoch: [31]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.4894 (0.4544)  instance_loss: 0.9131 (0.8838)  time: 0.0158  data: 0.0014  max mem: 337
Epoch: [31]  [268/269]  eta: 0:00:00  lr: 0.000035  bag_loss: 0.3513 (0.4811)  instance_loss: 0.9443 (0.8995)  time: 0.0169  data: 0.0014  max mem: 337
Epoch: [31] Total time: 0:00:04 (4.5626 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.8731 (0.8731)  acc1: 0.0000 (0.0000)  time: 0.5868  data: 0.5769  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3091 (0.8659)  acc1: 100.0000 (73.3333)  time: 0.0070  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9088 s / it)
* Acc@1 73.333 loss 0.866 auroc 0.727 f1_score 0.384
Test  [  0/200]  eta: 0:01:57  loss: 0.1713 (0.1713)  acc1: 100.0000 (100.0000)  time: 0.5859  data: 0.5781  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5442 (0.9135)  acc1: 100.0000 (68.3168)  time: 0.0058  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1322 (0.7280)  acc1: 100.0000 (76.0000)  time: 0.0089  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1573 s / it)
* Acc@1 76.000 loss 0.728 auroc 0.781 f1_score 0.526


Epoch: [32]  [  0/269]  eta: 0:02:48  lr: 0.000035  bag_loss: 0.0057 (0.0057)  instance_loss: 1.0472 (1.0472)  time: 0.6246  data: 0.6025  max mem: 337
Epoch: [32]  [100/269]  eta: 0:00:03  lr: 0.000033  bag_loss: 0.1251 (0.4170)  instance_loss: 0.8294 (0.8986)  time: 0.0148  data: 0.0014  max mem: 337
Epoch: [32]  [200/269]  eta: 0:00:01  lr: 0.000032  bag_loss: 0.1697 (0.4223)  instance_loss: 0.9037 (0.8887)  time: 0.0140  data: 0.0012  max mem: 337
Epoch: [32]  [268/269]  eta: 0:00:00  lr: 0.000031  bag_loss: 0.2318 (0.4684)  instance_loss: 0.8259 (0.8923)  time: 0.0125  data: 0.0012  max mem: 337
Epoch: [32] Total time: 0:00:04 (4.5070 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 1.0323 (1.0323)  acc1: 0.0000 (0.0000)  time: 0.5991  data: 0.5881  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2959 (0.8736)  acc1: 100.0000 (73.3333)  time: 0.0071  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9412 s / it)
* Acc@1 73.333 loss 0.874 auroc 0.733 f1_score 0.384
Test  [  0/200]  eta: 0:01:56  loss: 0.1098 (0.1098)  acc1: 100.0000 (100.0000)  time: 0.5811  data: 0.5733  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4703 (0.9513)  acc1: 100.0000 (69.3069)  time: 0.0059  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1413 (0.7528)  acc1: 100.0000 (76.0000)  time: 0.0088  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1447 s / it)
* Acc@1 76.000 loss 0.753 auroc 0.782 f1_score 0.509


Epoch: [33]  [  0/269]  eta: 0:02:40  lr: 0.000031  bag_loss: 0.2315 (0.2315)  instance_loss: 0.9016 (0.9016)  time: 0.5971  data: 0.5814  max mem: 337
Epoch: [33]  [100/269]  eta: 0:00:03  lr: 0.000030  bag_loss: 0.1366 (0.5165)  instance_loss: 0.8222 (0.8831)  time: 0.0125  data: 0.0011  max mem: 337
Epoch: [33]  [200/269]  eta: 0:00:01  lr: 0.000029  bag_loss: 0.1859 (0.4506)  instance_loss: 0.8416 (0.8778)  time: 0.0156  data: 0.0013  max mem: 337
Epoch: [33]  [268/269]  eta: 0:00:00  lr: 0.000028  bag_loss: 0.2026 (0.4643)  instance_loss: 0.9767 (0.8787)  time: 0.0145  data: 0.0011  max mem: 337
Epoch: [33] Total time: 0:00:04 (4.4338 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.6160 (0.6160)  acc1: 100.0000 (100.0000)  time: 0.5819  data: 0.5713  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1886 (0.8671)  acc1: 100.0000 (76.6667)  time: 0.0083  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9466 s / it)
* Acc@1 76.667 loss 0.867 auroc 0.714 f1_score 0.320
Test  [  0/200]  eta: 0:01:58  loss: 0.2304 (0.2304)  acc1: 100.0000 (100.0000)  time: 0.5905  data: 0.5766  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2777 (0.9158)  acc1: 100.0000 (72.2772)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0971 (0.7192)  acc1: 100.0000 (78.0000)  time: 0.0081  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.1781 s / it)
* Acc@1 78.000 loss 0.719 auroc 0.777 f1_score 0.539


Epoch: [34]  [  0/269]  eta: 0:02:35  lr: 0.000028  bag_loss: 0.2881 (0.2881)  instance_loss: 0.6464 (0.6464)  time: 0.5784  data: 0.5641  max mem: 337
Epoch: [34]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.2181 (0.4773)  instance_loss: 0.8197 (0.8570)  time: 0.0130  data: 0.0011  max mem: 337
Epoch: [34]  [200/269]  eta: 0:00:01  lr: 0.000026  bag_loss: 0.1254 (0.4483)  instance_loss: 0.8493 (0.8623)  time: 0.0114  data: 0.0010  max mem: 337
Epoch: [34]  [268/269]  eta: 0:00:00  lr: 0.000025  bag_loss: 0.2038 (0.4528)  instance_loss: 0.8091 (0.8628)  time: 0.0144  data: 0.0013  max mem: 337
Epoch: [34] Total time: 0:00:04 (4.3419 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.9596 (0.9596)  acc1: 0.0000 (0.0000)  time: 0.5951  data: 0.5836  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2703 (0.8742)  acc1: 100.0000 (70.0000)  time: 0.0072  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9486 s / it)
* Acc@1 70.000 loss 0.874 auroc 0.741 f1_score 0.361
Test  [  0/200]  eta: 0:01:57  loss: 0.2183 (0.2183)  acc1: 100.0000 (100.0000)  time: 0.5874  data: 0.5793  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5707 (0.9788)  acc1: 100.0000 (68.3168)  time: 0.0061  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1137 (0.7502)  acc1: 100.0000 (77.0000)  time: 0.0083  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1766 s / it)
* Acc@1 77.000 loss 0.750 auroc 0.779 f1_score 0.539


Epoch: [35]  [  0/269]  eta: 0:02:44  lr: 0.000025  bag_loss: 0.2103 (0.2103)  instance_loss: 1.0081 (1.0081)  time: 0.6110  data: 0.5841  max mem: 337
Epoch: [35]  [100/269]  eta: 0:00:03  lr: 0.000024  bag_loss: 0.1580 (0.4341)  instance_loss: 0.8075 (0.8725)  time: 0.0150  data: 0.0012  max mem: 337
Epoch: [35]  [200/269]  eta: 0:00:01  lr: 0.000023  bag_loss: 0.1520 (0.4598)  instance_loss: 0.8210 (0.8751)  time: 0.0157  data: 0.0013  max mem: 337
Epoch: [35]  [268/269]  eta: 0:00:00  lr: 0.000022  bag_loss: 0.3005 (0.4638)  instance_loss: 0.8534 (0.8749)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [35] Total time: 0:00:04 (4.4074 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.8878 (0.8878)  acc1: 0.0000 (0.0000)  time: 0.6004  data: 0.5894  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2688 (0.8834)  acc1: 100.0000 (73.3333)  time: 0.0075  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9600 s / it)
* Acc@1 73.333 loss 0.883 auroc 0.741 f1_score 0.384
Test  [  0/200]  eta: 0:01:54  loss: 0.2435 (0.2435)  acc1: 100.0000 (100.0000)  time: 0.5746  data: 0.5646  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4609 (0.9998)  acc1: 100.0000 (65.3465)  time: 0.0066  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1093 (0.7607)  acc1: 100.0000 (74.5000)  time: 0.0086  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.1901 s / it)
* Acc@1 74.500 loss 0.761 auroc 0.776 f1_score 0.531


Epoch: [36]  [  0/269]  eta: 0:02:42  lr: 0.000022  bag_loss: 0.4092 (0.4092)  instance_loss: 0.8398 (0.8398)  time: 0.6038  data: 0.5900  max mem: 337
Epoch: [36]  [100/269]  eta: 0:00:03  lr: 0.000021  bag_loss: 0.2400 (0.4367)  instance_loss: 0.8143 (0.8395)  time: 0.0105  data: 0.0009  max mem: 337
Epoch: [36]  [200/269]  eta: 0:00:01  lr: 0.000020  bag_loss: 0.2539 (0.4495)  instance_loss: 0.8703 (0.8485)  time: 0.0140  data: 0.0013  max mem: 337
Epoch: [36]  [268/269]  eta: 0:00:00  lr: 0.000019  bag_loss: 0.2921 (0.4613)  instance_loss: 0.8167 (0.8621)  time: 0.0164  data: 0.0013  max mem: 337
Epoch: [36] Total time: 0:00:04 (4.3380 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.8814 (0.8814)  acc1: 0.0000 (0.0000)  time: 0.5917  data: 0.5793  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2758 (0.8681)  acc1: 100.0000 (73.3333)  time: 0.0070  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9336 s / it)
* Acc@1 73.333 loss 0.868 auroc 0.741 f1_score 0.384
Test  [  0/200]  eta: 0:01:57  loss: 0.2298 (0.2298)  acc1: 100.0000 (100.0000)  time: 0.5865  data: 0.5785  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5485 (0.9336)  acc1: 100.0000 (68.3168)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1290 (0.7304)  acc1: 100.0000 (77.0000)  time: 0.0088  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1769 s / it)
* Acc@1 77.000 loss 0.730 auroc 0.779 f1_score 0.542


Epoch: [37]  [  0/269]  eta: 0:02:45  lr: 0.000019  bag_loss: 0.3578 (0.3578)  instance_loss: 0.9159 (0.9159)  time: 0.6169  data: 0.5837  max mem: 337
Epoch: [37]  [100/269]  eta: 0:00:03  lr: 0.000018  bag_loss: 0.2253 (0.3861)  instance_loss: 0.8346 (0.8519)  time: 0.0131  data: 0.0012  max mem: 337
Epoch: [37]  [200/269]  eta: 0:00:01  lr: 0.000017  bag_loss: 0.1176 (0.4587)  instance_loss: 0.8049 (0.8651)  time: 0.0152  data: 0.0013  max mem: 337
Epoch: [37]  [268/269]  eta: 0:00:00  lr: 0.000017  bag_loss: 0.1587 (0.4367)  instance_loss: 0.8303 (0.8628)  time: 0.0139  data: 0.0012  max mem: 337
Epoch: [37] Total time: 0:00:04 (4.4644 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.7827 (0.7827)  acc1: 0.0000 (0.0000)  time: 0.5987  data: 0.5875  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2351 (0.8736)  acc1: 100.0000 (70.0000)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9445 s / it)
* Acc@1 70.000 loss 0.874 auroc 0.741 f1_score 0.361
Test  [  0/200]  eta: 0:02:24  loss: 0.4713 (0.4713)  acc1: 100.0000 (100.0000)  time: 0.7241  data: 0.7110  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4120 (0.9473)  acc1: 100.0000 (70.2970)  time: 0.0066  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1032 (0.7273)  acc1: 100.0000 (77.5000)  time: 0.0080  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.7341 s / it)
* Acc@1 77.500 loss 0.727 auroc 0.776 f1_score 0.509


Epoch: [38]  [  0/269]  eta: 0:02:37  lr: 0.000017  bag_loss: 0.3357 (0.3357)  instance_loss: 0.9067 (0.9067)  time: 0.5857  data: 0.5700  max mem: 337
Epoch: [38]  [100/269]  eta: 0:00:03  lr: 0.000016  bag_loss: 0.1432 (0.3857)  instance_loss: 0.8144 (0.8530)  time: 0.0144  data: 0.0013  max mem: 337
Epoch: [38]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.1949 (0.3995)  instance_loss: 0.8516 (0.8703)  time: 0.0109  data: 0.0009  max mem: 337
Epoch: [38]  [268/269]  eta: 0:00:00  lr: 0.000014  bag_loss: 0.2712 (0.4410)  instance_loss: 0.8535 (0.8718)  time: 0.0148  data: 0.0012  max mem: 337
Epoch: [38] Total time: 0:00:04 (4.4234 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.9979 (0.9979)  acc1: 0.0000 (0.0000)  time: 0.5947  data: 0.5830  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2818 (0.8945)  acc1: 100.0000 (66.6667)  time: 0.0075  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9503 s / it)
* Acc@1 66.667 loss 0.895 auroc 0.743 f1_score 0.346
Test  [  0/200]  eta: 0:01:54  loss: 0.3115 (0.3115)  acc1: 100.0000 (100.0000)  time: 0.5736  data: 0.5644  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4673 (0.9970)  acc1: 100.0000 (67.3267)  time: 0.0063  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1178 (0.7586)  acc1: 100.0000 (75.5000)  time: 0.0092  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1932 s / it)
* Acc@1 75.500 loss 0.759 auroc 0.776 f1_score 0.511


Epoch: [39]  [  0/269]  eta: 0:02:36  lr: 0.000014  bag_loss: 0.0283 (0.0283)  instance_loss: 0.7803 (0.7803)  time: 0.5820  data: 0.5670  max mem: 337
Epoch: [39]  [100/269]  eta: 0:00:03  lr: 0.000013  bag_loss: 0.1355 (0.4587)  instance_loss: 0.9046 (0.8724)  time: 0.0104  data: 0.0009  max mem: 337
Epoch: [39]  [200/269]  eta: 0:00:01  lr: 0.000012  bag_loss: 0.1452 (0.4513)  instance_loss: 0.8460 (0.8715)  time: 0.0164  data: 0.0012  max mem: 337
Epoch: [39]  [268/269]  eta: 0:00:00  lr: 0.000012  bag_loss: 0.0874 (0.4362)  instance_loss: 0.7817 (0.8591)  time: 0.0137  data: 0.0012  max mem: 337
Epoch: [39] Total time: 0:00:04 (4.4267 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.7479 (0.7479)  acc1: 0.0000 (0.0000)  time: 0.6044  data: 0.5932  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2134 (0.8852)  acc1: 100.0000 (73.3333)  time: 0.0071  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9456 s / it)
* Acc@1 73.333 loss 0.885 auroc 0.725 f1_score 0.384
Test  [  0/200]  eta: 0:01:54  loss: 0.2121 (0.2121)  acc1: 100.0000 (100.0000)  time: 0.5749  data: 0.5651  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3360 (0.9679)  acc1: 100.0000 (71.2871)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0823 (0.7437)  acc1: 100.0000 (77.5000)  time: 0.0093  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1729 s / it)
* Acc@1 77.500 loss 0.744 auroc 0.775 f1_score 0.521


Epoch: [40]  [  0/269]  eta: 0:02:35  lr: 0.000012  bag_loss: 0.5313 (0.5313)  instance_loss: 1.1091 (1.1091)  time: 0.5764  data: 0.5618  max mem: 337
Epoch: [40]  [100/269]  eta: 0:00:03  lr: 0.000011  bag_loss: 0.1457 (0.3832)  instance_loss: 0.8533 (0.8658)  time: 0.0164  data: 0.0014  max mem: 337
Epoch: [40]  [200/269]  eta: 0:00:01  lr: 0.000010  bag_loss: 0.3442 (0.4380)  instance_loss: 0.8839 (0.8509)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [40]  [268/269]  eta: 0:00:00  lr: 0.000010  bag_loss: 0.2785 (0.4252)  instance_loss: 0.8924 (0.8579)  time: 0.0125  data: 0.0011  max mem: 337
Epoch: [40] Total time: 0:00:04 (4.4940 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.9339 (0.9339)  acc1: 0.0000 (0.0000)  time: 0.5854  data: 0.5737  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2631 (0.8970)  acc1: 100.0000 (70.0000)  time: 0.0071  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9233 s / it)
* Acc@1 70.000 loss 0.897 auroc 0.735 f1_score 0.361
Test  [  0/200]  eta: 0:01:58  loss: 0.2243 (0.2243)  acc1: 100.0000 (100.0000)  time: 0.5931  data: 0.5851  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4804 (0.9941)  acc1: 100.0000 (67.3267)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1008 (0.7567)  acc1: 100.0000 (76.5000)  time: 0.0097  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.2271 s / it)
* Acc@1 76.500 loss 0.757 auroc 0.775 f1_score 0.530


Epoch: [41]  [  0/269]  eta: 0:02:40  lr: 0.000010  bag_loss: 0.4160 (0.4160)  instance_loss: 0.9543 (0.9543)  time: 0.5967  data: 0.5782  max mem: 337
Epoch: [41]  [100/269]  eta: 0:00:03  lr: 0.000009  bag_loss: 0.2565 (0.4311)  instance_loss: 0.8687 (0.8750)  time: 0.0128  data: 0.0010  max mem: 337
Epoch: [41]  [200/269]  eta: 0:00:01  lr: 0.000008  bag_loss: 0.1872 (0.4384)  instance_loss: 0.8534 (0.8658)  time: 0.0130  data: 0.0009  max mem: 337
Epoch: [41]  [268/269]  eta: 0:00:00  lr: 0.000008  bag_loss: 0.3202 (0.4379)  instance_loss: 0.8656 (0.8682)  time: 0.0147  data: 0.0012  max mem: 337
Epoch: [41] Total time: 0:00:04 (4.4086 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.8922 (0.8922)  acc1: 0.0000 (0.0000)  time: 0.6113  data: 0.5999  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2233 (0.8871)  acc1: 100.0000 (73.3333)  time: 0.0071  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9615 s / it)
* Acc@1 73.333 loss 0.887 auroc 0.739 f1_score 0.384
Test  [  0/200]  eta: 0:01:55  loss: 0.1873 (0.1873)  acc1: 100.0000 (100.0000)  time: 0.5793  data: 0.5698  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3606 (0.9757)  acc1: 100.0000 (71.2871)  time: 0.0066  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0862 (0.7507)  acc1: 100.0000 (77.0000)  time: 0.0090  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2099 s / it)
* Acc@1 77.000 loss 0.751 auroc 0.776 f1_score 0.517


Epoch: [42]  [  0/269]  eta: 0:02:48  lr: 0.000008  bag_loss: 1.5919 (1.5919)  instance_loss: 0.8722 (0.8722)  time: 0.6247  data: 0.6090  max mem: 337
Epoch: [42]  [100/269]  eta: 0:00:03  lr: 0.000007  bag_loss: 0.1782 (0.4698)  instance_loss: 0.8821 (0.8812)  time: 0.0142  data: 0.0012  max mem: 337
Epoch: [42]  [200/269]  eta: 0:00:01  lr: 0.000006  bag_loss: 0.2447 (0.4278)  instance_loss: 0.8363 (0.8696)  time: 0.0116  data: 0.0010  max mem: 337
Epoch: [42]  [268/269]  eta: 0:00:00  lr: 0.000006  bag_loss: 0.2111 (0.4462)  instance_loss: 0.9231 (0.8695)  time: 0.0144  data: 0.0013  max mem: 337
Epoch: [42] Total time: 0:00:04 (4.4552 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.8701 (0.8701)  acc1: 0.0000 (0.0000)  time: 0.5873  data: 0.5771  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2251 (0.8830)  acc1: 100.0000 (73.3333)  time: 0.0073  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9292 s / it)
* Acc@1 73.333 loss 0.883 auroc 0.738 f1_score 0.384
Test  [  0/200]  eta: 0:01:58  loss: 0.1978 (0.1978)  acc1: 100.0000 (100.0000)  time: 0.5926  data: 0.5833  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4090 (0.9797)  acc1: 100.0000 (71.2871)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0884 (0.7516)  acc1: 100.0000 (77.5000)  time: 0.0100  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.2035 s / it)
* Acc@1 77.500 loss 0.752 auroc 0.777 f1_score 0.521


Epoch: [43]  [  0/269]  eta: 0:02:41  lr: 0.000006  bag_loss: 0.3555 (0.3555)  instance_loss: 0.9338 (0.9338)  time: 0.6018  data: 0.5719  max mem: 337
Epoch: [43]  [100/269]  eta: 0:00:03  lr: 0.000005  bag_loss: 0.2394 (0.4403)  instance_loss: 0.8568 (0.8660)  time: 0.0132  data: 0.0010  max mem: 337
Epoch: [43]  [200/269]  eta: 0:00:01  lr: 0.000005  bag_loss: 0.3020 (0.4347)  instance_loss: 0.8371 (0.8558)  time: 0.0129  data: 0.0010  max mem: 337
Epoch: [43]  [268/269]  eta: 0:00:00  lr: 0.000004  bag_loss: 0.1398 (0.4173)  instance_loss: 0.8388 (0.8560)  time: 0.0167  data: 0.0013  max mem: 337
Epoch: [43] Total time: 0:00:04 (4.4466 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.8346 (0.8346)  acc1: 0.0000 (0.0000)  time: 0.6027  data: 0.5911  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2152 (0.8802)  acc1: 100.0000 (73.3333)  time: 0.0083  data: 0.0011  max mem: 337
Val Total time: 0:00:00 (0.9639 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.738 f1_score 0.384
Test  [  0/200]  eta: 0:01:57  loss: 0.2460 (0.2460)  acc1: 100.0000 (100.0000)  time: 0.5880  data: 0.5793  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4146 (0.9741)  acc1: 100.0000 (71.2871)  time: 0.0071  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0863 (0.7458)  acc1: 100.0000 (78.0000)  time: 0.0089  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2092 s / it)
* Acc@1 78.000 loss 0.746 auroc 0.776 f1_score 0.533


Epoch: [44]  [  0/269]  eta: 0:02:36  lr: 0.000004  bag_loss: 0.2767 (0.2767)  instance_loss: 0.9312 (0.9312)  time: 0.5810  data: 0.5678  max mem: 337
Epoch: [44]  [100/269]  eta: 0:00:03  lr: 0.000004  bag_loss: 0.0600 (0.4985)  instance_loss: 0.8204 (0.8622)  time: 0.0156  data: 0.0011  max mem: 337
Epoch: [44]  [200/269]  eta: 0:00:01  lr: 0.000003  bag_loss: 0.2319 (0.4583)  instance_loss: 0.8537 (0.8630)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [44]  [268/269]  eta: 0:00:00  lr: 0.000003  bag_loss: 0.1942 (0.4266)  instance_loss: 0.8791 (0.8577)  time: 0.0150  data: 0.0014  max mem: 337
Epoch: [44] Total time: 0:00:04 (4.4815 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.8569 (0.8569)  acc1: 0.0000 (0.0000)  time: 0.6079  data: 0.5957  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2210 (0.8805)  acc1: 100.0000 (73.3333)  time: 0.0080  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9647 s / it)
* Acc@1 73.333 loss 0.881 auroc 0.741 f1_score 0.384
Test  [  0/200]  eta: 0:01:55  loss: 0.2446 (0.2446)  acc1: 100.0000 (100.0000)  time: 0.5755  data: 0.5668  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4387 (0.9770)  acc1: 100.0000 (70.2970)  time: 0.0065  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0891 (0.7476)  acc1: 100.0000 (78.0000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1660 s / it)
* Acc@1 78.000 loss 0.748 auroc 0.776 f1_score 0.536


Epoch: [45]  [  0/269]  eta: 0:02:45  lr: 0.000003  bag_loss: 1.4399 (1.4399)  instance_loss: 1.1570 (1.1570)  time: 0.6134  data: 0.5829  max mem: 337
Epoch: [45]  [100/269]  eta: 0:00:03  lr: 0.000003  bag_loss: 0.2750 (0.4357)  instance_loss: 0.8679 (0.8442)  time: 0.0137  data: 0.0011  max mem: 337
Epoch: [45]  [200/269]  eta: 0:00:01  lr: 0.000002  bag_loss: 0.1368 (0.4359)  instance_loss: 0.8256 (0.8597)  time: 0.0128  data: 0.0011  max mem: 337
Epoch: [45]  [268/269]  eta: 0:00:00  lr: 0.000002  bag_loss: 0.2092 (0.4365)  instance_loss: 0.8130 (0.8556)  time: 0.0138  data: 0.0011  max mem: 337
Epoch: [45] Total time: 0:00:04 (4.3944 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.8519 (0.8519)  acc1: 0.0000 (0.0000)  time: 0.5985  data: 0.5863  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2209 (0.8796)  acc1: 100.0000 (73.3333)  time: 0.0081  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9612 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.738 f1_score 0.384
Test  [  0/200]  eta: 0:01:54  loss: 0.2575 (0.2575)  acc1: 100.0000 (100.0000)  time: 0.5718  data: 0.5630  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4468 (0.9727)  acc1: 100.0000 (71.2871)  time: 0.0063  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0891 (0.7451)  acc1: 100.0000 (78.5000)  time: 0.0095  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1975 s / it)
* Acc@1 78.500 loss 0.745 auroc 0.776 f1_score 0.537


Epoch: [46]  [  0/269]  eta: 0:02:34  lr: 0.000002  bag_loss: 0.0356 (0.0356)  instance_loss: 0.7035 (0.7035)  time: 0.5741  data: 0.5466  max mem: 337
Epoch: [46]  [100/269]  eta: 0:00:03  lr: 0.000002  bag_loss: 0.1098 (0.5136)  instance_loss: 0.7940 (0.8772)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [46]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.2247 (0.4383)  instance_loss: 0.8082 (0.8637)  time: 0.0134  data: 0.0010  max mem: 337
Epoch: [46]  [268/269]  eta: 0:00:00  lr: 0.000001  bag_loss: 0.1535 (0.4193)  instance_loss: 0.8516 (0.8616)  time: 0.0129  data: 0.0012  max mem: 337
Epoch: [46] Total time: 0:00:04 (4.3832 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.8372 (0.8372)  acc1: 0.0000 (0.0000)  time: 0.6043  data: 0.5915  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2180 (0.8792)  acc1: 100.0000 (73.3333)  time: 0.0078  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9510 s / it)
* Acc@1 73.333 loss 0.879 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:59  loss: 0.2574 (0.2574)  acc1: 100.0000 (100.0000)  time: 0.5950  data: 0.5859  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4318 (0.9693)  acc1: 100.0000 (71.2871)  time: 0.0065  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0880 (0.7435)  acc1: 100.0000 (78.5000)  time: 0.0083  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.2026 s / it)
* Acc@1 78.500 loss 0.743 auroc 0.776 f1_score 0.537


Epoch: [47]  [  0/269]  eta: 0:02:42  lr: 0.000001  bag_loss: 0.0677 (0.0677)  instance_loss: 0.9623 (0.9623)  time: 0.6026  data: 0.5736  max mem: 337
Epoch: [47]  [100/269]  eta: 0:00:03  lr: 0.000001  bag_loss: 0.2559 (0.3722)  instance_loss: 0.8483 (0.8570)  time: 0.0155  data: 0.0011  max mem: 337
Epoch: [47]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.0829 (0.4159)  instance_loss: 0.8034 (0.8551)  time: 0.0148  data: 0.0012  max mem: 337
Epoch: [47]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1989 (0.4170)  instance_loss: 0.8979 (0.8631)  time: 0.0140  data: 0.0014  max mem: 337
Epoch: [47] Total time: 0:00:04 (4.4447 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.8420 (0.8420)  acc1: 0.0000 (0.0000)  time: 0.5885  data: 0.5764  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2188 (0.8793)  acc1: 100.0000 (73.3333)  time: 0.0082  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9548 s / it)
* Acc@1 73.333 loss 0.879 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:57  loss: 0.2559 (0.2559)  acc1: 100.0000 (100.0000)  time: 0.5869  data: 0.5780  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4322 (0.9697)  acc1: 100.0000 (71.2871)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0882 (0.7439)  acc1: 100.0000 (78.5000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1906 s / it)
* Acc@1 78.500 loss 0.744 auroc 0.776 f1_score 0.537


Epoch: [48]  [  0/269]  eta: 0:02:39  lr: 0.000000  bag_loss: 0.0369 (0.0369)  instance_loss: 0.6288 (0.6288)  time: 0.5941  data: 0.5797  max mem: 337
Epoch: [48]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.1730 (0.4050)  instance_loss: 0.7826 (0.8525)  time: 0.0130  data: 0.0012  max mem: 337
Epoch: [48]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1848 (0.4460)  instance_loss: 0.9056 (0.8780)  time: 0.0132  data: 0.0012  max mem: 337
Epoch: [48]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1166 (0.4178)  instance_loss: 0.9123 (0.8692)  time: 0.0145  data: 0.0013  max mem: 337
Epoch: [48] Total time: 0:00:04 (4.5077 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.8472 (0.8472)  acc1: 0.0000 (0.0000)  time: 0.5894  data: 0.5778  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2202 (0.8797)  acc1: 100.0000 (73.3333)  time: 0.0074  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9367 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:57  loss: 0.2556 (0.2556)  acc1: 100.0000 (100.0000)  time: 0.5865  data: 0.5764  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4365 (0.9704)  acc1: 100.0000 (71.2871)  time: 0.0064  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0891 (0.7444)  acc1: 100.0000 (78.5000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1646 s / it)
* Acc@1 78.500 loss 0.744 auroc 0.776 f1_score 0.537


Epoch: [49]  [  0/269]  eta: 0:02:38  lr: 0.000000  bag_loss: 2.0841 (2.0841)  instance_loss: 1.1751 (1.1751)  time: 0.5902  data: 0.5743  max mem: 337
Epoch: [49]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.1373 (0.4280)  instance_loss: 0.7949 (0.8584)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [49]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1772 (0.4115)  instance_loss: 0.8683 (0.8498)  time: 0.0113  data: 0.0011  max mem: 337
Epoch: [49]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1795 (0.4107)  instance_loss: 0.8143 (0.8523)  time: 0.0154  data: 0.0011  max mem: 337
Epoch: [49] Total time: 0:00:04 (4.4681 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.8461 (0.8461)  acc1: 0.0000 (0.0000)  time: 0.5858  data: 0.5756  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2200 (0.8797)  acc1: 100.0000 (73.3333)  time: 0.0071  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9240 s / it)
* Acc@1 73.333 loss 0.880 auroc 0.734 f1_score 0.384
Test  [  0/200]  eta: 0:01:59  loss: 0.2566 (0.2566)  acc1: 100.0000 (100.0000)  time: 0.5958  data: 0.5855  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4353 (0.9704)  acc1: 100.0000 (71.2871)  time: 0.0062  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0889 (0.7443)  acc1: 100.0000 (78.5000)  time: 0.0086  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1692 s / it)
* Acc@1 78.500 loss 0.744 auroc 0.776 f1_score 0.537


Results on best epoch:
{'epoch': 28, 'val_acc': 76.66666666666667, 'val_auc': 0.7363314628601074, 'val_f1': 0.4020833373069763, 'test_acc': 78.0, 'test_auc': 0.7786926031112671, 'test_f1': 0.5049492716789246}
Wandb run dir: /fs2/comm/kpgrp/yelinfen/Documents/ACMIL/wandb/offline-run-20250807_114336-et0mlu64/files
Used config:
{'B': 1,
 'D_feat': 512,
 'D_inner': 256,
 'arch': 'clam_sb',
 'augment_epoch': 1,
 'backbone': 'Resnet18',
 'config': 'config/patch_classification_camelyon17_config.yml',
 'data_dir': './Features/CAM17_res18',
 'dataset': 'camelyon17',
 'heatmap_arguments': {'alpha': 0.4,
                       'binarize': False,
                       'blank_canvas': False,
                       'blur': True,
                       'cmap': 'jet',
                       'custom_downsample': 1,
                       'vis_level': -1},
 'load_head_checkpoints': False,
 'lr': 0.0001,
 'min_lr': 0,
 'n_class': 4,
 'n_shot': -1,
 'n_token': 4,
 'n_worker': 8,
 'optim': 'sgd',
 'pin_memory': False,
 'pretrain': 'natural_supervsied',
 'seed': 1,
 'start_epoch': 0,
 'train_epoch': 50,
 'w_loss': 1.0,
 'wandb_mode': 'offline',
 'warmup_epoch': 5,
 'wd': 0.0005}
get dataset
Epoch: [0]  [  0/269]  eta: 0:11:50  lr: 0.000000  bag_loss: 1.6147 (1.6147)  instance_loss: 1.0604 (1.0604)  time: 2.6409  data: 0.5810  max mem: 140
Epoch: [0]  [100/269]  eta: 0:00:06  lr: 0.000007  bag_loss: 1.2152 (1.4975)  instance_loss: 1.0366 (1.0609)  time: 0.0130  data: 0.0010  max mem: 337
Epoch: [0]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.6393 (1.3457)  instance_loss: 1.0353 (1.0583)  time: 0.0141  data: 0.0010  max mem: 337
Epoch: [0]  [268/269]  eta: 0:00:00  lr: 0.000020  bag_loss: 0.5639 (1.2608)  instance_loss: 0.9462 (1.0342)  time: 0.0164  data: 0.0012  max mem: 337
Epoch: [0] Total time: 0:00:06 (6.8707 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 2.3864 (2.3864)  acc1: 0.0000 (0.0000)  time: 0.5906  data: 0.5704  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4663 (0.8470)  acc1: 100.0000 (76.6667)  time: 0.0092  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.0095 s / it)
* Acc@1 76.667 loss 0.847 auroc 0.416 f1_score 0.217
Test  [  0/200]  eta: 0:01:59  loss: 1.7000 (1.7000)  acc1: 0.0000 (0.0000)  time: 0.5976  data: 0.5916  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4552 (1.1000)  acc1: 100.0000 (59.4059)  time: 0.0089  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6392 (1.0850)  acc1: 100.0000 (60.5000)  time: 0.0121  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.6872 s / it)
* Acc@1 60.500 loss 1.085 auroc 0.592 f1_score 0.188


Epoch: [1]  [  0/269]  eta: 0:02:49  lr: 0.000020  bag_loss: 0.6750 (0.6750)  instance_loss: 0.9410 (0.9410)  time: 0.6286  data: 0.6106  max mem: 337
Epoch: [1]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.4344 (1.0028)  instance_loss: 0.9784 (1.0052)  time: 0.0180  data: 0.0011  max mem: 337
Epoch: [1]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.4901 (1.0281)  instance_loss: 0.9086 (1.0052)  time: 0.0162  data: 0.0011  max mem: 337
Epoch: [1]  [268/269]  eta: 0:00:00  lr: 0.000040  bag_loss: 0.6037 (1.0559)  instance_loss: 1.0575 (1.0245)  time: 0.0143  data: 0.0010  max mem: 337
Epoch: [1] Total time: 0:00:04 (4.8933 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 1.8721 (1.8721)  acc1: 0.0000 (0.0000)  time: 0.6280  data: 0.6204  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5441 (0.8358)  acc1: 100.0000 (76.6667)  time: 0.0108  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.0942 s / it)
* Acc@1 76.667 loss 0.836 auroc 0.522 f1_score 0.217
Test  [  0/200]  eta: 0:02:04  loss: 1.8058 (1.8058)  acc1: 0.0000 (0.0000)  time: 0.6224  data: 0.6127  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5929 (1.0707)  acc1: 100.0000 (59.4059)  time: 0.0095  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6729 (1.0422)  acc1: 100.0000 (60.5000)  time: 0.0119  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.7551 s / it)
* Acc@1 60.500 loss 1.042 auroc 0.631 f1_score 0.188


Epoch: [2]  [  0/269]  eta: 0:03:06  lr: 0.000040  bag_loss: 0.4830 (0.4830)  instance_loss: 0.8261 (0.8261)  time: 0.6919  data: 0.6559  max mem: 337
Epoch: [2]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.4303 (1.0615)  instance_loss: 0.9602 (0.9983)  time: 0.0142  data: 0.0012  max mem: 337
Epoch: [2]  [200/269]  eta: 0:00:01  lr: 0.000055  bag_loss: 0.6660 (1.0505)  instance_loss: 0.9591 (1.0236)  time: 0.0181  data: 0.0012  max mem: 337
Epoch: [2]  [268/269]  eta: 0:00:00  lr: 0.000060  bag_loss: 0.5131 (1.0591)  instance_loss: 1.0558 (1.0304)  time: 0.0125  data: 0.0011  max mem: 337
Epoch: [2] Total time: 0:00:05 (5.0074 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 1.7813 (1.7813)  acc1: 0.0000 (0.0000)  time: 0.6193  data: 0.6100  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4999 (0.7999)  acc1: 100.0000 (76.6667)  time: 0.0077  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0352 s / it)
* Acc@1 76.667 loss 0.800 auroc 0.677 f1_score 0.217
Test  [  0/200]  eta: 0:02:09  loss: 1.7640 (1.7640)  acc1: 0.0000 (0.0000)  time: 0.6467  data: 0.6395  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5298 (1.0637)  acc1: 100.0000 (59.4059)  time: 0.0084  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5761 (1.0216)  acc1: 100.0000 (60.5000)  time: 0.0109  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.7372 s / it)
* Acc@1 60.500 loss 1.022 auroc 0.684 f1_score 0.188


Epoch: [3]  [  0/269]  eta: 0:02:52  lr: 0.000060  bag_loss: 0.5998 (0.5998)  instance_loss: 1.0220 (1.0220)  time: 0.6410  data: 0.6253  max mem: 337
Epoch: [3]  [100/269]  eta: 0:00:03  lr: 0.000067  bag_loss: 0.6557 (1.0130)  instance_loss: 1.0634 (1.0398)  time: 0.0123  data: 0.0010  max mem: 337
Epoch: [3]  [200/269]  eta: 0:00:01  lr: 0.000075  bag_loss: 0.5477 (0.9853)  instance_loss: 1.0265 (1.0125)  time: 0.0145  data: 0.0011  max mem: 337
Epoch: [3]  [268/269]  eta: 0:00:00  lr: 0.000080  bag_loss: 0.7275 (1.0366)  instance_loss: 0.9845 (1.0268)  time: 0.0131  data: 0.0010  max mem: 337
Epoch: [3] Total time: 0:00:04 (4.9026 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 2.2313 (2.2313)  acc1: 0.0000 (0.0000)  time: 0.6307  data: 0.6175  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.6680 (0.8806)  acc1: 100.0000 (76.6667)  time: 0.0081  data: 0.0006  max mem: 337
Val Total time: 0:00:01 (1.0400 s / it)
* Acc@1 76.667 loss 0.881 auroc 0.798 f1_score 0.217
Test  [  0/200]  eta: 0:02:08  loss: 1.2710 (1.2710)  acc1: 0.0000 (0.0000)  time: 0.6404  data: 0.6316  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7362 (1.1037)  acc1: 100.0000 (59.4059)  time: 0.0093  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6595 (1.0686)  acc1: 100.0000 (60.5000)  time: 0.0113  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.7562 s / it)
* Acc@1 60.500 loss 1.069 auroc 0.683 f1_score 0.188


Epoch: [4]  [  0/269]  eta: 0:03:00  lr: 0.000080  bag_loss: 0.5282 (0.5282)  instance_loss: 0.8336 (0.8336)  time: 0.6716  data: 0.6362  max mem: 337
Epoch: [4]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.4887 (0.9975)  instance_loss: 1.0016 (1.0470)  time: 0.0168  data: 0.0011  max mem: 337
Epoch: [4]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.8446 (0.9782)  instance_loss: 1.0834 (1.0283)  time: 0.0137  data: 0.0012  max mem: 337
Epoch: [4]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 1.0149 (1.0279)  instance_loss: 1.2256 (1.0411)  time: 0.0112  data: 0.0011  max mem: 337
Epoch: [4] Total time: 0:00:04 (4.8318 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 1.5532 (1.5532)  acc1: 0.0000 (0.0000)  time: 0.6232  data: 0.6151  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.9618 (0.9992)  acc1: 100.0000 (66.6667)  time: 0.0082  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0322 s / it)
* Acc@1 66.667 loss 0.999 auroc 0.836 f1_score 0.343
Test  [  0/200]  eta: 0:02:10  loss: 1.0952 (1.0952)  acc1: 0.0000 (0.0000)  time: 0.6543  data: 0.6464  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 1.0722 (1.2089)  acc1: 0.0000 (52.4752)  time: 0.0090  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.7794 (1.1238)  acc1: 100.0000 (63.0000)  time: 0.0107  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.7399 s / it)
* Acc@1 63.000 loss 1.124 auroc 0.702 f1_score 0.370


Epoch: [5]  [  0/269]  eta: 0:02:57  lr: 0.000100  bag_loss: 1.2943 (1.2943)  instance_loss: 1.3886 (1.3886)  time: 0.6609  data: 0.6448  max mem: 337
Epoch: [5]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.5122 (1.0278)  instance_loss: 0.8794 (1.0206)  time: 0.0135  data: 0.0010  max mem: 337
Epoch: [5]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.3109 (0.9801)  instance_loss: 0.8474 (0.9919)  time: 0.0183  data: 0.0011  max mem: 337
Epoch: [5]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.7358 (1.0240)  instance_loss: 0.9838 (1.0131)  time: 0.0170  data: 0.0010  max mem: 337
Epoch: [5] Total time: 0:00:04 (4.8980 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 2.4603 (2.4603)  acc1: 0.0000 (0.0000)  time: 0.6424  data: 0.6315  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.6404 (0.8385)  acc1: 100.0000 (76.6667)  time: 0.0107  data: 0.0014  max mem: 337
Val Total time: 0:00:01 (1.1124 s / it)
* Acc@1 76.667 loss 0.838 auroc 0.846 f1_score 0.221
Test  [  0/200]  eta: 0:02:07  loss: 1.5540 (1.5540)  acc1: 0.0000 (0.0000)  time: 0.6368  data: 0.6286  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7805 (1.0258)  acc1: 100.0000 (65.3465)  time: 0.0080  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6355 (0.9673)  acc1: 100.0000 (66.0000)  time: 0.0120  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6676 s / it)
* Acc@1 66.000 loss 0.967 auroc 0.721 f1_score 0.293


Epoch: [6]  [  0/269]  eta: 0:02:59  lr: 0.000100  bag_loss: 0.5231 (0.5231)  instance_loss: 1.0798 (1.0798)  time: 0.6681  data: 0.6391  max mem: 337
Epoch: [6]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.2084 (0.8757)  instance_loss: 0.8038 (0.9936)  time: 0.0168  data: 0.0010  max mem: 337
Epoch: [6]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.3316 (0.9196)  instance_loss: 0.8622 (0.9948)  time: 0.0149  data: 0.0009  max mem: 337
Epoch: [6]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.7201 (0.9680)  instance_loss: 1.0631 (1.0093)  time: 0.0141  data: 0.0010  max mem: 337
Epoch: [6] Total time: 0:00:04 (4.8762 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.7550 (0.7550)  acc1: 100.0000 (100.0000)  time: 0.6224  data: 0.6141  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.6790 (0.7260)  acc1: 100.0000 (90.0000)  time: 0.0102  data: 0.0009  max mem: 337
Val Total time: 0:00:01 (1.0798 s / it)
* Acc@1 90.000 loss 0.726 auroc 0.941 f1_score 0.485
Test  [  0/200]  eta: 0:02:08  loss: 1.3194 (1.3194)  acc1: 0.0000 (0.0000)  time: 0.6440  data: 0.6311  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.8457 (0.9321)  acc1: 100.0000 (73.2673)  time: 0.0075  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5302 (0.8603)  acc1: 100.0000 (79.0000)  time: 0.0118  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6294 s / it)
* Acc@1 79.000 loss 0.860 auroc 0.773 f1_score 0.475


Epoch: [7]  [  0/269]  eta: 0:02:48  lr: 0.000100  bag_loss: 0.6931 (0.6931)  instance_loss: 0.9648 (0.9648)  time: 0.6274  data: 0.6122  max mem: 337
Epoch: [7]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.2153 (0.8630)  instance_loss: 0.9061 (1.0361)  time: 0.0132  data: 0.0010  max mem: 337
Epoch: [7]  [200/269]  eta: 0:00:01  lr: 0.000099  bag_loss: 0.2765 (0.8623)  instance_loss: 0.9895 (1.0522)  time: 0.0142  data: 0.0010  max mem: 337
Epoch: [7]  [268/269]  eta: 0:00:00  lr: 0.000099  bag_loss: 0.6275 (0.8569)  instance_loss: 1.0480 (1.0496)  time: 0.0128  data: 0.0010  max mem: 337
Epoch: [7] Total time: 0:00:04 (4.8090 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.3492 (0.3492)  acc1: 100.0000 (100.0000)  time: 0.6302  data: 0.6199  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3980 (0.5068)  acc1: 100.0000 (90.0000)  time: 0.0093  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.0815 s / it)
* Acc@1 90.000 loss 0.507 auroc 0.945 f1_score 0.485
Test  [  0/200]  eta: 0:02:13  loss: 1.3149 (1.3149)  acc1: 0.0000 (0.0000)  time: 0.6659  data: 0.6536  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5200 (0.7753)  acc1: 100.0000 (78.2178)  time: 0.0079  data: 0.0015  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2788 (0.7123)  acc1: 100.0000 (81.5000)  time: 0.0118  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.6960 s / it)
* Acc@1 81.500 loss 0.712 auroc 0.776 f1_score 0.474


Epoch: [8]  [  0/269]  eta: 0:02:50  lr: 0.000099  bag_loss: 0.7847 (0.7847)  instance_loss: 0.9292 (0.9292)  time: 0.6324  data: 0.6197  max mem: 337
Epoch: [8]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.2810 (0.6675)  instance_loss: 0.9607 (1.0206)  time: 0.0141  data: 0.0011  max mem: 337
Epoch: [8]  [200/269]  eta: 0:00:01  lr: 0.000098  bag_loss: 0.2107 (0.7334)  instance_loss: 0.9114 (1.0457)  time: 0.0118  data: 0.0010  max mem: 337
Epoch: [8]  [268/269]  eta: 0:00:00  lr: 0.000098  bag_loss: 0.2949 (0.7814)  instance_loss: 0.9074 (1.0526)  time: 0.0169  data: 0.0012  max mem: 337
Epoch: [8] Total time: 0:00:04 (4.8273 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 1.0974 (1.0974)  acc1: 0.0000 (0.0000)  time: 0.6618  data: 0.6485  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4087 (0.5110)  acc1: 100.0000 (86.6667)  time: 0.0102  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.1392 s / it)
* Acc@1 86.667 loss 0.511 auroc 0.939 f1_score 0.449
Test  [  0/200]  eta: 0:02:06  loss: 1.0306 (1.0306)  acc1: 0.0000 (0.0000)  time: 0.6322  data: 0.6223  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.6056 (0.7443)  acc1: 100.0000 (78.2178)  time: 0.0077  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2420 (0.6908)  acc1: 100.0000 (80.5000)  time: 0.0118  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.5966 s / it)
* Acc@1 80.500 loss 0.691 auroc 0.783 f1_score 0.490


Epoch: [9]  [  0/269]  eta: 0:02:59  lr: 0.000098  bag_loss: 0.1866 (0.1866)  instance_loss: 1.8628 (1.8628)  time: 0.6687  data: 0.6529  max mem: 337
Epoch: [9]  [100/269]  eta: 0:00:03  lr: 0.000098  bag_loss: 0.3055 (0.7470)  instance_loss: 1.0772 (1.0079)  time: 0.0139  data: 0.0011  max mem: 337
Epoch: [9]  [200/269]  eta: 0:00:01  lr: 0.000097  bag_loss: 0.3618 (0.7184)  instance_loss: 0.9225 (1.0361)  time: 0.0169  data: 0.0014  max mem: 337
Epoch: [9]  [268/269]  eta: 0:00:00  lr: 0.000097  bag_loss: 0.5968 (0.7729)  instance_loss: 0.9004 (1.0553)  time: 0.0128  data: 0.0011  max mem: 337
Epoch: [9] Total time: 0:00:04 (4.8659 s / it)
Val  [ 0/30]  eta: 0:00:20  loss: 0.0785 (0.0785)  acc1: 100.0000 (100.0000)  time: 0.6799  data: 0.6617  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3816 (0.4582)  acc1: 100.0000 (90.0000)  time: 0.0091  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.1556 s / it)
* Acc@1 90.000 loss 0.458 auroc 0.939 f1_score 0.485
Test  [  0/200]  eta: 0:02:05  loss: 1.7447 (1.7447)  acc1: 0.0000 (0.0000)  time: 0.6262  data: 0.6176  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4044 (0.7481)  acc1: 100.0000 (76.2376)  time: 0.0080  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2105 (0.6735)  acc1: 100.0000 (81.0000)  time: 0.0114  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6089 s / it)
* Acc@1 81.000 loss 0.673 auroc 0.778 f1_score 0.442


Epoch: [10]  [  0/269]  eta: 0:03:00  lr: 0.000097  bag_loss: 0.1497 (0.1497)  instance_loss: 1.2200 (1.2200)  time: 0.6720  data: 0.6466  max mem: 337
Epoch: [10]  [100/269]  eta: 0:00:04  lr: 0.000097  bag_loss: 0.1486 (0.5952)  instance_loss: 0.8683 (1.0592)  time: 0.0159  data: 0.0010  max mem: 337
Epoch: [10]  [200/269]  eta: 0:00:01  lr: 0.000096  bag_loss: 0.5901 (0.7601)  instance_loss: 1.0104 (1.0814)  time: 0.0160  data: 0.0011  max mem: 337
Epoch: [10]  [268/269]  eta: 0:00:00  lr: 0.000096  bag_loss: 0.1429 (0.7243)  instance_loss: 0.9073 (1.0498)  time: 0.0131  data: 0.0009  max mem: 337
Epoch: [10] Total time: 0:00:04 (4.9721 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.5921 (0.5921)  acc1: 100.0000 (100.0000)  time: 0.6617  data: 0.6501  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2869 (0.4509)  acc1: 100.0000 (90.0000)  time: 0.0104  data: 0.0009  max mem: 337
Val Total time: 0:00:01 (1.1240 s / it)
* Acc@1 90.000 loss 0.451 auroc 0.871 f1_score 0.485
Test  [  0/200]  eta: 0:02:03  loss: 1.4351 (1.4351)  acc1: 0.0000 (0.0000)  time: 0.6177  data: 0.6082  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3245 (0.6950)  acc1: 100.0000 (76.2376)  time: 0.0081  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1636 (0.6768)  acc1: 100.0000 (78.0000)  time: 0.0116  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.6121 s / it)
* Acc@1 78.000 loss 0.677 auroc 0.773 f1_score 0.426


Epoch: [11]  [  0/269]  eta: 0:02:52  lr: 0.000096  bag_loss: 0.4393 (0.4393)  instance_loss: 0.7893 (0.7893)  time: 0.6431  data: 0.6232  max mem: 337
Epoch: [11]  [100/269]  eta: 0:00:03  lr: 0.000095  bag_loss: 0.9587 (0.7526)  instance_loss: 1.1502 (1.0197)  time: 0.0141  data: 0.0010  max mem: 337
Epoch: [11]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.2639 (0.7018)  instance_loss: 0.8493 (1.0135)  time: 0.0160  data: 0.0012  max mem: 337
Epoch: [11]  [268/269]  eta: 0:00:00  lr: 0.000094  bag_loss: 0.3194 (0.7287)  instance_loss: 1.2262 (1.0281)  time: 0.0140  data: 0.0010  max mem: 337
Epoch: [11] Total time: 0:00:04 (4.8872 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.3274 (0.3274)  acc1: 100.0000 (100.0000)  time: 0.6561  data: 0.6393  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5437 (0.5372)  acc1: 100.0000 (86.6667)  time: 0.0098  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.1385 s / it)
* Acc@1 86.667 loss 0.537 auroc 0.932 f1_score 0.479
Test  [  0/200]  eta: 0:02:05  loss: 1.0057 (1.0057)  acc1: 0.0000 (0.0000)  time: 0.6294  data: 0.6207  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4819 (0.7423)  acc1: 100.0000 (81.1881)  time: 0.0082  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2497 (0.6839)  acc1: 100.0000 (83.0000)  time: 0.0112  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6765 s / it)
* Acc@1 83.000 loss 0.684 auroc 0.802 f1_score 0.554


Epoch: [12]  [  0/269]  eta: 0:02:59  lr: 0.000094  bag_loss: 0.6182 (0.6182)  instance_loss: 1.3410 (1.3410)  time: 0.6674  data: 0.6448  max mem: 337
Epoch: [12]  [100/269]  eta: 0:00:03  lr: 0.000094  bag_loss: 0.4234 (0.7602)  instance_loss: 0.9012 (1.0733)  time: 0.0181  data: 0.0012  max mem: 337
Epoch: [12]  [200/269]  eta: 0:00:01  lr: 0.000093  bag_loss: 0.2492 (0.7566)  instance_loss: 0.8936 (1.0505)  time: 0.0155  data: 0.0011  max mem: 337
Epoch: [12]  [268/269]  eta: 0:00:00  lr: 0.000092  bag_loss: 0.2091 (0.7284)  instance_loss: 0.8577 (1.0330)  time: 0.0129  data: 0.0009  max mem: 337
Epoch: [12] Total time: 0:00:05 (5.0168 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.3387 (0.3387)  acc1: 100.0000 (100.0000)  time: 0.6495  data: 0.6374  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1938 (0.4015)  acc1: 100.0000 (90.0000)  time: 0.0087  data: 0.0009  max mem: 337
Val Total time: 0:00:01 (1.0706 s / it)
* Acc@1 90.000 loss 0.402 auroc 0.883 f1_score 0.485
Test  [  0/200]  eta: 0:02:06  loss: 1.1586 (1.1586)  acc1: 0.0000 (0.0000)  time: 0.6349  data: 0.6215  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2882 (0.6553)  acc1: 100.0000 (80.1980)  time: 0.0082  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1279 (0.6293)  acc1: 100.0000 (82.0000)  time: 0.0116  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6920 s / it)
* Acc@1 82.000 loss 0.629 auroc 0.796 f1_score 0.519


Epoch: [13]  [  0/269]  eta: 0:02:53  lr: 0.000092  bag_loss: 2.2021 (2.2021)  instance_loss: 1.0747 (1.0747)  time: 0.6434  data: 0.6239  max mem: 337
Epoch: [13]  [100/269]  eta: 0:00:03  lr: 0.000092  bag_loss: 0.4772 (0.7854)  instance_loss: 1.0379 (1.0269)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [13]  [200/269]  eta: 0:00:01  lr: 0.000091  bag_loss: 0.1887 (0.7033)  instance_loss: 0.8908 (1.0005)  time: 0.0144  data: 0.0014  max mem: 337
Epoch: [13]  [268/269]  eta: 0:00:00  lr: 0.000090  bag_loss: 0.2597 (0.7113)  instance_loss: 1.0048 (1.0015)  time: 0.0167  data: 0.0010  max mem: 337
Epoch: [13] Total time: 0:00:04 (4.8503 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.3059 (0.3059)  acc1: 100.0000 (100.0000)  time: 0.6363  data: 0.6265  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2176 (0.4221)  acc1: 100.0000 (90.0000)  time: 0.0077  data: 0.0006  max mem: 337
Val Total time: 0:00:01 (1.0572 s / it)
* Acc@1 90.000 loss 0.422 auroc 0.854 f1_score 0.485
Test  [  0/200]  eta: 0:02:05  loss: 1.1560 (1.1560)  acc1: 0.0000 (0.0000)  time: 0.6270  data: 0.6165  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3096 (0.6416)  acc1: 100.0000 (80.1980)  time: 0.0080  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1407 (0.6102)  acc1: 100.0000 (82.0000)  time: 0.0116  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6107 s / it)
* Acc@1 82.000 loss 0.610 auroc 0.800 f1_score 0.517


Epoch: [14]  [  0/269]  eta: 0:02:54  lr: 0.000090  bag_loss: 0.3454 (0.3454)  instance_loss: 1.1973 (1.1973)  time: 0.6470  data: 0.6287  max mem: 337
Epoch: [14]  [100/269]  eta: 0:00:03  lr: 0.000090  bag_loss: 0.4828 (0.6862)  instance_loss: 0.9315 (0.9859)  time: 0.0137  data: 0.0011  max mem: 337
Epoch: [14]  [200/269]  eta: 0:00:01  lr: 0.000089  bag_loss: 0.2415 (0.7080)  instance_loss: 0.9103 (1.0031)  time: 0.0169  data: 0.0010  max mem: 337
Epoch: [14]  [268/269]  eta: 0:00:00  lr: 0.000088  bag_loss: 0.2305 (0.7108)  instance_loss: 0.9663 (1.0053)  time: 0.0123  data: 0.0009  max mem: 337
Epoch: [14] Total time: 0:00:04 (4.9181 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.1577 (0.1577)  acc1: 100.0000 (100.0000)  time: 0.6099  data: 0.6007  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2409 (0.3912)  acc1: 100.0000 (90.0000)  time: 0.0081  data: 0.0006  max mem: 337
Val Total time: 0:00:01 (1.0275 s / it)
* Acc@1 90.000 loss 0.391 auroc 0.882 f1_score 0.485
Test  [  0/200]  eta: 0:02:02  loss: 1.7295 (1.7295)  acc1: 0.0000 (0.0000)  time: 0.6124  data: 0.5992  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1858 (0.6767)  acc1: 100.0000 (79.2079)  time: 0.0084  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1200 (0.6361)  acc1: 100.0000 (81.5000)  time: 0.0121  data: 0.0014  max mem: 337
Test Total time: 0:00:02 (2.6580 s / it)
* Acc@1 81.500 loss 0.636 auroc 0.803 f1_score 0.493


Epoch: [15]  [  0/269]  eta: 0:02:50  lr: 0.000088  bag_loss: 1.1269 (1.1269)  instance_loss: 1.2281 (1.2281)  time: 0.6345  data: 0.6134  max mem: 337
Epoch: [15]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.2493 (0.6566)  instance_loss: 0.9238 (0.9815)  time: 0.0174  data: 0.0011  max mem: 337
Epoch: [15]  [200/269]  eta: 0:00:01  lr: 0.000087  bag_loss: 0.5197 (0.7405)  instance_loss: 0.9253 (0.9986)  time: 0.0154  data: 0.0010  max mem: 337
Epoch: [15]  [268/269]  eta: 0:00:00  lr: 0.000086  bag_loss: 0.2241 (0.6905)  instance_loss: 0.9322 (0.9834)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [15] Total time: 0:00:04 (4.8869 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.0904 (0.0904)  acc1: 100.0000 (100.0000)  time: 0.6116  data: 0.6023  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2604 (0.3942)  acc1: 100.0000 (90.0000)  time: 0.0089  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.0514 s / it)
* Acc@1 90.000 loss 0.394 auroc 0.869 f1_score 0.485
Test  [  0/200]  eta: 0:02:09  loss: 2.0116 (2.0116)  acc1: 0.0000 (0.0000)  time: 0.6485  data: 0.6375  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2134 (0.6730)  acc1: 100.0000 (78.2178)  time: 0.0082  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1293 (0.6182)  acc1: 100.0000 (81.5000)  time: 0.0114  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.7028 s / it)
* Acc@1 81.500 loss 0.618 auroc 0.809 f1_score 0.471


Epoch: [16]  [  0/269]  eta: 0:02:53  lr: 0.000086  bag_loss: 0.4702 (0.4702)  instance_loss: 0.6232 (0.6232)  time: 0.6442  data: 0.6233  max mem: 337
Epoch: [16]  [100/269]  eta: 0:00:03  lr: 0.000085  bag_loss: 0.3564 (0.6947)  instance_loss: 0.8337 (0.9963)  time: 0.0148  data: 0.0014  max mem: 337
Epoch: [16]  [200/269]  eta: 0:00:01  lr: 0.000084  bag_loss: 0.3107 (0.7137)  instance_loss: 0.9018 (0.9935)  time: 0.0156  data: 0.0010  max mem: 337
Epoch: [16]  [268/269]  eta: 0:00:00  lr: 0.000083  bag_loss: 0.2285 (0.6572)  instance_loss: 0.8194 (0.9705)  time: 0.0141  data: 0.0010  max mem: 337
Epoch: [16] Total time: 0:00:04 (4.7579 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.1145 (0.1145)  acc1: 100.0000 (100.0000)  time: 0.6312  data: 0.6185  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1882 (0.3903)  acc1: 100.0000 (90.0000)  time: 0.0087  data: 0.0006  max mem: 337
Val Total time: 0:00:01 (1.0446 s / it)
* Acc@1 90.000 loss 0.390 auroc 0.879 f1_score 0.485
Test  [  0/200]  eta: 0:02:03  loss: 1.6104 (1.6104)  acc1: 0.0000 (0.0000)  time: 0.6173  data: 0.6090  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2897 (0.6603)  acc1: 100.0000 (79.2079)  time: 0.0079  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1202 (0.6119)  acc1: 100.0000 (82.0000)  time: 0.0115  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6337 s / it)
* Acc@1 82.000 loss 0.612 auroc 0.807 f1_score 0.497


Epoch: [17]  [  0/269]  eta: 0:02:56  lr: 0.000083  bag_loss: 0.0982 (0.0982)  instance_loss: 1.6900 (1.6900)  time: 0.6571  data: 0.6417  max mem: 337
Epoch: [17]  [100/269]  eta: 0:00:03  lr: 0.000082  bag_loss: 0.2667 (0.6765)  instance_loss: 0.8173 (0.9152)  time: 0.0159  data: 0.0012  max mem: 337
Epoch: [17]  [200/269]  eta: 0:00:01  lr: 0.000081  bag_loss: 0.2298 (0.6463)  instance_loss: 0.8467 (0.9318)  time: 0.0178  data: 0.0010  max mem: 337
Epoch: [17]  [268/269]  eta: 0:00:00  lr: 0.000081  bag_loss: 0.1562 (0.6671)  instance_loss: 0.7418 (0.9380)  time: 0.0187  data: 0.0010  max mem: 337
Epoch: [17] Total time: 0:00:04 (4.9474 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.7445 (0.7445)  acc1: 100.0000 (100.0000)  time: 0.6179  data: 0.6084  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1699 (0.4304)  acc1: 100.0000 (86.6667)  time: 0.0089  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0401 s / it)
* Acc@1 86.667 loss 0.430 auroc 0.825 f1_score 0.449
Test  [  0/200]  eta: 0:02:06  loss: 1.0346 (1.0346)  acc1: 0.0000 (0.0000)  time: 0.6327  data: 0.6231  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1974 (0.6723)  acc1: 100.0000 (76.2376)  time: 0.0082  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1036 (0.6905)  acc1: 100.0000 (77.5000)  time: 0.0116  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.6640 s / it)
* Acc@1 77.500 loss 0.691 auroc 0.793 f1_score 0.422


Epoch: [18]  [  0/269]  eta: 0:03:03  lr: 0.000081  bag_loss: 1.3963 (1.3963)  instance_loss: 1.3929 (1.3929)  time: 0.6829  data: 0.6549  max mem: 337
Epoch: [18]  [100/269]  eta: 0:00:03  lr: 0.000080  bag_loss: 0.2221 (0.5908)  instance_loss: 0.9786 (0.9398)  time: 0.0161  data: 0.0014  max mem: 337
Epoch: [18]  [200/269]  eta: 0:00:01  lr: 0.000079  bag_loss: 0.2535 (0.6031)  instance_loss: 0.9007 (0.9458)  time: 0.0131  data: 0.0010  max mem: 337
Epoch: [18]  [268/269]  eta: 0:00:00  lr: 0.000078  bag_loss: 0.5936 (0.6501)  instance_loss: 0.8810 (0.9662)  time: 0.0178  data: 0.0011  max mem: 337
Epoch: [18] Total time: 0:00:04 (4.9500 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.2880 (0.2880)  acc1: 100.0000 (100.0000)  time: 0.6194  data: 0.6117  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4151 (0.4964)  acc1: 100.0000 (83.3333)  time: 0.0099  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0721 s / it)
* Acc@1 83.333 loss 0.496 auroc 0.910 f1_score 0.473
Test  [  0/200]  eta: 0:02:03  loss: 0.9751 (0.9751)  acc1: 0.0000 (0.0000)  time: 0.6157  data: 0.6070  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.7505 (0.7122)  acc1: 100.0000 (74.2574)  time: 0.0083  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1725 (0.6360)  acc1: 100.0000 (79.0000)  time: 0.0115  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6174 s / it)
* Acc@1 79.000 loss 0.636 auroc 0.811 f1_score 0.539


Epoch: [19]  [  0/269]  eta: 0:03:09  lr: 0.000078  bag_loss: 0.4387 (0.4387)  instance_loss: 0.8588 (0.8588)  time: 0.7050  data: 0.6655  max mem: 337
Epoch: [19]  [100/269]  eta: 0:00:03  lr: 0.000077  bag_loss: 0.3036 (0.6338)  instance_loss: 0.9205 (0.9185)  time: 0.0174  data: 0.0010  max mem: 337
Epoch: [19]  [200/269]  eta: 0:00:01  lr: 0.000076  bag_loss: 0.2902 (0.6313)  instance_loss: 0.7919 (0.9035)  time: 0.0142  data: 0.0010  max mem: 337
Epoch: [19]  [268/269]  eta: 0:00:00  lr: 0.000075  bag_loss: 0.1407 (0.6451)  instance_loss: 0.9936 (0.9092)  time: 0.0143  data: 0.0010  max mem: 337
Epoch: [19] Total time: 0:00:05 (5.0199 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.2613 (0.2613)  acc1: 100.0000 (100.0000)  time: 0.6315  data: 0.6165  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1837 (0.4090)  acc1: 100.0000 (90.0000)  time: 0.0092  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.0535 s / it)
* Acc@1 90.000 loss 0.409 auroc 0.856 f1_score 0.485
Test  [  0/200]  eta: 0:02:06  loss: 1.2447 (1.2447)  acc1: 0.0000 (0.0000)  time: 0.6344  data: 0.6258  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2383 (0.6339)  acc1: 100.0000 (81.1881)  time: 0.0081  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1135 (0.6141)  acc1: 100.0000 (82.5000)  time: 0.0114  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6352 s / it)
* Acc@1 82.500 loss 0.614 auroc 0.814 f1_score 0.538


Epoch: [20]  [  0/269]  eta: 0:02:55  lr: 0.000075  bag_loss: 0.0855 (0.0855)  instance_loss: 0.9388 (0.9388)  time: 0.6524  data: 0.6252  max mem: 337
Epoch: [20]  [100/269]  eta: 0:00:03  lr: 0.000074  bag_loss: 0.2200 (0.5319)  instance_loss: 0.8701 (0.9483)  time: 0.0165  data: 0.0011  max mem: 337
Epoch: [20]  [200/269]  eta: 0:00:01  lr: 0.000073  bag_loss: 0.3718 (0.6038)  instance_loss: 0.9197 (0.9151)  time: 0.0170  data: 0.0010  max mem: 337
Epoch: [20]  [268/269]  eta: 0:00:00  lr: 0.000072  bag_loss: 0.1210 (0.5991)  instance_loss: 0.8406 (0.8929)  time: 0.0161  data: 0.0010  max mem: 337
Epoch: [20] Total time: 0:00:04 (4.8445 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.1276 (0.1276)  acc1: 100.0000 (100.0000)  time: 0.6005  data: 0.5885  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1188 (0.3889)  acc1: 100.0000 (90.0000)  time: 0.0097  data: 0.0009  max mem: 337
Val Total time: 0:00:01 (1.0402 s / it)
* Acc@1 90.000 loss 0.389 auroc 0.823 f1_score 0.485
Test  [  0/200]  eta: 0:02:04  loss: 1.7341 (1.7341)  acc1: 0.0000 (0.0000)  time: 0.6214  data: 0.6098  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1820 (0.6492)  acc1: 100.0000 (80.1980)  time: 0.0078  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0783 (0.6198)  acc1: 100.0000 (82.0000)  time: 0.0113  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.6406 s / it)
* Acc@1 82.000 loss 0.620 auroc 0.812 f1_score 0.517


Epoch: [21]  [  0/269]  eta: 0:02:51  lr: 0.000072  bag_loss: 0.9964 (0.9964)  instance_loss: 1.0246 (1.0246)  time: 0.6359  data: 0.6215  max mem: 337
Epoch: [21]  [100/269]  eta: 0:00:03  lr: 0.000071  bag_loss: 0.0884 (0.4894)  instance_loss: 0.7263 (0.8188)  time: 0.0158  data: 0.0011  max mem: 337
Epoch: [21]  [200/269]  eta: 0:00:01  lr: 0.000070  bag_loss: 0.6444 (0.6124)  instance_loss: 0.8808 (0.8658)  time: 0.0167  data: 0.0010  max mem: 337
Epoch: [21]  [268/269]  eta: 0:00:00  lr: 0.000069  bag_loss: 0.1988 (0.6073)  instance_loss: 0.7699 (0.8716)  time: 0.0123  data: 0.0010  max mem: 337
Epoch: [21] Total time: 0:00:04 (4.8963 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.0710 (0.0710)  acc1: 100.0000 (100.0000)  time: 0.6165  data: 0.6060  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.0877 (0.3855)  acc1: 100.0000 (90.0000)  time: 0.0098  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0684 s / it)
* Acc@1 90.000 loss 0.385 auroc 0.856 f1_score 0.485
Test  [  0/200]  eta: 0:02:04  loss: 2.6287 (2.6287)  acc1: 0.0000 (0.0000)  time: 0.6216  data: 0.6143  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.0876 (0.6859)  acc1: 100.0000 (80.1980)  time: 0.0079  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0684 (0.6495)  acc1: 100.0000 (82.5000)  time: 0.0115  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6359 s / it)
* Acc@1 82.500 loss 0.650 auroc 0.814 f1_score 0.519


Epoch: [22]  [  0/269]  eta: 0:02:58  lr: 0.000069  bag_loss: 0.0169 (0.0169)  instance_loss: 1.5773 (1.5773)  time: 0.6642  data: 0.6391  max mem: 337
Epoch: [22]  [100/269]  eta: 0:00:03  lr: 0.000068  bag_loss: 0.6250 (0.6662)  instance_loss: 0.9789 (0.9287)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [22]  [200/269]  eta: 0:00:01  lr: 0.000066  bag_loss: 0.1360 (0.5496)  instance_loss: 0.7836 (0.9009)  time: 0.0131  data: 0.0010  max mem: 337
Epoch: [22]  [268/269]  eta: 0:00:00  lr: 0.000065  bag_loss: 0.2289 (0.5943)  instance_loss: 0.8022 (0.9048)  time: 0.0168  data: 0.0010  max mem: 337
Epoch: [22] Total time: 0:00:04 (4.8286 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.1315 (0.1315)  acc1: 100.0000 (100.0000)  time: 0.6231  data: 0.6068  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1689 (0.4155)  acc1: 100.0000 (86.6667)  time: 0.0088  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0421 s / it)
* Acc@1 86.667 loss 0.415 auroc 0.841 f1_score 0.479
Test  [  0/200]  eta: 0:02:08  loss: 1.5673 (1.5673)  acc1: 0.0000 (0.0000)  time: 0.6410  data: 0.6329  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2937 (0.6249)  acc1: 100.0000 (81.1881)  time: 0.0079  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1151 (0.5893)  acc1: 100.0000 (83.0000)  time: 0.0118  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.6619 s / it)
* Acc@1 83.000 loss 0.589 auroc 0.823 f1_score 0.541


Epoch: [23]  [  0/269]  eta: 0:02:54  lr: 0.000065  bag_loss: 1.5183 (1.5183)  instance_loss: 1.3802 (1.3802)  time: 0.6484  data: 0.6291  max mem: 337
Epoch: [23]  [100/269]  eta: 0:00:03  lr: 0.000064  bag_loss: 0.0739 (0.5484)  instance_loss: 0.7405 (0.8884)  time: 0.0147  data: 0.0010  max mem: 337
Epoch: [23]  [200/269]  eta: 0:00:01  lr: 0.000063  bag_loss: 0.2791 (0.5856)  instance_loss: 0.7843 (0.8676)  time: 0.0160  data: 0.0011  max mem: 337
Epoch: [23]  [268/269]  eta: 0:00:00  lr: 0.000062  bag_loss: 0.2818 (0.5925)  instance_loss: 0.9052 (0.8663)  time: 0.0147  data: 0.0010  max mem: 337
Epoch: [23] Total time: 0:00:04 (4.9225 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.2090 (0.2090)  acc1: 100.0000 (100.0000)  time: 0.6367  data: 0.6215  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4095 (0.5476)  acc1: 100.0000 (80.0000)  time: 0.0098  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.0914 s / it)
* Acc@1 80.000 loss 0.548 auroc 0.890 f1_score 0.467
Test  [  0/200]  eta: 0:02:01  loss: 1.7324 (1.7324)  acc1: 0.0000 (0.0000)  time: 0.6074  data: 0.5992  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.6139 (0.7374)  acc1: 100.0000 (74.2574)  time: 0.0082  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1712 (0.6630)  acc1: 100.0000 (79.5000)  time: 0.0112  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6203 s / it)
* Acc@1 79.500 loss 0.663 auroc 0.812 f1_score 0.533


Epoch: [24]  [  0/269]  eta: 0:02:55  lr: 0.000062  bag_loss: 0.8379 (0.8379)  instance_loss: 1.3131 (1.3131)  time: 0.6529  data: 0.6350  max mem: 337
Epoch: [24]  [100/269]  eta: 0:00:03  lr: 0.000061  bag_loss: 0.3467 (0.5989)  instance_loss: 0.8425 (0.9020)  time: 0.0175  data: 0.0010  max mem: 337
Epoch: [24]  [200/269]  eta: 0:00:01  lr: 0.000060  bag_loss: 0.2697 (0.5684)  instance_loss: 0.7733 (0.8603)  time: 0.0131  data: 0.0009  max mem: 337
Epoch: [24]  [268/269]  eta: 0:00:00  lr: 0.000059  bag_loss: 0.2586 (0.5782)  instance_loss: 0.8517 (0.8705)  time: 0.0151  data: 0.0010  max mem: 337
Epoch: [24] Total time: 0:00:04 (4.8695 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.0887 (0.0887)  acc1: 100.0000 (100.0000)  time: 0.6263  data: 0.6097  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2629 (0.4474)  acc1: 100.0000 (86.6667)  time: 0.0096  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0851 s / it)
* Acc@1 86.667 loss 0.447 auroc 0.879 f1_score 0.479
Test  [  0/200]  eta: 0:02:03  loss: 2.0251 (2.0251)  acc1: 0.0000 (0.0000)  time: 0.6173  data: 0.6083  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4354 (0.6749)  acc1: 100.0000 (78.2178)  time: 0.0083  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1064 (0.6029)  acc1: 100.0000 (81.0000)  time: 0.0110  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.6584 s / it)
* Acc@1 81.000 loss 0.603 auroc 0.815 f1_score 0.552


Epoch: [25]  [  0/269]  eta: 0:02:58  lr: 0.000059  bag_loss: 0.2271 (0.2271)  instance_loss: 0.6189 (0.6189)  time: 0.6630  data: 0.6505  max mem: 337
Epoch: [25]  [100/269]  eta: 0:00:03  lr: 0.000057  bag_loss: 0.2062 (0.5254)  instance_loss: 0.8336 (0.8296)  time: 0.0168  data: 0.0016  max mem: 337
Epoch: [25]  [200/269]  eta: 0:00:01  lr: 0.000056  bag_loss: 0.4905 (0.5817)  instance_loss: 0.8145 (0.8635)  time: 0.0160  data: 0.0010  max mem: 337
Epoch: [25]  [268/269]  eta: 0:00:00  lr: 0.000055  bag_loss: 0.3478 (0.5622)  instance_loss: 0.6789 (0.8547)  time: 0.0154  data: 0.0013  max mem: 337
Epoch: [25] Total time: 0:00:04 (4.8843 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.7129 (0.7129)  acc1: 100.0000 (100.0000)  time: 0.6271  data: 0.6188  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2866 (0.4774)  acc1: 100.0000 (83.3333)  time: 0.0091  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0595 s / it)
* Acc@1 83.333 loss 0.477 auroc 0.816 f1_score 0.473
Test  [  0/200]  eta: 0:02:06  loss: 0.5705 (0.5705)  acc1: 100.0000 (100.0000)  time: 0.6335  data: 0.6254  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.6013 (0.6944)  acc1: 100.0000 (68.3168)  time: 0.0088  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1176 (0.6154)  acc1: 100.0000 (76.0000)  time: 0.0124  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.7543 s / it)
* Acc@1 76.000 loss 0.615 auroc 0.821 f1_score 0.543


Epoch: [26]  [  0/269]  eta: 0:03:01  lr: 0.000055  bag_loss: 0.2127 (0.2127)  instance_loss: 0.7642 (0.7642)  time: 0.6749  data: 0.6520  max mem: 337
Epoch: [26]  [100/269]  eta: 0:00:03  lr: 0.000054  bag_loss: 0.1486 (0.5132)  instance_loss: 0.6364 (0.7879)  time: 0.0170  data: 0.0019  max mem: 337
Epoch: [26]  [200/269]  eta: 0:00:01  lr: 0.000053  bag_loss: 0.3952 (0.5430)  instance_loss: 0.8207 (0.8320)  time: 0.0123  data: 0.0010  max mem: 337
Epoch: [26]  [268/269]  eta: 0:00:00  lr: 0.000052  bag_loss: 0.3059 (0.5673)  instance_loss: 0.8779 (0.8420)  time: 0.0138  data: 0.0011  max mem: 337
Epoch: [26] Total time: 0:00:04 (4.9684 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.4465 (0.4465)  acc1: 100.0000 (100.0000)  time: 0.6411  data: 0.6285  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3639 (0.5166)  acc1: 100.0000 (80.0000)  time: 0.0094  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.1035 s / it)
* Acc@1 80.000 loss 0.517 auroc 0.841 f1_score 0.467
Test  [  0/200]  eta: 0:02:05  loss: 0.7741 (0.7741)  acc1: 0.0000 (0.0000)  time: 0.6266  data: 0.6177  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5986 (0.6770)  acc1: 100.0000 (73.2673)  time: 0.0085  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1402 (0.6047)  acc1: 100.0000 (78.5000)  time: 0.0116  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6812 s / it)
* Acc@1 78.500 loss 0.605 auroc 0.827 f1_score 0.558


Epoch: [27]  [  0/269]  eta: 0:02:58  lr: 0.000052  bag_loss: 0.6749 (0.6749)  instance_loss: 0.6743 (0.6743)  time: 0.6623  data: 0.6359  max mem: 337
Epoch: [27]  [100/269]  eta: 0:00:03  lr: 0.000050  bag_loss: 0.1686 (0.5406)  instance_loss: 0.7997 (0.8494)  time: 0.0173  data: 0.0015  max mem: 337
Epoch: [27]  [200/269]  eta: 0:00:01  lr: 0.000049  bag_loss: 0.3423 (0.5588)  instance_loss: 0.7169 (0.8293)  time: 0.0155  data: 0.0011  max mem: 337
Epoch: [27]  [268/269]  eta: 0:00:00  lr: 0.000048  bag_loss: 0.3108 (0.5635)  instance_loss: 0.6996 (0.8356)  time: 0.0160  data: 0.0013  max mem: 337
Epoch: [27] Total time: 0:00:05 (5.0499 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.6094 (0.6094)  acc1: 100.0000 (100.0000)  time: 0.6219  data: 0.6130  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2362 (0.4855)  acc1: 100.0000 (80.0000)  time: 0.0098  data: 0.0009  max mem: 337
Val Total time: 0:00:01 (1.0790 s / it)
* Acc@1 80.000 loss 0.486 auroc 0.829 f1_score 0.467
Test  [  0/200]  eta: 0:02:00  loss: 0.4577 (0.4577)  acc1: 100.0000 (100.0000)  time: 0.6016  data: 0.5924  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4129 (0.6251)  acc1: 100.0000 (80.1980)  time: 0.0082  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1481 (0.5825)  acc1: 100.0000 (82.0000)  time: 0.0114  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.6093 s / it)
* Acc@1 82.000 loss 0.582 auroc 0.830 f1_score 0.556


Epoch: [28]  [  0/269]  eta: 0:02:56  lr: 0.000048  bag_loss: 0.0631 (0.0631)  instance_loss: 0.6755 (0.6755)  time: 0.6569  data: 0.6432  max mem: 337
Epoch: [28]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.3166 (0.5748)  instance_loss: 0.7480 (0.7953)  time: 0.0177  data: 0.0014  max mem: 337
Epoch: [28]  [200/269]  eta: 0:00:01  lr: 0.000046  bag_loss: 0.1667 (0.4977)  instance_loss: 0.8179 (0.8084)  time: 0.0122  data: 0.0010  max mem: 337
Epoch: [28]  [268/269]  eta: 0:00:00  lr: 0.000045  bag_loss: 0.4334 (0.5406)  instance_loss: 0.8855 (0.8239)  time: 0.0135  data: 0.0010  max mem: 337
Epoch: [28] Total time: 0:00:04 (4.8616 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 2.0030 (2.0030)  acc1: 0.0000 (0.0000)  time: 0.6435  data: 0.6351  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3618 (0.5910)  acc1: 100.0000 (70.0000)  time: 0.0100  data: 0.0011  max mem: 337
Val Total time: 0:00:01 (1.1062 s / it)
* Acc@1 70.000 loss 0.591 auroc 0.841 f1_score 0.317
Test  [  0/200]  eta: 0:02:05  loss: 0.2204 (0.2204)  acc1: 100.0000 (100.0000)  time: 0.6269  data: 0.6147  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.6583 (0.6982)  acc1: 100.0000 (70.2970)  time: 0.0085  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1436 (0.6324)  acc1: 100.0000 (77.0000)  time: 0.0119  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.6888 s / it)
* Acc@1 77.000 loss 0.632 auroc 0.816 f1_score 0.557


Epoch: [29]  [  0/269]  eta: 0:03:00  lr: 0.000045  bag_loss: 0.2205 (0.2205)  instance_loss: 0.6013 (0.6013)  time: 0.6714  data: 0.6525  max mem: 337
Epoch: [29]  [100/269]  eta: 0:00:03  lr: 0.000043  bag_loss: 0.1050 (0.4401)  instance_loss: 0.7698 (0.8091)  time: 0.0158  data: 0.0010  max mem: 337
Epoch: [29]  [200/269]  eta: 0:00:01  lr: 0.000042  bag_loss: 0.2463 (0.5396)  instance_loss: 1.0429 (0.8339)  time: 0.0162  data: 0.0010  max mem: 337
Epoch: [29]  [268/269]  eta: 0:00:00  lr: 0.000041  bag_loss: 0.2454 (0.5377)  instance_loss: 0.7221 (0.8261)  time: 0.0191  data: 0.0015  max mem: 337
Epoch: [29] Total time: 0:00:04 (4.9423 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.2544 (0.2544)  acc1: 100.0000 (100.0000)  time: 0.6147  data: 0.6051  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1560 (0.4372)  acc1: 100.0000 (86.6667)  time: 0.0092  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0516 s / it)
* Acc@1 86.667 loss 0.437 auroc 0.829 f1_score 0.479
Test  [  0/200]  eta: 0:01:58  loss: 1.3689 (1.3689)  acc1: 0.0000 (0.0000)  time: 0.5910  data: 0.5855  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2379 (0.6176)  acc1: 100.0000 (80.1980)  time: 0.0085  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1055 (0.5808)  acc1: 100.0000 (82.0000)  time: 0.0121  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.5852 s / it)
* Acc@1 82.000 loss 0.581 auroc 0.829 f1_score 0.537


Epoch: [30]  [  0/269]  eta: 0:03:03  lr: 0.000041  bag_loss: 0.1320 (0.1320)  instance_loss: 0.7383 (0.7383)  time: 0.6819  data: 0.6474  max mem: 337
Epoch: [30]  [100/269]  eta: 0:00:03  lr: 0.000040  bag_loss: 0.0996 (0.5499)  instance_loss: 0.7988 (0.8253)  time: 0.0174  data: 0.0010  max mem: 337
Epoch: [30]  [200/269]  eta: 0:00:01  lr: 0.000039  bag_loss: 0.1349 (0.5358)  instance_loss: 0.7071 (0.8338)  time: 0.0129  data: 0.0010  max mem: 337
Epoch: [30]  [268/269]  eta: 0:00:00  lr: 0.000038  bag_loss: 0.1635 (0.5156)  instance_loss: 0.7019 (0.8133)  time: 0.0124  data: 0.0015  max mem: 337
Epoch: [30] Total time: 0:00:04 (4.7494 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.4979 (0.4979)  acc1: 100.0000 (100.0000)  time: 0.6233  data: 0.6140  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1070 (0.4223)  acc1: 100.0000 (86.6667)  time: 0.0092  data: 0.0011  max mem: 337
Val Total time: 0:00:01 (1.0936 s / it)
* Acc@1 86.667 loss 0.422 auroc 0.847 f1_score 0.479
Test  [  0/200]  eta: 0:02:02  loss: 1.0161 (1.0161)  acc1: 0.0000 (0.0000)  time: 0.6139  data: 0.6049  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1932 (0.6220)  acc1: 100.0000 (81.1881)  time: 0.0085  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0763 (0.5947)  acc1: 100.0000 (82.5000)  time: 0.0118  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6568 s / it)
* Acc@1 82.500 loss 0.595 auroc 0.824 f1_score 0.538


Epoch: [31]  [  0/269]  eta: 0:03:00  lr: 0.000038  bag_loss: 0.0500 (0.0500)  instance_loss: 0.4839 (0.4839)  time: 0.6715  data: 0.6415  max mem: 337
Epoch: [31]  [100/269]  eta: 0:00:03  lr: 0.000037  bag_loss: 0.2047 (0.5068)  instance_loss: 0.7017 (0.8237)  time: 0.0137  data: 0.0010  max mem: 337
Epoch: [31]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.2392 (0.5308)  instance_loss: 0.6691 (0.8104)  time: 0.0138  data: 0.0011  max mem: 337
Epoch: [31]  [268/269]  eta: 0:00:00  lr: 0.000035  bag_loss: 0.2424 (0.5315)  instance_loss: 0.7795 (0.8183)  time: 0.0166  data: 0.0011  max mem: 337
Epoch: [31] Total time: 0:00:04 (4.9417 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.3171 (0.3171)  acc1: 100.0000 (100.0000)  time: 0.6234  data: 0.6131  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1882 (0.4591)  acc1: 100.0000 (86.6667)  time: 0.0100  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0725 s / it)
* Acc@1 86.667 loss 0.459 auroc 0.813 f1_score 0.479
Test  [  0/200]  eta: 0:02:08  loss: 1.2290 (1.2290)  acc1: 0.0000 (0.0000)  time: 0.6437  data: 0.6358  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3106 (0.6420)  acc1: 100.0000 (77.2277)  time: 0.0084  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1122 (0.5878)  acc1: 100.0000 (80.5000)  time: 0.0115  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6822 s / it)
* Acc@1 80.500 loss 0.588 auroc 0.829 f1_score 0.533


Epoch: [32]  [  0/269]  eta: 0:03:01  lr: 0.000035  bag_loss: 0.0180 (0.0180)  instance_loss: 0.7737 (0.7737)  time: 0.6741  data: 0.6498  max mem: 337
Epoch: [32]  [100/269]  eta: 0:00:03  lr: 0.000033  bag_loss: 0.3347 (0.5567)  instance_loss: 0.8537 (0.8447)  time: 0.0149  data: 0.0010  max mem: 337
Epoch: [32]  [200/269]  eta: 0:00:01  lr: 0.000032  bag_loss: 0.0550 (0.4503)  instance_loss: 0.7184 (0.8215)  time: 0.0152  data: 0.0014  max mem: 337
Epoch: [32]  [268/269]  eta: 0:00:00  lr: 0.000031  bag_loss: 0.2060 (0.4929)  instance_loss: 0.6894 (0.8164)  time: 0.0179  data: 0.0015  max mem: 337
Epoch: [32] Total time: 0:00:05 (5.0008 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.8154 (0.8154)  acc1: 0.0000 (0.0000)  time: 0.6241  data: 0.6094  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3106 (0.5368)  acc1: 100.0000 (76.6667)  time: 0.0088  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0740 s / it)
* Acc@1 76.667 loss 0.537 auroc 0.829 f1_score 0.432
Test  [  0/200]  eta: 0:02:03  loss: 0.5975 (0.5975)  acc1: 100.0000 (100.0000)  time: 0.6196  data: 0.6101  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5919 (0.6798)  acc1: 100.0000 (70.2970)  time: 0.0088  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1317 (0.6067)  acc1: 100.0000 (77.0000)  time: 0.0112  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.7162 s / it)
* Acc@1 77.000 loss 0.607 auroc 0.827 f1_score 0.547


Epoch: [33]  [  0/269]  eta: 0:02:59  lr: 0.000031  bag_loss: 0.2923 (0.2923)  instance_loss: 0.7554 (0.7554)  time: 0.6673  data: 0.6531  max mem: 337
Epoch: [33]  [100/269]  eta: 0:00:03  lr: 0.000030  bag_loss: 0.1067 (0.5137)  instance_loss: 0.7933 (0.8597)  time: 0.0131  data: 0.0009  max mem: 337
Epoch: [33]  [200/269]  eta: 0:00:01  lr: 0.000029  bag_loss: 0.3190 (0.5463)  instance_loss: 0.7606 (0.8390)  time: 0.0162  data: 0.0013  max mem: 337
Epoch: [33]  [268/269]  eta: 0:00:00  lr: 0.000028  bag_loss: 0.1081 (0.5086)  instance_loss: 0.7801 (0.8455)  time: 0.0179  data: 0.0010  max mem: 337
Epoch: [33] Total time: 0:00:04 (4.9573 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.2633 (0.2633)  acc1: 100.0000 (100.0000)  time: 0.6193  data: 0.6110  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1306 (0.4412)  acc1: 100.0000 (83.3333)  time: 0.0089  data: 0.0007  max mem: 337
Val Total time: 0:00:03 (3.2550 s / it)
* Acc@1 83.333 loss 0.441 auroc 0.833 f1_score 0.473
Test  [  0/200]  eta: 0:02:03  loss: 1.7583 (1.7583)  acc1: 0.0000 (0.0000)  time: 0.6180  data: 0.6099  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2228 (0.6238)  acc1: 100.0000 (81.1881)  time: 0.0085  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0815 (0.5796)  acc1: 100.0000 (82.5000)  time: 0.0123  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.6500 s / it)
* Acc@1 82.500 loss 0.580 auroc 0.829 f1_score 0.538


Epoch: [34]  [  0/269]  eta: 0:03:03  lr: 0.000028  bag_loss: 0.2169 (0.2169)  instance_loss: 0.7015 (0.7015)  time: 0.6807  data: 0.6645  max mem: 337
Epoch: [34]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.2964 (0.5483)  instance_loss: 0.8044 (0.8235)  time: 0.0144  data: 0.0010  max mem: 337
Epoch: [34]  [200/269]  eta: 0:00:01  lr: 0.000026  bag_loss: 0.2245 (0.5059)  instance_loss: 0.6732 (0.8180)  time: 0.0182  data: 0.0010  max mem: 337
Epoch: [34]  [268/269]  eta: 0:00:00  lr: 0.000025  bag_loss: 0.3257 (0.5279)  instance_loss: 0.6959 (0.8097)  time: 0.0158  data: 0.0011  max mem: 337
Epoch: [34] Total time: 0:00:04 (4.9691 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.2675 (0.2675)  acc1: 100.0000 (100.0000)  time: 0.6054  data: 0.5933  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1645 (0.4658)  acc1: 100.0000 (83.3333)  time: 0.0088  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0342 s / it)
* Acc@1 83.333 loss 0.466 auroc 0.820 f1_score 0.473
Test  [  0/200]  eta: 0:02:04  loss: 1.2429 (1.2429)  acc1: 0.0000 (0.0000)  time: 0.6243  data: 0.6160  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3041 (0.6328)  acc1: 100.0000 (78.2178)  time: 0.0070  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0934 (0.5831)  acc1: 100.0000 (81.0000)  time: 0.0122  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.7008 s / it)
* Acc@1 81.000 loss 0.583 auroc 0.829 f1_score 0.534


Epoch: [35]  [  0/269]  eta: 0:03:04  lr: 0.000025  bag_loss: 0.1074 (0.1074)  instance_loss: 0.7780 (0.7780)  time: 0.6864  data: 0.6662  max mem: 337
Epoch: [35]  [100/269]  eta: 0:00:03  lr: 0.000024  bag_loss: 0.1528 (0.3586)  instance_loss: 0.6752 (0.7999)  time: 0.0147  data: 0.0010  max mem: 337
Epoch: [35]  [200/269]  eta: 0:00:01  lr: 0.000023  bag_loss: 0.1493 (0.4852)  instance_loss: 0.8667 (0.8241)  time: 0.0151  data: 0.0010  max mem: 337
Epoch: [35]  [268/269]  eta: 0:00:00  lr: 0.000022  bag_loss: 0.1353 (0.4842)  instance_loss: 0.7155 (0.8065)  time: 0.0137  data: 0.0011  max mem: 337
Epoch: [35] Total time: 0:00:04 (4.9196 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.5225 (0.5225)  acc1: 100.0000 (100.0000)  time: 0.6290  data: 0.6201  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1359 (0.4624)  acc1: 100.0000 (83.3333)  time: 0.0087  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.0766 s / it)
* Acc@1 83.333 loss 0.462 auroc 0.816 f1_score 0.473
Test  [  0/200]  eta: 0:02:04  loss: 0.7463 (0.7463)  acc1: 100.0000 (100.0000)  time: 0.6207  data: 0.6122  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2652 (0.6219)  acc1: 100.0000 (81.1881)  time: 0.0074  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0845 (0.5873)  acc1: 100.0000 (82.5000)  time: 0.0118  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.6582 s / it)
* Acc@1 82.500 loss 0.587 auroc 0.822 f1_score 0.557


Epoch: [36]  [  0/269]  eta: 0:03:10  lr: 0.000022  bag_loss: 0.0434 (0.0434)  instance_loss: 0.5299 (0.5299)  time: 0.7092  data: 0.6714  max mem: 337
Epoch: [36]  [100/269]  eta: 0:00:03  lr: 0.000021  bag_loss: 0.2855 (0.5176)  instance_loss: 0.7462 (0.8235)  time: 0.0129  data: 0.0010  max mem: 337
Epoch: [36]  [200/269]  eta: 0:00:01  lr: 0.000020  bag_loss: 0.3734 (0.4924)  instance_loss: 0.7444 (0.8028)  time: 0.0171  data: 0.0011  max mem: 337
Epoch: [36]  [268/269]  eta: 0:00:00  lr: 0.000019  bag_loss: 0.1359 (0.4931)  instance_loss: 0.6594 (0.8006)  time: 0.0167  data: 0.0011  max mem: 337
Epoch: [36] Total time: 0:00:04 (4.9198 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.5886 (0.5886)  acc1: 100.0000 (100.0000)  time: 0.6201  data: 0.6101  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1901 (0.4948)  acc1: 100.0000 (80.0000)  time: 0.0086  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.0464 s / it)
* Acc@1 80.000 loss 0.495 auroc 0.820 f1_score 0.467
Test  [  0/200]  eta: 0:02:07  loss: 0.7094 (0.7094)  acc1: 100.0000 (100.0000)  time: 0.6385  data: 0.6260  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3735 (0.6329)  acc1: 100.0000 (80.1980)  time: 0.0088  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1129 (0.5854)  acc1: 100.0000 (82.0000)  time: 0.0120  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.7743 s / it)
* Acc@1 82.000 loss 0.585 auroc 0.825 f1_score 0.556


Epoch: [37]  [  0/269]  eta: 0:02:57  lr: 0.000019  bag_loss: 0.2953 (0.2953)  instance_loss: 0.7572 (0.7572)  time: 0.6590  data: 0.6402  max mem: 337
Epoch: [37]  [100/269]  eta: 0:00:03  lr: 0.000018  bag_loss: 0.3547 (0.4429)  instance_loss: 0.7362 (0.7550)  time: 0.0161  data: 0.0012  max mem: 337
Epoch: [37]  [200/269]  eta: 0:00:01  lr: 0.000017  bag_loss: 0.2074 (0.4591)  instance_loss: 0.6919 (0.7968)  time: 0.0143  data: 0.0010  max mem: 337
Epoch: [37]  [268/269]  eta: 0:00:00  lr: 0.000017  bag_loss: 0.1432 (0.4733)  instance_loss: 0.7268 (0.7930)  time: 0.0140  data: 0.0010  max mem: 337
Epoch: [37] Total time: 0:00:05 (5.0104 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.4391 (0.4391)  acc1: 100.0000 (100.0000)  time: 0.6218  data: 0.6080  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1921 (0.4991)  acc1: 100.0000 (83.3333)  time: 0.0091  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.0550 s / it)
* Acc@1 83.333 loss 0.499 auroc 0.814 f1_score 0.473
Test  [  0/200]  eta: 0:02:04  loss: 0.7579 (0.7579)  acc1: 100.0000 (100.0000)  time: 0.6227  data: 0.6138  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3710 (0.6550)  acc1: 100.0000 (75.2475)  time: 0.0089  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1003 (0.5975)  acc1: 100.0000 (79.5000)  time: 0.0124  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.7580 s / it)
* Acc@1 79.500 loss 0.597 auroc 0.823 f1_score 0.550


Epoch: [38]  [  0/269]  eta: 0:03:00  lr: 0.000017  bag_loss: 0.0288 (0.0288)  instance_loss: 0.5970 (0.5970)  time: 0.6695  data: 0.6408  max mem: 337
Epoch: [38]  [100/269]  eta: 0:00:04  lr: 0.000016  bag_loss: 0.4235 (0.5064)  instance_loss: 0.6751 (0.7982)  time: 0.0180  data: 0.0010  max mem: 337
Epoch: [38]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.2544 (0.5079)  instance_loss: 0.6777 (0.8050)  time: 0.0148  data: 0.0011  max mem: 337
Epoch: [38]  [268/269]  eta: 0:00:00  lr: 0.000014  bag_loss: 0.2147 (0.4826)  instance_loss: 0.6993 (0.7924)  time: 0.0176  data: 0.0013  max mem: 337
Epoch: [38] Total time: 0:00:05 (5.0714 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.2916 (0.2916)  acc1: 100.0000 (100.0000)  time: 0.6289  data: 0.6174  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1494 (0.4716)  acc1: 100.0000 (83.3333)  time: 0.0098  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.0933 s / it)
* Acc@1 83.333 loss 0.472 auroc 0.819 f1_score 0.473
Test  [  0/200]  eta: 0:02:08  loss: 1.3174 (1.3174)  acc1: 0.0000 (0.0000)  time: 0.6432  data: 0.6268  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2699 (0.6288)  acc1: 100.0000 (79.2079)  time: 0.0093  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0880 (0.5808)  acc1: 100.0000 (81.5000)  time: 0.0125  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.8111 s / it)
* Acc@1 81.500 loss 0.581 auroc 0.827 f1_score 0.536


Epoch: [39]  [  0/269]  eta: 0:02:57  lr: 0.000014  bag_loss: 0.4611 (0.4611)  instance_loss: 0.4676 (0.4676)  time: 0.6616  data: 0.6467  max mem: 337
Epoch: [39]  [100/269]  eta: 0:00:03  lr: 0.000013  bag_loss: 0.1492 (0.4340)  instance_loss: 0.6581 (0.7427)  time: 0.0151  data: 0.0013  max mem: 337
Epoch: [39]  [200/269]  eta: 0:00:01  lr: 0.000012  bag_loss: 0.2937 (0.4355)  instance_loss: 0.8707 (0.7834)  time: 0.0141  data: 0.0010  max mem: 337
Epoch: [39]  [268/269]  eta: 0:00:00  lr: 0.000012  bag_loss: 0.3170 (0.4535)  instance_loss: 0.7195 (0.7909)  time: 0.0162  data: 0.0013  max mem: 337
Epoch: [39] Total time: 0:00:05 (5.0765 s / it)
Val  [ 0/30]  eta: 0:00:20  loss: 0.3528 (0.3528)  acc1: 100.0000 (100.0000)  time: 0.6693  data: 0.6603  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2168 (0.5063)  acc1: 100.0000 (80.0000)  time: 0.0094  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.1258 s / it)
* Acc@1 80.000 loss 0.506 auroc 0.816 f1_score 0.467
Test  [  0/200]  eta: 0:02:05  loss: 1.1598 (1.1598)  acc1: 0.0000 (0.0000)  time: 0.6286  data: 0.6206  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4117 (0.6531)  acc1: 100.0000 (74.2574)  time: 0.0091  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0965 (0.5908)  acc1: 100.0000 (79.0000)  time: 0.0117  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.7634 s / it)
* Acc@1 79.000 loss 0.591 auroc 0.828 f1_score 0.530


Epoch: [40]  [  0/269]  eta: 0:02:56  lr: 0.000012  bag_loss: 0.6378 (0.6378)  instance_loss: 0.6803 (0.6803)  time: 0.6577  data: 0.6382  max mem: 337
Epoch: [40]  [100/269]  eta: 0:00:03  lr: 0.000011  bag_loss: 0.1088 (0.5149)  instance_loss: 0.6835 (0.7648)  time: 0.0161  data: 0.0011  max mem: 337
Epoch: [40]  [200/269]  eta: 0:00:01  lr: 0.000010  bag_loss: 0.1286 (0.4671)  instance_loss: 0.7900 (0.7960)  time: 0.0184  data: 0.0011  max mem: 337
Epoch: [40]  [268/269]  eta: 0:00:00  lr: 0.000010  bag_loss: 0.2388 (0.4666)  instance_loss: 0.6651 (0.7998)  time: 0.0122  data: 0.0013  max mem: 337
Epoch: [40] Total time: 0:00:04 (4.9478 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.3969 (0.3969)  acc1: 100.0000 (100.0000)  time: 0.6454  data: 0.6371  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1707 (0.4881)  acc1: 100.0000 (80.0000)  time: 0.0083  data: 0.0006  max mem: 337
Val Total time: 0:00:01 (1.0946 s / it)
* Acc@1 80.000 loss 0.488 auroc 0.822 f1_score 0.467
Test  [  0/200]  eta: 0:02:43  loss: 1.1620 (1.1620)  acc1: 0.0000 (0.0000)  time: 0.8175  data: 0.8045  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3202 (0.6336)  acc1: 100.0000 (78.2178)  time: 0.0081  data: 0.0008  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1008 (0.5839)  acc1: 100.0000 (81.0000)  time: 0.0116  data: 0.0012  max mem: 337
Test Total time: 0:00:03 (3.1239 s / it)
* Acc@1 81.000 loss 0.584 auroc 0.827 f1_score 0.534


Epoch: [41]  [  0/269]  eta: 0:02:59  lr: 0.000010  bag_loss: 0.2263 (0.2263)  instance_loss: 0.7578 (0.7578)  time: 0.6684  data: 0.6538  max mem: 337
Epoch: [41]  [100/269]  eta: 0:00:03  lr: 0.000009  bag_loss: 0.1208 (0.4627)  instance_loss: 0.7665 (0.7799)  time: 0.0137  data: 0.0010  max mem: 337
Epoch: [41]  [200/269]  eta: 0:00:01  lr: 0.000008  bag_loss: 0.1251 (0.4595)  instance_loss: 0.7527 (0.7892)  time: 0.0174  data: 0.0011  max mem: 337
Epoch: [41]  [268/269]  eta: 0:00:00  lr: 0.000008  bag_loss: 0.1553 (0.4549)  instance_loss: 0.6215 (0.7880)  time: 0.0171  data: 0.0011  max mem: 337
Epoch: [41] Total time: 0:00:04 (4.9643 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.2477 (0.2477)  acc1: 100.0000 (100.0000)  time: 0.6197  data: 0.6110  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1664 (0.4735)  acc1: 100.0000 (83.3333)  time: 0.0096  data: 0.0009  max mem: 337
Val Total time: 0:00:01 (1.0680 s / it)
* Acc@1 83.333 loss 0.474 auroc 0.823 f1_score 0.473
Test  [  0/200]  eta: 0:02:03  loss: 1.7600 (1.7600)  acc1: 0.0000 (0.0000)  time: 0.6197  data: 0.6106  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2921 (0.6408)  acc1: 100.0000 (78.2178)  time: 0.0083  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0760 (0.5848)  acc1: 100.0000 (81.0000)  time: 0.0128  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.7126 s / it)
* Acc@1 81.000 loss 0.585 auroc 0.827 f1_score 0.534


Epoch: [42]  [  0/269]  eta: 0:03:08  lr: 0.000008  bag_loss: 0.3342 (0.3342)  instance_loss: 0.5603 (0.5603)  time: 0.7025  data: 0.6817  max mem: 337
Epoch: [42]  [100/269]  eta: 0:00:04  lr: 0.000007  bag_loss: 0.1221 (0.4486)  instance_loss: 0.7417 (0.8089)  time: 0.0154  data: 0.0011  max mem: 337
Epoch: [42]  [200/269]  eta: 0:00:01  lr: 0.000006  bag_loss: 0.2683 (0.4826)  instance_loss: 0.7740 (0.8067)  time: 0.0182  data: 0.0012  max mem: 337
Epoch: [42]  [268/269]  eta: 0:00:00  lr: 0.000006  bag_loss: 0.1940 (0.4765)  instance_loss: 0.6464 (0.7883)  time: 0.0118  data: 0.0010  max mem: 337
Epoch: [42] Total time: 0:00:05 (5.0836 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.3447 (0.3447)  acc1: 100.0000 (100.0000)  time: 0.6499  data: 0.6408  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1797 (0.4883)  acc1: 100.0000 (80.0000)  time: 0.0100  data: 0.0009  max mem: 337
Val Total time: 0:00:01 (1.1277 s / it)
* Acc@1 80.000 loss 0.488 auroc 0.823 f1_score 0.467
Test  [  0/200]  eta: 0:02:09  loss: 1.3592 (1.3592)  acc1: 0.0000 (0.0000)  time: 0.6480  data: 0.6360  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3447 (0.6456)  acc1: 100.0000 (78.2178)  time: 0.0073  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0898 (0.5886)  acc1: 100.0000 (81.0000)  time: 0.0121  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6864 s / it)
* Acc@1 81.000 loss 0.589 auroc 0.826 f1_score 0.534


Epoch: [43]  [  0/269]  eta: 0:03:07  lr: 0.000006  bag_loss: 0.4779 (0.4779)  instance_loss: 0.7393 (0.7393)  time: 0.6967  data: 0.6800  max mem: 337
Epoch: [43]  [100/269]  eta: 0:00:03  lr: 0.000005  bag_loss: 0.1528 (0.4570)  instance_loss: 0.7526 (0.7592)  time: 0.0148  data: 0.0012  max mem: 337
Epoch: [43]  [200/269]  eta: 0:00:01  lr: 0.000005  bag_loss: 0.3952 (0.4567)  instance_loss: 0.7926 (0.7718)  time: 0.0122  data: 0.0012  max mem: 337
Epoch: [43]  [268/269]  eta: 0:00:00  lr: 0.000004  bag_loss: 0.1675 (0.4616)  instance_loss: 0.6941 (0.7791)  time: 0.0152  data: 0.0011  max mem: 337
Epoch: [43] Total time: 0:00:05 (5.0039 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.3305 (0.3305)  acc1: 100.0000 (100.0000)  time: 0.6647  data: 0.6480  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1765 (0.4898)  acc1: 100.0000 (80.0000)  time: 0.0100  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.1145 s / it)
* Acc@1 80.000 loss 0.490 auroc 0.823 f1_score 0.467
Test  [  0/200]  eta: 0:02:13  loss: 1.3971 (1.3971)  acc1: 0.0000 (0.0000)  time: 0.6695  data: 0.6587  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3316 (0.6432)  acc1: 100.0000 (78.2178)  time: 0.0069  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0905 (0.5874)  acc1: 100.0000 (81.0000)  time: 0.0119  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.6265 s / it)
* Acc@1 81.000 loss 0.587 auroc 0.827 f1_score 0.534


Epoch: [44]  [  0/269]  eta: 0:03:06  lr: 0.000004  bag_loss: 1.2961 (1.2961)  instance_loss: 0.8554 (0.8554)  time: 0.6919  data: 0.6739  max mem: 337
Epoch: [44]  [100/269]  eta: 0:00:03  lr: 0.000004  bag_loss: 0.1584 (0.4366)  instance_loss: 0.7046 (0.7925)  time: 0.0126  data: 0.0010  max mem: 337
Epoch: [44]  [200/269]  eta: 0:00:01  lr: 0.000003  bag_loss: 0.2371 (0.4603)  instance_loss: 0.7609 (0.7950)  time: 0.0179  data: 0.0012  max mem: 337
Epoch: [44]  [268/269]  eta: 0:00:00  lr: 0.000003  bag_loss: 0.1299 (0.4716)  instance_loss: 0.6481 (0.7862)  time: 0.0139  data: 0.0013  max mem: 337
Epoch: [44] Total time: 0:00:05 (5.0517 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.3512 (0.3512)  acc1: 100.0000 (100.0000)  time: 0.6325  data: 0.6184  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1767 (0.4897)  acc1: 100.0000 (80.0000)  time: 0.0104  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.1068 s / it)
* Acc@1 80.000 loss 0.490 auroc 0.826 f1_score 0.467
Test  [  0/200]  eta: 0:02:05  loss: 1.3534 (1.3534)  acc1: 0.0000 (0.0000)  time: 0.6290  data: 0.6191  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3278 (0.6401)  acc1: 100.0000 (78.2178)  time: 0.0073  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0932 (0.5863)  acc1: 100.0000 (81.0000)  time: 0.0122  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.6106 s / it)
* Acc@1 81.000 loss 0.586 auroc 0.827 f1_score 0.534


Epoch: [45]  [  0/269]  eta: 0:03:03  lr: 0.000003  bag_loss: 0.7885 (0.7885)  instance_loss: 0.5207 (0.5207)  time: 0.6816  data: 0.6597  max mem: 337
Epoch: [45]  [100/269]  eta: 0:00:03  lr: 0.000003  bag_loss: 0.3647 (0.4559)  instance_loss: 0.7081 (0.8221)  time: 0.0154  data: 0.0012  max mem: 337
Epoch: [45]  [200/269]  eta: 0:00:01  lr: 0.000002  bag_loss: 0.1936 (0.4744)  instance_loss: 0.7438 (0.7843)  time: 0.0133  data: 0.0009  max mem: 337
Epoch: [45]  [268/269]  eta: 0:00:00  lr: 0.000002  bag_loss: 0.2050 (0.4707)  instance_loss: 0.6407 (0.7784)  time: 0.0155  data: 0.0010  max mem: 337
Epoch: [45] Total time: 0:00:04 (4.8837 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.3316 (0.3316)  acc1: 100.0000 (100.0000)  time: 0.6360  data: 0.6231  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1775 (0.4888)  acc1: 100.0000 (80.0000)  time: 0.0103  data: 0.0011  max mem: 337
Val Total time: 0:00:01 (1.1141 s / it)
* Acc@1 80.000 loss 0.489 auroc 0.825 f1_score 0.467
Test  [  0/200]  eta: 0:02:10  loss: 1.3834 (1.3834)  acc1: 0.0000 (0.0000)  time: 0.6504  data: 0.6431  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3308 (0.6422)  acc1: 100.0000 (78.2178)  time: 0.0094  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0897 (0.5870)  acc1: 100.0000 (81.0000)  time: 0.0109  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.7414 s / it)
* Acc@1 81.000 loss 0.587 auroc 0.827 f1_score 0.534


Epoch: [46]  [  0/269]  eta: 0:03:01  lr: 0.000002  bag_loss: 0.3250 (0.3250)  instance_loss: 0.7551 (0.7551)  time: 0.6749  data: 0.6491  max mem: 337
Epoch: [46]  [100/269]  eta: 0:00:03  lr: 0.000002  bag_loss: 0.2111 (0.5341)  instance_loss: 0.6748 (0.8066)  time: 0.0141  data: 0.0010  max mem: 337
Epoch: [46]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.2716 (0.4926)  instance_loss: 0.7861 (0.7836)  time: 0.0159  data: 0.0015  max mem: 337
Epoch: [46]  [268/269]  eta: 0:00:00  lr: 0.000001  bag_loss: 0.1634 (0.4575)  instance_loss: 0.7178 (0.7884)  time: 0.0190  data: 0.0012  max mem: 337
Epoch: [46] Total time: 0:00:05 (5.1131 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.3583 (0.3583)  acc1: 100.0000 (100.0000)  time: 0.6557  data: 0.6424  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1796 (0.4912)  acc1: 100.0000 (80.0000)  time: 0.0101  data: 0.0007  max mem: 337
Val Total time: 0:00:01 (1.1292 s / it)
* Acc@1 80.000 loss 0.491 auroc 0.825 f1_score 0.467
Test  [  0/200]  eta: 0:02:10  loss: 1.2875 (1.2875)  acc1: 0.0000 (0.0000)  time: 0.6511  data: 0.6426  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3409 (0.6432)  acc1: 100.0000 (78.2178)  time: 0.0081  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0939 (0.5879)  acc1: 100.0000 (81.0000)  time: 0.0113  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.7278 s / it)
* Acc@1 81.000 loss 0.588 auroc 0.826 f1_score 0.534


Epoch: [47]  [  0/269]  eta: 0:02:56  lr: 0.000001  bag_loss: 0.0295 (0.0295)  instance_loss: 0.5080 (0.5080)  time: 0.6560  data: 0.6346  max mem: 337
Epoch: [47]  [100/269]  eta: 0:00:03  lr: 0.000001  bag_loss: 0.1982 (0.4256)  instance_loss: 0.7787 (0.7639)  time: 0.0172  data: 0.0012  max mem: 337
Epoch: [47]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.2459 (0.4477)  instance_loss: 0.6407 (0.7807)  time: 0.0174  data: 0.0021  max mem: 337
Epoch: [47]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.2098 (0.4331)  instance_loss: 0.6765 (0.7852)  time: 0.0148  data: 0.0010  max mem: 337
Epoch: [47] Total time: 0:00:04 (4.9789 s / it)
Val  [ 0/30]  eta: 0:00:20  loss: 0.3645 (0.3645)  acc1: 100.0000 (100.0000)  time: 0.6778  data: 0.6687  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1804 (0.4917)  acc1: 100.0000 (80.0000)  time: 0.0099  data: 0.0009  max mem: 337
Val Total time: 0:00:01 (1.1314 s / it)
* Acc@1 80.000 loss 0.492 auroc 0.823 f1_score 0.467
Test  [  0/200]  eta: 0:02:07  loss: 1.2599 (1.2599)  acc1: 0.0000 (0.0000)  time: 0.6389  data: 0.6308  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3451 (0.6440)  acc1: 100.0000 (78.2178)  time: 0.0085  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0943 (0.5884)  acc1: 100.0000 (81.0000)  time: 0.0116  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.6922 s / it)
* Acc@1 81.000 loss 0.588 auroc 0.826 f1_score 0.534


Epoch: [48]  [  0/269]  eta: 0:03:05  lr: 0.000000  bag_loss: 1.0924 (1.0924)  instance_loss: 0.9448 (0.9448)  time: 0.6878  data: 0.6500  max mem: 337
Epoch: [48]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.2569 (0.3477)  instance_loss: 0.7157 (0.7905)  time: 0.0143  data: 0.0010  max mem: 337
Epoch: [48]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.2206 (0.4032)  instance_loss: 0.6916 (0.7778)  time: 0.0145  data: 0.0010  max mem: 337
Epoch: [48]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.2742 (0.4506)  instance_loss: 0.6285 (0.7730)  time: 0.0148  data: 0.0010  max mem: 337
Epoch: [48] Total time: 0:00:04 (4.8002 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.3659 (0.3659)  acc1: 100.0000 (100.0000)  time: 0.6568  data: 0.6432  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1795 (0.4913)  acc1: 100.0000 (80.0000)  time: 0.0083  data: 0.0006  max mem: 337
Val Total time: 0:00:01 (1.0811 s / it)
* Acc@1 80.000 loss 0.491 auroc 0.825 f1_score 0.467
Test  [  0/200]  eta: 0:01:58  loss: 1.2560 (1.2560)  acc1: 0.0000 (0.0000)  time: 0.5928  data: 0.5842  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3440 (0.6438)  acc1: 100.0000 (78.2178)  time: 0.0073  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0945 (0.5884)  acc1: 100.0000 (81.0000)  time: 0.0120  data: 0.0015  max mem: 337
Test Total time: 0:00:02 (2.4316 s / it)
* Acc@1 81.000 loss 0.588 auroc 0.826 f1_score 0.534


Epoch: [49]  [  0/269]  eta: 0:03:30  lr: 0.000000  bag_loss: 0.1247 (0.1247)  instance_loss: 0.8836 (0.8836)  time: 0.7816  data: 0.7567  max mem: 337
Epoch: [49]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.1459 (0.4379)  instance_loss: 0.7470 (0.7981)  time: 0.0141  data: 0.0011  max mem: 337
Epoch: [49]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1362 (0.4404)  instance_loss: 1.0609 (0.8027)  time: 0.0139  data: 0.0010  max mem: 337
Epoch: [49]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.2670 (0.4489)  instance_loss: 0.6337 (0.7875)  time: 0.0139  data: 0.0011  max mem: 337
Epoch: [49] Total time: 0:00:04 (4.8788 s / it)
Val  [ 0/30]  eta: 0:00:19  loss: 0.3671 (0.3671)  acc1: 100.0000 (100.0000)  time: 0.6460  data: 0.6369  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1800 (0.4915)  acc1: 100.0000 (80.0000)  time: 0.0085  data: 0.0008  max mem: 337
Val Total time: 0:00:01 (1.0396 s / it)
* Acc@1 80.000 loss 0.492 auroc 0.825 f1_score 0.467
Test  [  0/200]  eta: 0:02:09  loss: 1.2518 (1.2518)  acc1: 0.0000 (0.0000)  time: 0.6465  data: 0.6383  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3452 (0.6440)  acc1: 100.0000 (78.2178)  time: 0.0068  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.0946 (0.5885)  acc1: 100.0000 (81.0000)  time: 0.0099  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.4249 s / it)
* Acc@1 81.000 loss 0.589 auroc 0.826 f1_score 0.534


Results on best epoch:
{'epoch': 7, 'val_acc': 90.0, 'val_auc': 0.9452639818191528, 'val_f1': 0.48469388484954834, 'test_acc': 81.5, 'test_auc': 0.7755624651908875, 'test_f1': 0.47409355640411377}
Wandb run dir: /fs2/comm/kpgrp/yelinfen/Documents/ACMIL/wandb/offline-run-20250807_124125-ms7vx1i3/files
Used config:
{'B': 1,
 'D_feat': 512,
 'D_inner': 256,
 'arch': 'clam_sb',
 'augment_epoch': 1,
 'backbone': 'Resnet18',
 'config': 'config/patch_classification_camelyon17_config.yml',
 'data_dir': './Features/CAM17_res18',
 'dataset': 'camelyon17',
 'heatmap_arguments': {'alpha': 0.4,
                       'binarize': False,
                       'blank_canvas': False,
                       'blur': True,
                       'cmap': 'jet',
                       'custom_downsample': 1,
                       'vis_level': -1},
 'load_head_checkpoints': False,
 'lr': 0.0001,
 'min_lr': 0,
 'n_class': 4,
 'n_shot': -1,
 'n_token': 4,
 'n_worker': 8,
 'optim': 'sgd',
 'pin_memory': False,
 'pretrain': 'natural_supervsied',
 'seed': 2,
 'start_epoch': 0,
 'train_epoch': 50,
 'w_loss': 1.0,
 'wandb_mode': 'offline',
 'warmup_epoch': 5,
 'wd': 0.0005}
get dataset
Epoch: [0]  [  0/269]  eta: 0:04:30  lr: 0.000000  bag_loss: 2.9927 (2.9927)  instance_loss: 0.7672 (0.7672)  time: 1.0038  data: 0.5008  max mem: 223
Epoch: [0]  [100/269]  eta: 0:00:04  lr: 0.000007  bag_loss: 2.0378 (2.2173)  instance_loss: 1.2038 (1.1625)  time: 0.0141  data: 0.0012  max mem: 289
Epoch: [0]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.9525 (1.7506)  instance_loss: 1.3059 (1.2024)  time: 0.0133  data: 0.0012  max mem: 337
Epoch: [0]  [268/269]  eta: 0:00:00  lr: 0.000020  bag_loss: 0.7982 (1.5749)  instance_loss: 1.2451 (1.2512)  time: 0.0138  data: 0.0011  max mem: 337
Epoch: [0] Total time: 0:00:04 (4.9296 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.3820 (0.3820)  acc1: 100.0000 (100.0000)  time: 0.5415  data: 0.5219  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.6647 (1.1268)  acc1: 100.0000 (63.3333)  time: 0.0069  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.8880 s / it)
* Acc@1 63.333 loss 1.127 auroc 0.324 f1_score 0.194
Test  [  0/200]  eta: 0:01:44  loss: 1.7204 (1.7204)  acc1: 0.0000 (0.0000)  time: 0.5234  data: 0.5166  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5289 (1.1796)  acc1: 100.0000 (59.4059)  time: 0.0063  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.8261 (1.1322)  acc1: 100.0000 (60.5000)  time: 0.0102  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1507 s / it)
* Acc@1 60.500 loss 1.132 auroc 0.455 f1_score 0.188


Epoch: [1]  [  0/269]  eta: 0:02:35  lr: 0.000020  bag_loss: 0.6039 (0.6039)  instance_loss: 1.5722 (1.5722)  time: 0.5794  data: 0.5632  max mem: 337
Epoch: [1]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.4281 (0.9744)  instance_loss: 1.4447 (1.4272)  time: 0.0139  data: 0.0012  max mem: 337
Epoch: [1]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.4087 (1.0347)  instance_loss: 1.4846 (1.4302)  time: 0.0114  data: 0.0014  max mem: 337
Epoch: [1]  [268/269]  eta: 0:00:00  lr: 0.000040  bag_loss: 0.5344 (1.0343)  instance_loss: 1.3817 (1.4185)  time: 0.0131  data: 0.0011  max mem: 337
Epoch: [1] Total time: 0:00:04 (4.3790 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.3796 (0.3796)  acc1: 100.0000 (100.0000)  time: 0.5641  data: 0.5564  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5746 (1.0908)  acc1: 100.0000 (63.3333)  time: 0.0077  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9322 s / it)
* Acc@1 63.333 loss 1.091 auroc 0.415 f1_score 0.194
Test  [  0/200]  eta: 0:01:54  loss: 1.8019 (1.8019)  acc1: 0.0000 (0.0000)  time: 0.5725  data: 0.5590  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5147 (1.1558)  acc1: 100.0000 (59.4059)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.7201 (1.1030)  acc1: 100.0000 (60.5000)  time: 0.0088  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1534 s / it)
* Acc@1 60.500 loss 1.103 auroc 0.479 f1_score 0.188


Epoch: [2]  [  0/269]  eta: 0:02:36  lr: 0.000040  bag_loss: 0.5398 (0.5398)  instance_loss: 1.6444 (1.6444)  time: 0.5800  data: 0.5542  max mem: 337
Epoch: [2]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.3795 (1.0004)  instance_loss: 1.4176 (1.3372)  time: 0.0124  data: 0.0009  max mem: 337
Epoch: [2]  [200/269]  eta: 0:00:01  lr: 0.000055  bag_loss: 0.5057 (1.0299)  instance_loss: 1.3951 (1.3443)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [2]  [268/269]  eta: 0:00:00  lr: 0.000060  bag_loss: 0.4228 (1.0250)  instance_loss: 1.4306 (1.3496)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [2] Total time: 0:00:04 (4.3527 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.3469 (0.3469)  acc1: 100.0000 (100.0000)  time: 0.5558  data: 0.5491  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4634 (1.0603)  acc1: 100.0000 (63.3333)  time: 0.0072  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9008 s / it)
* Acc@1 63.333 loss 1.060 auroc 0.485 f1_score 0.194
Test  [  0/200]  eta: 0:01:52  loss: 1.9151 (1.9151)  acc1: 0.0000 (0.0000)  time: 0.5643  data: 0.5557  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4138 (1.1166)  acc1: 100.0000 (59.4059)  time: 0.0062  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5542 (1.0637)  acc1: 100.0000 (60.5000)  time: 0.0084  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1335 s / it)
* Acc@1 60.500 loss 1.064 auroc 0.553 f1_score 0.188


Epoch: [3]  [  0/269]  eta: 0:02:28  lr: 0.000060  bag_loss: 0.3475 (0.3475)  instance_loss: 1.6341 (1.6341)  time: 0.5525  data: 0.5415  max mem: 337
Epoch: [3]  [100/269]  eta: 0:00:03  lr: 0.000067  bag_loss: 0.4890 (0.9604)  instance_loss: 1.2994 (1.3769)  time: 0.0145  data: 0.0012  max mem: 337
Epoch: [3]  [200/269]  eta: 0:00:01  lr: 0.000075  bag_loss: 0.3750 (1.0233)  instance_loss: 1.3701 (1.3577)  time: 0.0135  data: 0.0012  max mem: 337
Epoch: [3]  [268/269]  eta: 0:00:00  lr: 0.000080  bag_loss: 0.3313 (1.0274)  instance_loss: 1.2498 (1.3444)  time: 0.0128  data: 0.0012  max mem: 337
Epoch: [3] Total time: 0:00:04 (4.3300 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2011 (0.2011)  acc1: 100.0000 (100.0000)  time: 0.5680  data: 0.5616  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2560 (1.1211)  acc1: 100.0000 (63.3333)  time: 0.0072  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9213 s / it)
* Acc@1 63.333 loss 1.121 auroc 0.542 f1_score 0.194
Test  [  0/200]  eta: 0:01:53  loss: 2.6489 (2.6489)  acc1: 0.0000 (0.0000)  time: 0.5687  data: 0.5605  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2558 (1.1648)  acc1: 100.0000 (59.4059)  time: 0.0059  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3350 (1.0701)  acc1: 100.0000 (60.5000)  time: 0.0091  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1083 s / it)
* Acc@1 60.500 loss 1.070 auroc 0.630 f1_score 0.188


Epoch: [4]  [  0/269]  eta: 0:02:38  lr: 0.000080  bag_loss: 0.2762 (0.2762)  instance_loss: 1.6542 (1.6542)  time: 0.5907  data: 0.5732  max mem: 337
Epoch: [4]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.7890 (0.9233)  instance_loss: 1.1061 (1.3550)  time: 0.0146  data: 0.0012  max mem: 337
Epoch: [4]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.5294 (0.9987)  instance_loss: 1.2242 (1.2973)  time: 0.0131  data: 0.0011  max mem: 337
Epoch: [4]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.3828 (0.9980)  instance_loss: 1.2871 (1.3014)  time: 0.0145  data: 0.0013  max mem: 337
Epoch: [4] Total time: 0:00:04 (4.7250 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.3845 (0.3845)  acc1: 100.0000 (100.0000)  time: 0.6245  data: 0.6172  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5107 (1.0398)  acc1: 100.0000 (63.3333)  time: 0.0072  data: 0.0005  max mem: 337
Val Total time: 0:00:00 (0.9903 s / it)
* Acc@1 63.333 loss 1.040 auroc 0.653 f1_score 0.194
Test  [  0/200]  eta: 0:01:54  loss: 2.3682 (2.3682)  acc1: 0.0000 (0.0000)  time: 0.5707  data: 0.5625  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4706 (1.0078)  acc1: 100.0000 (68.3168)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5837 (0.9518)  acc1: 100.0000 (68.5000)  time: 0.0089  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1469 s / it)
* Acc@1 68.500 loss 0.952 auroc 0.722 f1_score 0.330


Epoch: [5]  [  0/269]  eta: 0:02:40  lr: 0.000100  bag_loss: 1.1961 (1.1961)  instance_loss: 1.1899 (1.1899)  time: 0.5949  data: 0.5590  max mem: 337
Epoch: [5]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.5263 (0.9755)  instance_loss: 1.2210 (1.2594)  time: 0.0144  data: 0.0011  max mem: 337
Epoch: [5]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.3412 (0.9759)  instance_loss: 1.3206 (1.2425)  time: 0.0121  data: 0.0010  max mem: 337
Epoch: [5]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.2070 (0.9278)  instance_loss: 1.3681 (1.2651)  time: 0.0144  data: 0.0011  max mem: 337
Epoch: [5] Total time: 0:00:04 (4.3706 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.1829 (0.1829)  acc1: 100.0000 (100.0000)  time: 0.5611  data: 0.5461  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1959 (0.9985)  acc1: 100.0000 (63.3333)  time: 0.0072  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9460 s / it)
* Acc@1 63.333 loss 0.999 auroc 0.801 f1_score 0.194
Test  [  0/200]  eta: 0:01:55  loss: 2.8632 (2.8632)  acc1: 0.0000 (0.0000)  time: 0.5769  data: 0.5660  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1879 (0.8883)  acc1: 100.0000 (75.2475)  time: 0.0080  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2849 (0.8116)  acc1: 100.0000 (76.0000)  time: 0.0091  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2353 s / it)
* Acc@1 76.000 loss 0.812 auroc 0.767 f1_score 0.409


Epoch: [6]  [  0/269]  eta: 0:02:38  lr: 0.000100  bag_loss: 0.1913 (0.1913)  instance_loss: 1.4755 (1.4755)  time: 0.5876  data: 0.5759  max mem: 337
Epoch: [6]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.1602 (0.8225)  instance_loss: 1.1484 (1.2212)  time: 0.0140  data: 0.0012  max mem: 337
Epoch: [6]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.6076 (0.8306)  instance_loss: 1.2395 (1.2179)  time: 0.0151  data: 0.0011  max mem: 337
Epoch: [6]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.3434 (0.8391)  instance_loss: 1.2176 (1.2341)  time: 0.0145  data: 0.0012  max mem: 337
Epoch: [6] Total time: 0:00:04 (4.4921 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.4178 (0.4178)  acc1: 100.0000 (100.0000)  time: 0.5589  data: 0.5520  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3532 (0.7674)  acc1: 100.0000 (73.3333)  time: 0.0077  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9261 s / it)
* Acc@1 73.333 loss 0.767 auroc 0.830 f1_score 0.399
Test  [  0/200]  eta: 0:01:55  loss: 1.6502 (1.6502)  acc1: 0.0000 (0.0000)  time: 0.5754  data: 0.5670  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3124 (0.7317)  acc1: 100.0000 (77.2277)  time: 0.0065  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3379 (0.6982)  acc1: 100.0000 (80.5000)  time: 0.0091  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1840 s / it)
* Acc@1 80.500 loss 0.698 auroc 0.786 f1_score 0.445


Epoch: [7]  [  0/269]  eta: 0:02:33  lr: 0.000100  bag_loss: 0.3153 (0.3153)  instance_loss: 1.4781 (1.4781)  time: 0.5690  data: 0.5533  max mem: 337
Epoch: [7]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.2652 (0.7636)  instance_loss: 1.3200 (1.3192)  time: 0.0153  data: 0.0010  max mem: 337
Epoch: [7]  [200/269]  eta: 0:00:01  lr: 0.000099  bag_loss: 0.2828 (0.7743)  instance_loss: 1.0885 (1.2571)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [7]  [268/269]  eta: 0:00:00  lr: 0.000099  bag_loss: 0.2625 (0.7719)  instance_loss: 1.2078 (1.2512)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [7] Total time: 0:00:04 (4.3921 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2887 (0.2887)  acc1: 100.0000 (100.0000)  time: 0.5680  data: 0.5616  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1941 (0.8215)  acc1: 100.0000 (70.0000)  time: 0.0079  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9536 s / it)
* Acc@1 70.000 loss 0.822 auroc 0.820 f1_score 0.369
Test  [  0/200]  eta: 0:01:57  loss: 1.5455 (1.5455)  acc1: 0.0000 (0.0000)  time: 0.5854  data: 0.5773  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2157 (0.7255)  acc1: 100.0000 (76.2376)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2514 (0.7156)  acc1: 100.0000 (77.0000)  time: 0.0090  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1550 s / it)
* Acc@1 77.000 loss 0.716 auroc 0.781 f1_score 0.418


Epoch: [8]  [  0/269]  eta: 0:02:34  lr: 0.000099  bag_loss: 0.1800 (0.1800)  instance_loss: 1.5222 (1.5222)  time: 0.5727  data: 0.5506  max mem: 337
Epoch: [8]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.2270 (0.7728)  instance_loss: 1.2241 (1.2011)  time: 0.0137  data: 0.0011  max mem: 337
Epoch: [8]  [200/269]  eta: 0:00:01  lr: 0.000098  bag_loss: 0.3617 (0.7952)  instance_loss: 1.2712 (1.2247)  time: 0.0145  data: 0.0010  max mem: 337
Epoch: [8]  [268/269]  eta: 0:00:00  lr: 0.000098  bag_loss: 0.3457 (0.7738)  instance_loss: 1.1815 (1.2127)  time: 0.0104  data: 0.0010  max mem: 337
Epoch: [8] Total time: 0:00:04 (4.3005 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3101 (0.3101)  acc1: 100.0000 (100.0000)  time: 0.5713  data: 0.5641  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2336 (0.8179)  acc1: 100.0000 (66.6667)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9319 s / it)
* Acc@1 66.667 loss 0.818 auroc 0.820 f1_score 0.285
Test  [  0/200]  eta: 0:01:54  loss: 1.6571 (1.6571)  acc1: 0.0000 (0.0000)  time: 0.5719  data: 0.5641  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2113 (0.6913)  acc1: 100.0000 (76.2376)  time: 0.0066  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2561 (0.6664)  acc1: 100.0000 (78.5000)  time: 0.0093  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2208 s / it)
* Acc@1 78.500 loss 0.666 auroc 0.789 f1_score 0.431


Epoch: [9]  [  0/269]  eta: 0:02:33  lr: 0.000098  bag_loss: 2.4300 (2.4300)  instance_loss: 1.3974 (1.3974)  time: 0.5689  data: 0.5512  max mem: 337
Epoch: [9]  [100/269]  eta: 0:00:03  lr: 0.000098  bag_loss: 0.5066 (0.7808)  instance_loss: 1.2418 (1.2472)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [9]  [200/269]  eta: 0:00:01  lr: 0.000097  bag_loss: 0.2374 (0.7407)  instance_loss: 1.2300 (1.2364)  time: 0.0130  data: 0.0011  max mem: 337
Epoch: [9]  [268/269]  eta: 0:00:00  lr: 0.000097  bag_loss: 0.2974 (0.7280)  instance_loss: 1.1584 (1.2318)  time: 0.0125  data: 0.0011  max mem: 337
Epoch: [9] Total time: 0:00:04 (4.4037 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2811 (0.2811)  acc1: 100.0000 (100.0000)  time: 0.5822  data: 0.5729  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2044 (0.8689)  acc1: 100.0000 (66.6667)  time: 0.0076  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9563 s / it)
* Acc@1 66.667 loss 0.869 auroc 0.791 f1_score 0.285
Test  [  0/200]  eta: 0:01:51  loss: 1.9639 (1.9639)  acc1: 0.0000 (0.0000)  time: 0.5570  data: 0.5493  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1671 (0.7033)  acc1: 100.0000 (76.2376)  time: 0.0066  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2294 (0.6748)  acc1: 100.0000 (78.0000)  time: 0.0086  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1722 s / it)
* Acc@1 78.000 loss 0.675 auroc 0.783 f1_score 0.426


Epoch: [10]  [  0/269]  eta: 0:02:33  lr: 0.000097  bag_loss: 0.2047 (0.2047)  instance_loss: 1.1015 (1.1015)  time: 0.5722  data: 0.5584  max mem: 337
Epoch: [10]  [100/269]  eta: 0:00:03  lr: 0.000097  bag_loss: 0.1441 (0.5076)  instance_loss: 1.2293 (1.2059)  time: 0.0156  data: 0.0012  max mem: 337
Epoch: [10]  [200/269]  eta: 0:00:01  lr: 0.000096  bag_loss: 0.2658 (0.6337)  instance_loss: 1.2976 (1.2546)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [10]  [268/269]  eta: 0:00:00  lr: 0.000096  bag_loss: 0.3068 (0.7125)  instance_loss: 1.2744 (1.2743)  time: 0.0137  data: 0.0012  max mem: 337
Epoch: [10] Total time: 0:00:04 (4.4022 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.4619 (0.4619)  acc1: 100.0000 (100.0000)  time: 0.5646  data: 0.5483  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3333 (0.7895)  acc1: 100.0000 (70.0000)  time: 0.0074  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9939 s / it)
* Acc@1 70.000 loss 0.789 auroc 0.795 f1_score 0.359
Test  [  0/200]  eta: 0:01:54  loss: 2.2000 (2.2000)  acc1: 0.0000 (0.0000)  time: 0.5725  data: 0.5640  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2848 (0.6709)  acc1: 100.0000 (80.1980)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2942 (0.6409)  acc1: 100.0000 (83.0000)  time: 0.0089  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2013 s / it)
* Acc@1 83.000 loss 0.641 auroc 0.797 f1_score 0.521


Epoch: [11]  [  0/269]  eta: 0:02:42  lr: 0.000096  bag_loss: 0.5881 (0.5881)  instance_loss: 1.5163 (1.5163)  time: 0.6056  data: 0.5733  max mem: 337
Epoch: [11]  [100/269]  eta: 0:00:03  lr: 0.000095  bag_loss: 0.2667 (0.6707)  instance_loss: 1.3612 (1.3594)  time: 0.0133  data: 0.0010  max mem: 337
Epoch: [11]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.1320 (0.5795)  instance_loss: 1.4215 (1.3686)  time: 0.0154  data: 0.0013  max mem: 337
Epoch: [11]  [268/269]  eta: 0:00:00  lr: 0.000094  bag_loss: 0.8822 (0.6950)  instance_loss: 1.2554 (1.3782)  time: 0.0155  data: 0.0012  max mem: 337
Epoch: [11] Total time: 0:00:04 (4.3845 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.4389 (0.4389)  acc1: 100.0000 (100.0000)  time: 0.5719  data: 0.5651  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5399 (0.7307)  acc1: 100.0000 (73.3333)  time: 0.0074  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9318 s / it)
* Acc@1 73.333 loss 0.731 auroc 0.868 f1_score 0.459
Test  [  0/200]  eta: 0:01:56  loss: 1.1452 (1.1452)  acc1: 0.0000 (0.0000)  time: 0.5809  data: 0.5731  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5242 (0.6744)  acc1: 100.0000 (80.1980)  time: 0.0067  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6099 (0.7066)  acc1: 100.0000 (82.5000)  time: 0.0090  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1974 s / it)
* Acc@1 82.500 loss 0.707 auroc 0.812 f1_score 0.558


Epoch: [12]  [  0/269]  eta: 0:02:36  lr: 0.000094  bag_loss: 0.5299 (0.5299)  instance_loss: 1.5846 (1.5846)  time: 0.5830  data: 0.5692  max mem: 337
Epoch: [12]  [100/269]  eta: 0:00:03  lr: 0.000094  bag_loss: 0.3103 (0.6234)  instance_loss: 1.2589 (1.3283)  time: 0.0144  data: 0.0011  max mem: 337
Epoch: [12]  [200/269]  eta: 0:00:01  lr: 0.000093  bag_loss: 0.2247 (0.6731)  instance_loss: 1.4015 (1.3547)  time: 0.0125  data: 0.0012  max mem: 337
Epoch: [12]  [268/269]  eta: 0:00:00  lr: 0.000092  bag_loss: 0.4899 (0.6936)  instance_loss: 1.3399 (1.3550)  time: 0.0155  data: 0.0014  max mem: 337
Epoch: [12] Total time: 0:00:04 (4.5468 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3335 (0.3335)  acc1: 100.0000 (100.0000)  time: 0.5808  data: 0.5745  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3933 (0.7059)  acc1: 100.0000 (76.6667)  time: 0.0077  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9535 s / it)
* Acc@1 76.667 loss 0.706 auroc 0.835 f1_score 0.487
Test  [  0/200]  eta: 0:01:53  loss: 0.8282 (0.8282)  acc1: 100.0000 (100.0000)  time: 0.5694  data: 0.5606  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2865 (0.6345)  acc1: 100.0000 (82.1782)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3946 (0.6793)  acc1: 100.0000 (81.0000)  time: 0.0087  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1538 s / it)
* Acc@1 81.000 loss 0.679 auroc 0.827 f1_score 0.524


Epoch: [13]  [  0/269]  eta: 0:02:39  lr: 0.000092  bag_loss: 0.2528 (0.2528)  instance_loss: 1.3856 (1.3856)  time: 0.5933  data: 0.5811  max mem: 337
Epoch: [13]  [100/269]  eta: 0:00:03  lr: 0.000092  bag_loss: 0.2794 (0.5920)  instance_loss: 1.2496 (1.4066)  time: 0.0132  data: 0.0012  max mem: 337
Epoch: [13]  [200/269]  eta: 0:00:01  lr: 0.000091  bag_loss: 0.4303 (0.7182)  instance_loss: 1.2856 (1.3888)  time: 0.0143  data: 0.0012  max mem: 337
Epoch: [13]  [268/269]  eta: 0:00:00  lr: 0.000090  bag_loss: 0.2378 (0.6780)  instance_loss: 1.4923 (1.3893)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [13] Total time: 0:00:04 (4.4999 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2123 (0.2123)  acc1: 100.0000 (100.0000)  time: 0.5712  data: 0.5643  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1547 (0.7627)  acc1: 100.0000 (76.6667)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9479 s / it)
* Acc@1 76.667 loss 0.763 auroc 0.811 f1_score 0.487
Test  [  0/200]  eta: 0:01:53  loss: 1.3290 (1.3290)  acc1: 0.0000 (0.0000)  time: 0.5694  data: 0.5608  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1084 (0.6900)  acc1: 100.0000 (77.2277)  time: 0.0069  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1486 (0.6874)  acc1: 100.0000 (78.5000)  time: 0.0083  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.1818 s / it)
* Acc@1 78.500 loss 0.687 auroc 0.813 f1_score 0.454


Epoch: [14]  [  0/269]  eta: 0:02:32  lr: 0.000090  bag_loss: 0.0634 (0.0634)  instance_loss: 1.1682 (1.1682)  time: 0.5668  data: 0.5485  max mem: 337
Epoch: [14]  [100/269]  eta: 0:00:03  lr: 0.000090  bag_loss: 0.5249 (0.7343)  instance_loss: 1.2894 (1.2912)  time: 0.0171  data: 0.0012  max mem: 337
Epoch: [14]  [200/269]  eta: 0:00:01  lr: 0.000089  bag_loss: 0.2682 (0.6605)  instance_loss: 1.4043 (1.3655)  time: 0.0116  data: 0.0010  max mem: 337
Epoch: [14]  [268/269]  eta: 0:00:00  lr: 0.000088  bag_loss: 0.3172 (0.6438)  instance_loss: 1.4557 (1.4030)  time: 0.0144  data: 0.0011  max mem: 337
Epoch: [14] Total time: 0:00:04 (4.3531 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2561 (0.2561)  acc1: 100.0000 (100.0000)  time: 0.5870  data: 0.5797  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2275 (0.8545)  acc1: 100.0000 (73.3333)  time: 0.0080  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9570 s / it)
* Acc@1 73.333 loss 0.854 auroc 0.803 f1_score 0.396
Test  [  0/200]  eta: 0:01:55  loss: 3.1798 (3.1798)  acc1: 0.0000 (0.0000)  time: 0.5780  data: 0.5682  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2149 (0.7081)  acc1: 100.0000 (76.2376)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2040 (0.6230)  acc1: 100.0000 (81.0000)  time: 0.0091  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2068 s / it)
* Acc@1 81.000 loss 0.623 auroc 0.812 f1_score 0.442


Epoch: [15]  [  0/269]  eta: 0:02:38  lr: 0.000088  bag_loss: 0.0404 (0.0404)  instance_loss: 1.6882 (1.6882)  time: 0.5901  data: 0.5720  max mem: 337
Epoch: [15]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.2528 (0.6727)  instance_loss: 1.3612 (1.4064)  time: 0.0157  data: 0.0011  max mem: 337
Epoch: [15]  [200/269]  eta: 0:00:01  lr: 0.000087  bag_loss: 0.2554 (0.6024)  instance_loss: 1.6598 (1.4591)  time: 0.0144  data: 0.0011  max mem: 337
Epoch: [15]  [268/269]  eta: 0:00:00  lr: 0.000086  bag_loss: 0.4074 (0.6480)  instance_loss: 1.4731 (1.4452)  time: 0.0136  data: 0.0012  max mem: 337
Epoch: [15] Total time: 0:00:04 (4.4727 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3222 (0.3222)  acc1: 100.0000 (100.0000)  time: 0.5749  data: 0.5631  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3025 (0.7246)  acc1: 100.0000 (70.0000)  time: 0.0075  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9403 s / it)
* Acc@1 70.000 loss 0.725 auroc 0.837 f1_score 0.359
Test  [  0/200]  eta: 0:01:54  loss: 1.1109 (1.1109)  acc1: 0.0000 (0.0000)  time: 0.5720  data: 0.5639  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2792 (0.6347)  acc1: 100.0000 (77.2277)  time: 0.0068  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2818 (0.6292)  acc1: 100.0000 (79.5000)  time: 0.0093  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2007 s / it)
* Acc@1 79.500 loss 0.629 auroc 0.826 f1_score 0.505


Epoch: [16]  [  0/269]  eta: 0:02:33  lr: 0.000086  bag_loss: 0.6999 (0.6999)  instance_loss: 1.5511 (1.5511)  time: 0.5707  data: 0.5572  max mem: 337
Epoch: [16]  [100/269]  eta: 0:00:03  lr: 0.000085  bag_loss: 0.1842 (0.6113)  instance_loss: 1.3895 (1.3702)  time: 0.0131  data: 0.0011  max mem: 337
Epoch: [16]  [200/269]  eta: 0:00:01  lr: 0.000084  bag_loss: 0.3906 (0.6269)  instance_loss: 1.3849 (1.4097)  time: 0.0126  data: 0.0011  max mem: 337
Epoch: [16]  [268/269]  eta: 0:00:00  lr: 0.000083  bag_loss: 0.2811 (0.6379)  instance_loss: 1.2866 (1.4006)  time: 0.0109  data: 0.0009  max mem: 337
Epoch: [16] Total time: 0:00:04 (4.4524 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2279 (0.2279)  acc1: 100.0000 (100.0000)  time: 0.5773  data: 0.5707  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3129 (0.6840)  acc1: 100.0000 (73.3333)  time: 0.0077  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9404 s / it)
* Acc@1 73.333 loss 0.684 auroc 0.841 f1_score 0.396
Test  [  0/200]  eta: 0:01:58  loss: 1.7442 (1.7442)  acc1: 0.0000 (0.0000)  time: 0.5913  data: 0.5811  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2052 (0.6130)  acc1: 100.0000 (80.1980)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2409 (0.5975)  acc1: 100.0000 (82.5000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1910 s / it)
* Acc@1 82.500 loss 0.597 auroc 0.849 f1_score 0.533


Epoch: [17]  [  0/269]  eta: 0:02:37  lr: 0.000083  bag_loss: 0.2954 (0.2954)  instance_loss: 2.1616 (2.1616)  time: 0.5841  data: 0.5664  max mem: 337
Epoch: [17]  [100/269]  eta: 0:00:03  lr: 0.000082  bag_loss: 0.2030 (0.7485)  instance_loss: 1.1257 (1.4786)  time: 0.0123  data: 0.0011  max mem: 337
Epoch: [17]  [200/269]  eta: 0:00:01  lr: 0.000081  bag_loss: 0.2619 (0.6586)  instance_loss: 1.3283 (1.4677)  time: 0.0096  data: 0.0011  max mem: 337
Epoch: [17]  [268/269]  eta: 0:00:00  lr: 0.000081  bag_loss: 0.1892 (0.6374)  instance_loss: 1.4373 (1.4686)  time: 0.0169  data: 0.0012  max mem: 337
Epoch: [17] Total time: 0:00:04 (4.4068 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2449 (0.2449)  acc1: 100.0000 (100.0000)  time: 0.5729  data: 0.5656  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3258 (0.7669)  acc1: 100.0000 (70.0000)  time: 0.0076  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9349 s / it)
* Acc@1 70.000 loss 0.767 auroc 0.834 f1_score 0.359
Test  [  0/200]  eta: 0:02:05  loss: 2.5387 (2.5387)  acc1: 0.0000 (0.0000)  time: 0.6268  data: 0.6194  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2478 (0.6685)  acc1: 100.0000 (76.2376)  time: 0.0067  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2522 (0.6068)  acc1: 100.0000 (80.0000)  time: 0.0092  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.2578 s / it)
* Acc@1 80.000 loss 0.607 auroc 0.840 f1_score 0.516


Epoch: [18]  [  0/269]  eta: 0:02:30  lr: 0.000081  bag_loss: 0.3158 (0.3158)  instance_loss: 1.2547 (1.2547)  time: 0.5611  data: 0.5414  max mem: 337
Epoch: [18]  [100/269]  eta: 0:00:03  lr: 0.000080  bag_loss: 0.2312 (0.4686)  instance_loss: 1.4425 (1.5054)  time: 0.0147  data: 0.0011  max mem: 337
Epoch: [18]  [200/269]  eta: 0:00:01  lr: 0.000079  bag_loss: 0.2346 (0.5891)  instance_loss: 1.4168 (1.4426)  time: 0.0131  data: 0.0011  max mem: 337
Epoch: [18]  [268/269]  eta: 0:00:00  lr: 0.000078  bag_loss: 0.2457 (0.6141)  instance_loss: 1.3338 (1.4184)  time: 0.0140  data: 0.0010  max mem: 337
Epoch: [18] Total time: 0:00:04 (4.4330 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3550 (0.3550)  acc1: 100.0000 (100.0000)  time: 0.5793  data: 0.5717  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5127 (0.7017)  acc1: 100.0000 (73.3333)  time: 0.0076  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9507 s / it)
* Acc@1 73.333 loss 0.702 auroc 0.854 f1_score 0.441
Test  [  0/200]  eta: 0:01:54  loss: 1.2588 (1.2588)  acc1: 0.0000 (0.0000)  time: 0.5710  data: 0.5556  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4352 (0.6347)  acc1: 100.0000 (75.2475)  time: 0.0065  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.4305 (0.6505)  acc1: 100.0000 (80.0000)  time: 0.0084  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.1833 s / it)
* Acc@1 80.000 loss 0.651 auroc 0.850 f1_score 0.565


Epoch: [19]  [  0/269]  eta: 0:02:34  lr: 0.000078  bag_loss: 0.4271 (0.4271)  instance_loss: 1.5041 (1.5041)  time: 0.5756  data: 0.5570  max mem: 337
Epoch: [19]  [100/269]  eta: 0:00:03  lr: 0.000077  bag_loss: 0.3233 (0.6624)  instance_loss: 1.2237 (1.2968)  time: 0.0120  data: 0.0012  max mem: 337
Epoch: [19]  [200/269]  eta: 0:00:01  lr: 0.000076  bag_loss: 0.1273 (0.6216)  instance_loss: 1.3651 (1.3446)  time: 0.0124  data: 0.0012  max mem: 337
Epoch: [19]  [268/269]  eta: 0:00:00  lr: 0.000075  bag_loss: 0.4618 (0.6211)  instance_loss: 1.1627 (1.3512)  time: 0.0107  data: 0.0010  max mem: 337
Epoch: [19] Total time: 0:00:04 (4.4633 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2751 (0.2751)  acc1: 100.0000 (100.0000)  time: 0.5839  data: 0.5752  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3742 (0.7291)  acc1: 100.0000 (66.6667)  time: 0.0075  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9521 s / it)
* Acc@1 66.667 loss 0.729 auroc 0.848 f1_score 0.352
Test  [  0/200]  eta: 0:01:55  loss: 1.6117 (1.6117)  acc1: 0.0000 (0.0000)  time: 0.5752  data: 0.5668  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2762 (0.7296)  acc1: 100.0000 (63.3663)  time: 0.0081  data: 0.0014  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3220 (0.6929)  acc1: 100.0000 (73.5000)  time: 0.0095  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.2544 s / it)
* Acc@1 73.500 loss 0.693 auroc 0.823 f1_score 0.490


Epoch: [20]  [  0/269]  eta: 0:02:34  lr: 0.000075  bag_loss: 0.1569 (0.1569)  instance_loss: 1.6325 (1.6325)  time: 0.5747  data: 0.5598  max mem: 337
Epoch: [20]  [100/269]  eta: 0:00:03  lr: 0.000074  bag_loss: 0.2992 (0.5331)  instance_loss: 1.4682 (1.3791)  time: 0.0125  data: 0.0012  max mem: 337
Epoch: [20]  [200/269]  eta: 0:00:01  lr: 0.000073  bag_loss: 0.1689 (0.5433)  instance_loss: 1.2433 (1.3442)  time: 0.0122  data: 0.0010  max mem: 337
Epoch: [20]  [268/269]  eta: 0:00:00  lr: 0.000072  bag_loss: 0.1872 (0.5899)  instance_loss: 1.3196 (1.3483)  time: 0.0157  data: 0.0013  max mem: 337
Epoch: [20] Total time: 0:00:04 (4.5079 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2367 (0.2367)  acc1: 100.0000 (100.0000)  time: 0.5799  data: 0.5708  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1926 (0.8111)  acc1: 100.0000 (70.0000)  time: 0.0081  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9792 s / it)
* Acc@1 70.000 loss 0.811 auroc 0.809 f1_score 0.359
Test  [  0/200]  eta: 0:02:01  loss: 2.1975 (2.1975)  acc1: 0.0000 (0.0000)  time: 0.6062  data: 0.5972  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1622 (0.7419)  acc1: 100.0000 (69.3069)  time: 0.0065  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1687 (0.6656)  acc1: 100.0000 (75.0000)  time: 0.0095  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2544 s / it)
* Acc@1 75.000 loss 0.666 auroc 0.813 f1_score 0.441


Epoch: [21]  [  0/269]  eta: 0:02:37  lr: 0.000072  bag_loss: 0.3148 (0.3148)  instance_loss: 1.3470 (1.3470)  time: 0.5866  data: 0.5704  max mem: 337
Epoch: [21]  [100/269]  eta: 0:00:03  lr: 0.000071  bag_loss: 0.0796 (0.5833)  instance_loss: 1.6120 (1.3916)  time: 0.0150  data: 0.0011  max mem: 337
Epoch: [21]  [200/269]  eta: 0:00:01  lr: 0.000070  bag_loss: 0.3093 (0.5873)  instance_loss: 1.1707 (1.3676)  time: 0.0140  data: 0.0012  max mem: 337
Epoch: [21]  [268/269]  eta: 0:00:00  lr: 0.000069  bag_loss: 0.0901 (0.5927)  instance_loss: 1.4078 (1.3562)  time: 0.0160  data: 0.0012  max mem: 337
Epoch: [21] Total time: 0:00:04 (4.4768 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.1277 (0.1277)  acc1: 100.0000 (100.0000)  time: 0.5668  data: 0.5597  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1810 (0.8055)  acc1: 100.0000 (70.0000)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9262 s / it)
* Acc@1 70.000 loss 0.806 auroc 0.831 f1_score 0.371
Test  [  0/200]  eta: 0:01:56  loss: 1.7877 (1.7877)  acc1: 0.0000 (0.0000)  time: 0.5803  data: 0.5721  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1315 (0.7796)  acc1: 100.0000 (75.2475)  time: 0.0071  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2141 (0.7106)  acc1: 100.0000 (77.0000)  time: 0.0093  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2489 s / it)
* Acc@1 77.000 loss 0.711 auroc 0.779 f1_score 0.421


Epoch: [22]  [  0/269]  eta: 0:02:42  lr: 0.000069  bag_loss: 3.6474 (3.6474)  instance_loss: 1.4856 (1.4856)  time: 0.6029  data: 0.5887  max mem: 337
Epoch: [22]  [100/269]  eta: 0:00:03  lr: 0.000068  bag_loss: 0.2981 (0.6070)  instance_loss: 1.1219 (1.3238)  time: 0.0132  data: 0.0010  max mem: 337
Epoch: [22]  [200/269]  eta: 0:00:01  lr: 0.000066  bag_loss: 0.1153 (0.5491)  instance_loss: 1.1854 (1.3464)  time: 0.0137  data: 0.0012  max mem: 337
Epoch: [22]  [268/269]  eta: 0:00:00  lr: 0.000065  bag_loss: 0.3808 (0.5834)  instance_loss: 1.3110 (1.3415)  time: 0.0131  data: 0.0012  max mem: 337
Epoch: [22] Total time: 0:00:04 (4.4587 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3252 (0.3252)  acc1: 100.0000 (100.0000)  time: 0.5870  data: 0.5796  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4955 (0.7906)  acc1: 100.0000 (70.0000)  time: 0.0081  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9561 s / it)
* Acc@1 70.000 loss 0.791 auroc 0.837 f1_score 0.359
Test  [  0/200]  eta: 0:01:53  loss: 1.3627 (1.3627)  acc1: 0.0000 (0.0000)  time: 0.5666  data: 0.5561  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3258 (0.7101)  acc1: 100.0000 (67.3267)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3703 (0.6829)  acc1: 100.0000 (76.0000)  time: 0.0096  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1845 s / it)
* Acc@1 76.000 loss 0.683 auroc 0.815 f1_score 0.512


Epoch: [23]  [  0/269]  eta: 0:02:34  lr: 0.000065  bag_loss: 0.2643 (0.2643)  instance_loss: 1.0862 (1.0862)  time: 0.5757  data: 0.5575  max mem: 337
Epoch: [23]  [100/269]  eta: 0:00:03  lr: 0.000064  bag_loss: 0.1799 (0.4972)  instance_loss: 1.2042 (1.3000)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [23]  [200/269]  eta: 0:00:01  lr: 0.000063  bag_loss: 0.3532 (0.5510)  instance_loss: 1.3202 (1.2828)  time: 0.0145  data: 0.0013  max mem: 337
Epoch: [23]  [268/269]  eta: 0:00:00  lr: 0.000062  bag_loss: 0.2115 (0.5674)  instance_loss: 1.1523 (1.2799)  time: 0.0134  data: 0.0012  max mem: 337
Epoch: [23] Total time: 0:00:04 (4.5693 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2402 (0.2402)  acc1: 100.0000 (100.0000)  time: 0.5655  data: 0.5573  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2033 (0.6860)  acc1: 100.0000 (70.0000)  time: 0.0072  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9193 s / it)
* Acc@1 70.000 loss 0.686 auroc 0.887 f1_score 0.359
Test  [  0/200]  eta: 0:01:52  loss: 1.8220 (1.8220)  acc1: 0.0000 (0.0000)  time: 0.5640  data: 0.5489  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1805 (0.6600)  acc1: 100.0000 (74.2574)  time: 0.0062  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2015 (0.6100)  acc1: 100.0000 (79.5000)  time: 0.0086  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1526 s / it)
* Acc@1 79.500 loss 0.610 auroc 0.839 f1_score 0.513


Epoch: [24]  [  0/269]  eta: 0:02:34  lr: 0.000062  bag_loss: 0.2862 (0.2862)  instance_loss: 0.9094 (0.9094)  time: 0.5760  data: 0.5648  max mem: 337
Epoch: [24]  [100/269]  eta: 0:00:03  lr: 0.000061  bag_loss: 0.2664 (0.5320)  instance_loss: 1.3568 (1.3289)  time: 0.0168  data: 0.0014  max mem: 337
Epoch: [24]  [200/269]  eta: 0:00:01  lr: 0.000060  bag_loss: 0.3265 (0.5779)  instance_loss: 1.1008 (1.2836)  time: 0.0122  data: 0.0011  max mem: 337
Epoch: [24]  [268/269]  eta: 0:00:00  lr: 0.000059  bag_loss: 0.1881 (0.5561)  instance_loss: 1.2419 (1.2768)  time: 0.0130  data: 0.0011  max mem: 337
Epoch: [24] Total time: 0:00:04 (4.4986 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.1533 (0.1533)  acc1: 100.0000 (100.0000)  time: 0.5703  data: 0.5616  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1210 (0.7566)  acc1: 100.0000 (70.0000)  time: 0.0081  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9657 s / it)
* Acc@1 70.000 loss 0.757 auroc 0.856 f1_score 0.359
Test  [  0/200]  eta: 0:01:52  loss: 2.4235 (2.4235)  acc1: 0.0000 (0.0000)  time: 0.5628  data: 0.5519  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.0952 (0.6648)  acc1: 100.0000 (78.2178)  time: 0.0066  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1265 (0.6155)  acc1: 100.0000 (81.5000)  time: 0.0094  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1935 s / it)
* Acc@1 81.500 loss 0.616 auroc 0.842 f1_score 0.496


Epoch: [25]  [  0/269]  eta: 0:02:33  lr: 0.000059  bag_loss: 2.0700 (2.0700)  instance_loss: 1.4772 (1.4772)  time: 0.5703  data: 0.5543  max mem: 337
Epoch: [25]  [100/269]  eta: 0:00:03  lr: 0.000057  bag_loss: 0.1901 (0.5252)  instance_loss: 1.2947 (1.3356)  time: 0.0123  data: 0.0010  max mem: 337
Epoch: [25]  [200/269]  eta: 0:00:01  lr: 0.000056  bag_loss: 0.2203 (0.4852)  instance_loss: 1.1188 (1.3391)  time: 0.0130  data: 0.0011  max mem: 337
Epoch: [25]  [268/269]  eta: 0:00:00  lr: 0.000055  bag_loss: 0.4609 (0.5530)  instance_loss: 1.1288 (1.3164)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [25] Total time: 0:00:04 (4.3406 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3155 (0.3155)  acc1: 100.0000 (100.0000)  time: 0.5700  data: 0.5629  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3519 (0.6807)  acc1: 100.0000 (70.0000)  time: 0.0075  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9356 s / it)
* Acc@1 70.000 loss 0.681 auroc 0.872 f1_score 0.359
Test  [  0/200]  eta: 0:01:55  loss: 1.1348 (1.1348)  acc1: 0.0000 (0.0000)  time: 0.5758  data: 0.5680  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3003 (0.6880)  acc1: 100.0000 (68.3168)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3156 (0.6876)  acc1: 100.0000 (75.5000)  time: 0.0094  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1768 s / it)
* Acc@1 75.500 loss 0.688 auroc 0.826 f1_score 0.548


Epoch: [26]  [  0/269]  eta: 0:02:36  lr: 0.000055  bag_loss: 0.4749 (0.4749)  instance_loss: 0.7880 (0.7880)  time: 0.5800  data: 0.5580  max mem: 337
Epoch: [26]  [100/269]  eta: 0:00:03  lr: 0.000054  bag_loss: 0.2389 (0.5664)  instance_loss: 1.0948 (1.2889)  time: 0.0140  data: 0.0010  max mem: 337
Epoch: [26]  [200/269]  eta: 0:00:01  lr: 0.000053  bag_loss: 0.3032 (0.5550)  instance_loss: 1.2369 (1.3245)  time: 0.0120  data: 0.0010  max mem: 337
Epoch: [26]  [268/269]  eta: 0:00:00  lr: 0.000052  bag_loss: 0.2720 (0.5427)  instance_loss: 1.0958 (1.3242)  time: 0.0138  data: 0.0010  max mem: 337
Epoch: [26] Total time: 0:00:04 (4.4900 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2337 (0.2337)  acc1: 100.0000 (100.0000)  time: 0.5822  data: 0.5745  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2551 (0.6923)  acc1: 100.0000 (70.0000)  time: 0.0078  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9559 s / it)
* Acc@1 70.000 loss 0.692 auroc 0.869 f1_score 0.359
Test  [  0/200]  eta: 0:01:56  loss: 1.1196 (1.1196)  acc1: 0.0000 (0.0000)  time: 0.5822  data: 0.5719  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2339 (0.7154)  acc1: 100.0000 (69.3069)  time: 0.0068  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2631 (0.7022)  acc1: 100.0000 (74.5000)  time: 0.0097  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2639 s / it)
* Acc@1 74.500 loss 0.702 auroc 0.803 f1_score 0.509


Epoch: [27]  [  0/269]  eta: 0:02:35  lr: 0.000052  bag_loss: 0.1109 (0.1109)  instance_loss: 1.7060 (1.7060)  time: 0.5766  data: 0.5638  max mem: 337
Epoch: [27]  [100/269]  eta: 0:00:03  lr: 0.000050  bag_loss: 0.1126 (0.5053)  instance_loss: 1.1019 (1.2784)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [27]  [200/269]  eta: 0:00:01  lr: 0.000049  bag_loss: 0.2462 (0.5037)  instance_loss: 1.2816 (1.2946)  time: 0.0136  data: 0.0012  max mem: 337
Epoch: [27]  [268/269]  eta: 0:00:00  lr: 0.000048  bag_loss: 0.3028 (0.5176)  instance_loss: 1.2355 (1.2929)  time: 0.0139  data: 0.0013  max mem: 337
Epoch: [27] Total time: 0:00:04 (4.4607 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2156 (0.2156)  acc1: 100.0000 (100.0000)  time: 0.5815  data: 0.5739  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2377 (0.7003)  acc1: 100.0000 (70.0000)  time: 0.0081  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9603 s / it)
* Acc@1 70.000 loss 0.700 auroc 0.872 f1_score 0.359
Test  [  0/200]  eta: 0:01:56  loss: 1.1568 (1.1568)  acc1: 0.0000 (0.0000)  time: 0.5804  data: 0.5729  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2784 (0.7576)  acc1: 100.0000 (60.3960)  time: 0.0069  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2907 (0.7366)  acc1: 100.0000 (69.5000)  time: 0.0087  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.2005 s / it)
* Acc@1 69.500 loss 0.737 auroc 0.800 f1_score 0.465


Epoch: [28]  [  0/269]  eta: 0:02:37  lr: 0.000048  bag_loss: 2.4959 (2.4959)  instance_loss: 1.5277 (1.5277)  time: 0.5844  data: 0.5696  max mem: 337
Epoch: [28]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.1449 (0.4601)  instance_loss: 1.1394 (1.3766)  time: 0.0130  data: 0.0011  max mem: 337
Epoch: [28]  [200/269]  eta: 0:00:01  lr: 0.000046  bag_loss: 0.3614 (0.5029)  instance_loss: 1.3236 (1.3534)  time: 0.0147  data: 0.0011  max mem: 337
Epoch: [28]  [268/269]  eta: 0:00:00  lr: 0.000045  bag_loss: 0.1655 (0.5190)  instance_loss: 1.3197 (1.3550)  time: 0.0143  data: 0.0013  max mem: 337
Epoch: [28] Total time: 0:00:04 (4.5173 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2546 (0.2546)  acc1: 100.0000 (100.0000)  time: 0.5760  data: 0.5687  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1847 (0.6764)  acc1: 100.0000 (70.0000)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9453 s / it)
* Acc@1 70.000 loss 0.676 auroc 0.881 f1_score 0.359
Test  [  0/200]  eta: 0:01:52  loss: 1.6503 (1.6503)  acc1: 0.0000 (0.0000)  time: 0.5624  data: 0.5542  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2058 (0.6769)  acc1: 100.0000 (70.2970)  time: 0.0074  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2363 (0.6465)  acc1: 100.0000 (77.0000)  time: 0.0090  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2129 s / it)
* Acc@1 77.000 loss 0.647 auroc 0.826 f1_score 0.533


Epoch: [29]  [  0/269]  eta: 0:02:35  lr: 0.000045  bag_loss: 0.0903 (0.0903)  instance_loss: 1.1903 (1.1903)  time: 0.5783  data: 0.5661  max mem: 337
Epoch: [29]  [100/269]  eta: 0:00:03  lr: 0.000043  bag_loss: 0.1768 (0.5437)  instance_loss: 1.0867 (1.3088)  time: 0.0111  data: 0.0010  max mem: 337
Epoch: [29]  [200/269]  eta: 0:00:01  lr: 0.000042  bag_loss: 0.1611 (0.5647)  instance_loss: 1.1126 (1.3154)  time: 0.0125  data: 0.0010  max mem: 337
Epoch: [29]  [268/269]  eta: 0:00:00  lr: 0.000041  bag_loss: 0.1317 (0.5287)  instance_loss: 1.2120 (1.3148)  time: 0.0133  data: 0.0011  max mem: 337
Epoch: [29] Total time: 0:00:04 (4.4541 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2014 (0.2014)  acc1: 100.0000 (100.0000)  time: 0.5694  data: 0.5612  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1934 (0.6660)  acc1: 100.0000 (70.0000)  time: 0.0077  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9410 s / it)
* Acc@1 70.000 loss 0.666 auroc 0.883 f1_score 0.359
Test  [  0/200]  eta: 0:01:45  loss: 1.5459 (1.5459)  acc1: 0.0000 (0.0000)  time: 0.5298  data: 0.5232  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1349 (0.6559)  acc1: 100.0000 (78.2178)  time: 0.0062  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1635 (0.6342)  acc1: 100.0000 (80.5000)  time: 0.0094  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1073 s / it)
* Acc@1 80.500 loss 0.634 auroc 0.828 f1_score 0.530


Epoch: [30]  [  0/269]  eta: 0:02:34  lr: 0.000041  bag_loss: 0.2525 (0.2525)  instance_loss: 1.1670 (1.1670)  time: 0.5749  data: 0.5582  max mem: 337
Epoch: [30]  [100/269]  eta: 0:00:03  lr: 0.000040  bag_loss: 0.3898 (0.5330)  instance_loss: 1.3189 (1.3224)  time: 0.0143  data: 0.0012  max mem: 337
Epoch: [30]  [200/269]  eta: 0:00:01  lr: 0.000039  bag_loss: 0.2119 (0.4638)  instance_loss: 1.2314 (1.3119)  time: 0.0155  data: 0.0012  max mem: 337
Epoch: [30]  [268/269]  eta: 0:00:00  lr: 0.000038  bag_loss: 0.1578 (0.4967)  instance_loss: 1.3536 (1.2968)  time: 0.0167  data: 0.0012  max mem: 337
Epoch: [30] Total time: 0:00:04 (4.4412 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2774 (0.2774)  acc1: 100.0000 (100.0000)  time: 0.5672  data: 0.5566  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2776 (0.7316)  acc1: 100.0000 (70.0000)  time: 0.0076  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9320 s / it)
* Acc@1 70.000 loss 0.732 auroc 0.871 f1_score 0.359
Test  [  0/200]  eta: 0:01:54  loss: 2.1417 (2.1417)  acc1: 0.0000 (0.0000)  time: 0.5748  data: 0.5672  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2700 (0.7233)  acc1: 100.0000 (62.3762)  time: 0.0065  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3237 (0.6889)  acc1: 100.0000 (72.0000)  time: 0.0093  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2088 s / it)
* Acc@1 72.000 loss 0.689 auroc 0.814 f1_score 0.521


Epoch: [31]  [  0/269]  eta: 0:02:37  lr: 0.000038  bag_loss: 0.2421 (0.2421)  instance_loss: 1.9754 (1.9754)  time: 0.5842  data: 0.5612  max mem: 337
Epoch: [31]  [100/269]  eta: 0:00:03  lr: 0.000037  bag_loss: 0.3140 (0.5364)  instance_loss: 1.2191 (1.2435)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [31]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.1489 (0.4777)  instance_loss: 1.2936 (1.2543)  time: 0.0121  data: 0.0010  max mem: 337
Epoch: [31]  [268/269]  eta: 0:00:00  lr: 0.000035  bag_loss: 0.2416 (0.4965)  instance_loss: 1.1427 (1.2623)  time: 0.0139  data: 0.0014  max mem: 337
Epoch: [31] Total time: 0:00:04 (4.4427 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2302 (0.2302)  acc1: 100.0000 (100.0000)  time: 0.5601  data: 0.5514  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1983 (0.6450)  acc1: 100.0000 (70.0000)  time: 0.0081  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9416 s / it)
* Acc@1 70.000 loss 0.645 auroc 0.879 f1_score 0.359
Test  [  0/200]  eta: 0:01:58  loss: 1.3610 (1.3610)  acc1: 0.0000 (0.0000)  time: 0.5943  data: 0.5861  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2355 (0.6935)  acc1: 100.0000 (69.3069)  time: 0.0062  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2673 (0.6774)  acc1: 100.0000 (75.5000)  time: 0.0093  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1884 s / it)
* Acc@1 75.500 loss 0.677 auroc 0.817 f1_score 0.536


Epoch: [32]  [  0/269]  eta: 0:02:31  lr: 0.000035  bag_loss: 0.0506 (0.0506)  instance_loss: 1.1255 (1.1255)  time: 0.5623  data: 0.5394  max mem: 337
Epoch: [32]  [100/269]  eta: 0:00:03  lr: 0.000033  bag_loss: 0.0787 (0.4677)  instance_loss: 1.4454 (1.2617)  time: 0.0151  data: 0.0010  max mem: 337
Epoch: [32]  [200/269]  eta: 0:00:01  lr: 0.000032  bag_loss: 0.1576 (0.4576)  instance_loss: 1.1806 (1.2994)  time: 0.0142  data: 0.0012  max mem: 337
Epoch: [32]  [268/269]  eta: 0:00:00  lr: 0.000031  bag_loss: 0.2583 (0.4806)  instance_loss: 1.1114 (1.2932)  time: 0.0150  data: 0.0013  max mem: 337
Epoch: [32] Total time: 0:00:04 (4.4849 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2551 (0.2551)  acc1: 100.0000 (100.0000)  time: 0.5686  data: 0.5595  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2750 (0.6836)  acc1: 100.0000 (70.0000)  time: 0.0076  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9300 s / it)
* Acc@1 70.000 loss 0.684 auroc 0.874 f1_score 0.359
Test  [  0/200]  eta: 0:01:52  loss: 1.3696 (1.3696)  acc1: 0.0000 (0.0000)  time: 0.5636  data: 0.5485  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3027 (0.7406)  acc1: 100.0000 (62.3762)  time: 0.0066  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3886 (0.7392)  acc1: 100.0000 (68.0000)  time: 0.0094  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2211 s / it)
* Acc@1 68.000 loss 0.739 auroc 0.809 f1_score 0.519


Epoch: [33]  [  0/269]  eta: 0:02:39  lr: 0.000031  bag_loss: 1.4994 (1.4994)  instance_loss: 1.2039 (1.2039)  time: 0.5935  data: 0.5787  max mem: 337
Epoch: [33]  [100/269]  eta: 0:00:03  lr: 0.000030  bag_loss: 0.1962 (0.5285)  instance_loss: 1.1529 (1.2982)  time: 0.0148  data: 0.0013  max mem: 337
Epoch: [33]  [200/269]  eta: 0:00:01  lr: 0.000029  bag_loss: 0.2128 (0.4776)  instance_loss: 1.2023 (1.2865)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [33]  [268/269]  eta: 0:00:00  lr: 0.000028  bag_loss: 0.4000 (0.4968)  instance_loss: 1.2225 (1.2901)  time: 0.0130  data: 0.0011  max mem: 337
Epoch: [33] Total time: 0:00:04 (4.4062 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2112 (0.2112)  acc1: 100.0000 (100.0000)  time: 0.5669  data: 0.5551  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1747 (0.6267)  acc1: 100.0000 (70.0000)  time: 0.0075  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9232 s / it)
* Acc@1 70.000 loss 0.627 auroc 0.894 f1_score 0.359
Test  [  0/200]  eta: 0:01:58  loss: 0.9235 (0.9235)  acc1: 0.0000 (0.0000)  time: 0.5911  data: 0.5808  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1823 (0.6921)  acc1: 100.0000 (72.2772)  time: 0.0064  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2653 (0.6818)  acc1: 100.0000 (76.5000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2195 s / it)
* Acc@1 76.500 loss 0.682 auroc 0.817 f1_score 0.521


Epoch: [34]  [  0/269]  eta: 0:02:34  lr: 0.000028  bag_loss: 0.9290 (0.9290)  instance_loss: 1.1614 (1.1614)  time: 0.5748  data: 0.5564  max mem: 337
Epoch: [34]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.1732 (0.4550)  instance_loss: 1.2603 (1.2640)  time: 0.0125  data: 0.0012  max mem: 337
Epoch: [34]  [200/269]  eta: 0:00:01  lr: 0.000026  bag_loss: 0.1226 (0.4552)  instance_loss: 1.1442 (1.2976)  time: 0.0114  data: 0.0010  max mem: 337
Epoch: [34]  [268/269]  eta: 0:00:00  lr: 0.000025  bag_loss: 0.1897 (0.4655)  instance_loss: 1.2433 (1.2968)  time: 0.0149  data: 0.0013  max mem: 337
Epoch: [34] Total time: 0:00:04 (4.4906 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2379 (0.2379)  acc1: 100.0000 (100.0000)  time: 0.5574  data: 0.5507  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1411 (0.6679)  acc1: 100.0000 (70.0000)  time: 0.0080  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9260 s / it)
* Acc@1 70.000 loss 0.668 auroc 0.888 f1_score 0.359
Test  [  0/200]  eta: 0:01:52  loss: 1.2612 (1.2612)  acc1: 0.0000 (0.0000)  time: 0.5638  data: 0.5556  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1689 (0.7182)  acc1: 100.0000 (67.3267)  time: 0.0068  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2309 (0.6819)  acc1: 100.0000 (75.0000)  time: 0.0084  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.1695 s / it)
* Acc@1 75.000 loss 0.682 auroc 0.810 f1_score 0.498


Epoch: [35]  [  0/269]  eta: 0:02:33  lr: 0.000025  bag_loss: 0.1974 (0.1974)  instance_loss: 1.2809 (1.2809)  time: 0.5698  data: 0.5559  max mem: 337
Epoch: [35]  [100/269]  eta: 0:00:03  lr: 0.000024  bag_loss: 0.2353 (0.5309)  instance_loss: 1.3292 (1.3247)  time: 0.0130  data: 0.0010  max mem: 337
Epoch: [35]  [200/269]  eta: 0:00:01  lr: 0.000023  bag_loss: 0.3283 (0.5060)  instance_loss: 1.2430 (1.2938)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [35]  [268/269]  eta: 0:00:00  lr: 0.000022  bag_loss: 0.0790 (0.4748)  instance_loss: 1.3525 (1.3017)  time: 0.0161  data: 0.0013  max mem: 337
Epoch: [35] Total time: 0:00:04 (4.4416 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.1951 (0.1951)  acc1: 100.0000 (100.0000)  time: 0.5654  data: 0.5542  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1515 (0.6712)  acc1: 100.0000 (70.0000)  time: 0.0077  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9620 s / it)
* Acc@1 70.000 loss 0.671 auroc 0.899 f1_score 0.359
Test  [  0/200]  eta: 0:01:51  loss: 1.4548 (1.4548)  acc1: 0.0000 (0.0000)  time: 0.5574  data: 0.5426  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1747 (0.7170)  acc1: 100.0000 (69.3069)  time: 0.0063  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2627 (0.6746)  acc1: 100.0000 (75.5000)  time: 0.0094  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1631 s / it)
* Acc@1 75.500 loss 0.675 auroc 0.809 f1_score 0.536


Epoch: [36]  [  0/269]  eta: 0:02:33  lr: 0.000022  bag_loss: 0.0998 (0.0998)  instance_loss: 1.4061 (1.4061)  time: 0.5703  data: 0.5503  max mem: 337
Epoch: [36]  [100/269]  eta: 0:00:03  lr: 0.000021  bag_loss: 0.3585 (0.4956)  instance_loss: 1.3816 (1.3296)  time: 0.0151  data: 0.0011  max mem: 337
Epoch: [36]  [200/269]  eta: 0:00:01  lr: 0.000020  bag_loss: 0.1148 (0.4314)  instance_loss: 1.1406 (1.3198)  time: 0.0123  data: 0.0011  max mem: 337
Epoch: [36]  [268/269]  eta: 0:00:00  lr: 0.000019  bag_loss: 0.5581 (0.4592)  instance_loss: 1.1386 (1.3080)  time: 0.0148  data: 0.0011  max mem: 337
Epoch: [36] Total time: 0:00:04 (4.3856 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2295 (0.2295)  acc1: 100.0000 (100.0000)  time: 0.5741  data: 0.5656  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1596 (0.7305)  acc1: 100.0000 (70.0000)  time: 0.0073  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9372 s / it)
* Acc@1 70.000 loss 0.731 auroc 0.876 f1_score 0.359
Test  [  0/200]  eta: 0:01:52  loss: 2.0108 (2.0108)  acc1: 0.0000 (0.0000)  time: 0.5608  data: 0.5516  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1761 (0.7698)  acc1: 100.0000 (65.3465)  time: 0.0065  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2643 (0.6981)  acc1: 100.0000 (74.0000)  time: 0.0098  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1712 s / it)
* Acc@1 74.000 loss 0.698 auroc 0.800 f1_score 0.493


Epoch: [37]  [  0/269]  eta: 0:02:38  lr: 0.000019  bag_loss: 0.0465 (0.0465)  instance_loss: 1.5677 (1.5677)  time: 0.5875  data: 0.5601  max mem: 337
Epoch: [37]  [100/269]  eta: 0:00:03  lr: 0.000018  bag_loss: 0.2408 (0.4020)  instance_loss: 1.2103 (1.3043)  time: 0.0144  data: 0.0013  max mem: 337
Epoch: [37]  [200/269]  eta: 0:00:01  lr: 0.000017  bag_loss: 0.2833 (0.4321)  instance_loss: 1.0965 (1.2904)  time: 0.0151  data: 0.0012  max mem: 337
Epoch: [37]  [268/269]  eta: 0:00:00  lr: 0.000017  bag_loss: 0.2270 (0.4430)  instance_loss: 1.1395 (1.2875)  time: 0.0139  data: 0.0013  max mem: 337
Epoch: [37] Total time: 0:00:04 (4.5426 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2222 (0.2222)  acc1: 100.0000 (100.0000)  time: 0.5683  data: 0.5559  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1441 (0.6801)  acc1: 100.0000 (70.0000)  time: 0.0081  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9519 s / it)
* Acc@1 70.000 loss 0.680 auroc 0.895 f1_score 0.359
Test  [  0/200]  eta: 0:01:51  loss: 1.6278 (1.6278)  acc1: 0.0000 (0.0000)  time: 0.5598  data: 0.5511  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1823 (0.7037)  acc1: 100.0000 (72.2772)  time: 0.0066  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2539 (0.6577)  acc1: 100.0000 (77.5000)  time: 0.0089  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1666 s / it)
* Acc@1 77.500 loss 0.658 auroc 0.813 f1_score 0.536


Epoch: [38]  [  0/269]  eta: 0:02:30  lr: 0.000017  bag_loss: 2.4305 (2.4305)  instance_loss: 1.0473 (1.0473)  time: 0.5579  data: 0.5419  max mem: 337
Epoch: [38]  [100/269]  eta: 0:00:03  lr: 0.000016  bag_loss: 0.2256 (0.4967)  instance_loss: 1.3491 (1.2918)  time: 0.0158  data: 0.0012  max mem: 337
Epoch: [38]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.2418 (0.4385)  instance_loss: 1.3906 (1.3157)  time: 0.0134  data: 0.0012  max mem: 337
Epoch: [38]  [268/269]  eta: 0:00:00  lr: 0.000014  bag_loss: 0.0890 (0.4527)  instance_loss: 1.3371 (1.3265)  time: 0.0147  data: 0.0013  max mem: 337
Epoch: [38] Total time: 0:00:04 (4.3950 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2162 (0.2162)  acc1: 100.0000 (100.0000)  time: 0.5518  data: 0.5441  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1463 (0.6807)  acc1: 100.0000 (70.0000)  time: 0.0076  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9111 s / it)
* Acc@1 70.000 loss 0.681 auroc 0.894 f1_score 0.359
Test  [  0/200]  eta: 0:01:50  loss: 1.5378 (1.5378)  acc1: 0.0000 (0.0000)  time: 0.5508  data: 0.5407  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1735 (0.7076)  acc1: 100.0000 (72.2772)  time: 0.0064  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2378 (0.6569)  acc1: 100.0000 (77.5000)  time: 0.0086  data: 0.0009  max mem: 337
Test Total time: 0:00:02 (2.1608 s / it)
* Acc@1 77.500 loss 0.657 auroc 0.813 f1_score 0.536


Epoch: [39]  [  0/269]  eta: 0:02:34  lr: 0.000014  bag_loss: 0.3696 (0.3696)  instance_loss: 0.9290 (0.9290)  time: 0.5737  data: 0.5474  max mem: 337
Epoch: [39]  [100/269]  eta: 0:00:03  lr: 0.000013  bag_loss: 0.1368 (0.3975)  instance_loss: 1.3140 (1.3431)  time: 0.0168  data: 0.0011  max mem: 337
Epoch: [39]  [200/269]  eta: 0:00:01  lr: 0.000012  bag_loss: 0.2907 (0.4574)  instance_loss: 1.2019 (1.3268)  time: 0.0140  data: 0.0012  max mem: 337
Epoch: [39]  [268/269]  eta: 0:00:00  lr: 0.000012  bag_loss: 0.1381 (0.4522)  instance_loss: 1.1244 (1.3211)  time: 0.0115  data: 0.0009  max mem: 337
Epoch: [39] Total time: 0:00:04 (4.4585 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2145 (0.2145)  acc1: 100.0000 (100.0000)  time: 0.5781  data: 0.5703  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1702 (0.7037)  acc1: 100.0000 (73.3333)  time: 0.0072  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9320 s / it)
* Acc@1 73.333 loss 0.704 auroc 0.886 f1_score 0.448
Test  [  0/200]  eta: 0:02:21  loss: 1.6634 (1.6634)  acc1: 0.0000 (0.0000)  time: 0.7077  data: 0.6940  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2080 (0.7164)  acc1: 100.0000 (71.2871)  time: 0.0064  data: 0.0008  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2638 (0.6615)  acc1: 100.0000 (77.5000)  time: 0.0090  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.7408 s / it)
* Acc@1 77.500 loss 0.662 auroc 0.812 f1_score 0.551


Epoch: [40]  [  0/269]  eta: 0:02:34  lr: 0.000012  bag_loss: 0.2259 (0.2259)  instance_loss: 1.2277 (1.2277)  time: 0.5758  data: 0.5608  max mem: 337
Epoch: [40]  [100/269]  eta: 0:00:03  lr: 0.000011  bag_loss: 0.2141 (0.4386)  instance_loss: 1.3858 (1.3415)  time: 0.0140  data: 0.0012  max mem: 337
Epoch: [40]  [200/269]  eta: 0:00:01  lr: 0.000010  bag_loss: 0.2437 (0.4779)  instance_loss: 1.0707 (1.3349)  time: 0.0144  data: 0.0012  max mem: 337
Epoch: [40]  [268/269]  eta: 0:00:00  lr: 0.000010  bag_loss: 0.1144 (0.4487)  instance_loss: 1.3480 (1.3208)  time: 0.0137  data: 0.0011  max mem: 337
Epoch: [40] Total time: 0:00:04 (4.4874 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2160 (0.2160)  acc1: 100.0000 (100.0000)  time: 0.5896  data: 0.5828  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1707 (0.6690)  acc1: 100.0000 (70.0000)  time: 0.0077  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9570 s / it)
* Acc@1 70.000 loss 0.669 auroc 0.896 f1_score 0.359
Test  [  0/200]  eta: 0:01:51  loss: 1.1534 (1.1534)  acc1: 0.0000 (0.0000)  time: 0.5600  data: 0.5513  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1789 (0.7575)  acc1: 100.0000 (66.3366)  time: 0.0064  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2728 (0.7058)  acc1: 100.0000 (74.0000)  time: 0.0091  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2032 s / it)
* Acc@1 74.000 loss 0.706 auroc 0.798 f1_score 0.492


Epoch: [41]  [  0/269]  eta: 0:02:37  lr: 0.000010  bag_loss: 0.0240 (0.0240)  instance_loss: 1.4808 (1.4808)  time: 0.5867  data: 0.5681  max mem: 337
Epoch: [41]  [100/269]  eta: 0:00:03  lr: 0.000009  bag_loss: 0.1131 (0.3874)  instance_loss: 1.2485 (1.3316)  time: 0.0147  data: 0.0011  max mem: 337
Epoch: [41]  [200/269]  eta: 0:00:01  lr: 0.000008  bag_loss: 0.1543 (0.4533)  instance_loss: 1.3143 (1.3113)  time: 0.0161  data: 0.0012  max mem: 337
Epoch: [41]  [268/269]  eta: 0:00:00  lr: 0.000008  bag_loss: 0.1819 (0.4327)  instance_loss: 1.2231 (1.2925)  time: 0.0111  data: 0.0010  max mem: 337
Epoch: [41] Total time: 0:00:04 (4.3979 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2150 (0.2150)  acc1: 100.0000 (100.0000)  time: 0.5634  data: 0.5556  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1639 (0.6902)  acc1: 100.0000 (70.0000)  time: 0.0071  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9123 s / it)
* Acc@1 70.000 loss 0.690 auroc 0.894 f1_score 0.359
Test  [  0/200]  eta: 0:01:56  loss: 1.4264 (1.4264)  acc1: 0.0000 (0.0000)  time: 0.5844  data: 0.5745  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1815 (0.7372)  acc1: 100.0000 (67.3267)  time: 0.0072  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2682 (0.6815)  acc1: 100.0000 (74.5000)  time: 0.0081  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1747 s / it)
* Acc@1 74.500 loss 0.681 auroc 0.805 f1_score 0.494


Epoch: [42]  [  0/269]  eta: 0:02:35  lr: 0.000008  bag_loss: 0.0145 (0.0145)  instance_loss: 1.6528 (1.6528)  time: 0.5781  data: 0.5598  max mem: 337
Epoch: [42]  [100/269]  eta: 0:00:03  lr: 0.000007  bag_loss: 0.1085 (0.3965)  instance_loss: 1.3544 (1.3015)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [42]  [200/269]  eta: 0:00:01  lr: 0.000006  bag_loss: 0.1498 (0.4331)  instance_loss: 1.2766 (1.2965)  time: 0.0120  data: 0.0010  max mem: 337
Epoch: [42]  [268/269]  eta: 0:00:00  lr: 0.000006  bag_loss: 0.1600 (0.4357)  instance_loss: 1.2259 (1.2997)  time: 0.0137  data: 0.0010  max mem: 337
Epoch: [42] Total time: 0:00:04 (4.4060 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2147 (0.2147)  acc1: 100.0000 (100.0000)  time: 0.5659  data: 0.5572  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1505 (0.6882)  acc1: 100.0000 (70.0000)  time: 0.0072  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9155 s / it)
* Acc@1 70.000 loss 0.688 auroc 0.897 f1_score 0.359
Test  [  0/200]  eta: 0:01:53  loss: 1.4663 (1.4663)  acc1: 0.0000 (0.0000)  time: 0.5698  data: 0.5621  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1821 (0.7329)  acc1: 100.0000 (67.3267)  time: 0.0067  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2610 (0.6746)  acc1: 100.0000 (75.0000)  time: 0.0089  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1742 s / it)
* Acc@1 75.000 loss 0.675 auroc 0.807 f1_score 0.499


Epoch: [43]  [  0/269]  eta: 0:02:31  lr: 0.000006  bag_loss: 0.2501 (0.2501)  instance_loss: 0.7337 (0.7337)  time: 0.5630  data: 0.5481  max mem: 337
Epoch: [43]  [100/269]  eta: 0:00:03  lr: 0.000005  bag_loss: 0.3006 (0.5222)  instance_loss: 1.1682 (1.3155)  time: 0.0142  data: 0.0010  max mem: 337
Epoch: [43]  [200/269]  eta: 0:00:01  lr: 0.000005  bag_loss: 0.1459 (0.4630)  instance_loss: 1.2943 (1.3003)  time: 0.0161  data: 0.0013  max mem: 337
Epoch: [43]  [268/269]  eta: 0:00:00  lr: 0.000004  bag_loss: 0.1435 (0.4385)  instance_loss: 1.3663 (1.3125)  time: 0.0130  data: 0.0011  max mem: 337
Epoch: [43] Total time: 0:00:04 (4.4538 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2045 (0.2045)  acc1: 100.0000 (100.0000)  time: 0.5783  data: 0.5704  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1483 (0.6852)  acc1: 100.0000 (70.0000)  time: 0.0071  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9359 s / it)
* Acc@1 70.000 loss 0.685 auroc 0.899 f1_score 0.359
Test  [  0/200]  eta: 0:01:56  loss: 1.4436 (1.4436)  acc1: 0.0000 (0.0000)  time: 0.5814  data: 0.5713  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1949 (0.7237)  acc1: 100.0000 (70.2970)  time: 0.0063  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2606 (0.6708)  acc1: 100.0000 (76.5000)  time: 0.0097  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2233 s / it)
* Acc@1 76.500 loss 0.671 auroc 0.809 f1_score 0.542


Epoch: [44]  [  0/269]  eta: 0:02:29  lr: 0.000004  bag_loss: 0.1517 (0.1517)  instance_loss: 1.0493 (1.0493)  time: 0.5548  data: 0.5408  max mem: 337
Epoch: [44]  [100/269]  eta: 0:00:03  lr: 0.000004  bag_loss: 0.1573 (0.4502)  instance_loss: 1.1765 (1.3210)  time: 0.0119  data: 0.0010  max mem: 337
Epoch: [44]  [200/269]  eta: 0:00:01  lr: 0.000003  bag_loss: 0.1600 (0.4118)  instance_loss: 1.3105 (1.3417)  time: 0.0129  data: 0.0010  max mem: 337
Epoch: [44]  [268/269]  eta: 0:00:00  lr: 0.000003  bag_loss: 0.2171 (0.4257)  instance_loss: 1.1182 (1.3261)  time: 0.0159  data: 0.0013  max mem: 337
Epoch: [44] Total time: 0:00:04 (4.3745 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2061 (0.2061)  acc1: 100.0000 (100.0000)  time: 0.5649  data: 0.5571  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1469 (0.6830)  acc1: 100.0000 (73.3333)  time: 0.0078  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9350 s / it)
* Acc@1 73.333 loss 0.683 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:50  loss: 1.4532 (1.4532)  acc1: 0.0000 (0.0000)  time: 0.5546  data: 0.5440  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1996 (0.7187)  acc1: 100.0000 (71.2871)  time: 0.0059  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2608 (0.6674)  acc1: 100.0000 (77.0000)  time: 0.0092  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2091 s / it)
* Acc@1 77.000 loss 0.667 auroc 0.811 f1_score 0.545


Epoch: [45]  [  0/269]  eta: 0:02:33  lr: 0.000003  bag_loss: 0.2656 (0.2656)  instance_loss: 1.3134 (1.3134)  time: 0.5698  data: 0.5582  max mem: 337
Epoch: [45]  [100/269]  eta: 0:00:03  lr: 0.000003  bag_loss: 0.1488 (0.3767)  instance_loss: 1.2380 (1.2633)  time: 0.0149  data: 0.0012  max mem: 337
Epoch: [45]  [200/269]  eta: 0:00:01  lr: 0.000002  bag_loss: 0.1509 (0.4424)  instance_loss: 1.2588 (1.2933)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [45]  [268/269]  eta: 0:00:00  lr: 0.000002  bag_loss: 0.0975 (0.4125)  instance_loss: 1.3224 (1.3105)  time: 0.0147  data: 0.0012  max mem: 337
Epoch: [45] Total time: 0:00:04 (4.4171 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2090 (0.2090)  acc1: 100.0000 (100.0000)  time: 0.5533  data: 0.5378  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1523 (0.6842)  acc1: 100.0000 (73.3333)  time: 0.0078  data: 0.0007  max mem: 337
Val Total time: 0:00:02 (2.4367 s / it)
* Acc@1 73.333 loss 0.684 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:58  loss: 1.4715 (1.4715)  acc1: 0.0000 (0.0000)  time: 0.5944  data: 0.5862  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2078 (0.7219)  acc1: 100.0000 (69.3069)  time: 0.0062  data: 0.0008  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2691 (0.6715)  acc1: 100.0000 (75.5000)  time: 0.0091  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2316 s / it)
* Acc@1 75.500 loss 0.671 auroc 0.810 f1_score 0.536


Epoch: [46]  [  0/269]  eta: 0:02:34  lr: 0.000002  bag_loss: 0.0517 (0.0517)  instance_loss: 1.0823 (1.0823)  time: 0.5725  data: 0.5603  max mem: 337
Epoch: [46]  [100/269]  eta: 0:00:03  lr: 0.000002  bag_loss: 0.1355 (0.4732)  instance_loss: 1.1982 (1.2493)  time: 0.0169  data: 0.0013  max mem: 337
Epoch: [46]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.2359 (0.4457)  instance_loss: 1.2912 (1.2964)  time: 0.0115  data: 0.0011  max mem: 337
Epoch: [46]  [268/269]  eta: 0:00:00  lr: 0.000001  bag_loss: 0.1110 (0.4303)  instance_loss: 1.2705 (1.3139)  time: 0.0168  data: 0.0012  max mem: 337
Epoch: [46] Total time: 0:00:04 (4.4688 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2062 (0.2062)  acc1: 100.0000 (100.0000)  time: 0.5623  data: 0.5535  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1489 (0.6826)  acc1: 100.0000 (73.3333)  time: 0.0071  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9330 s / it)
* Acc@1 73.333 loss 0.683 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:52  loss: 1.4663 (1.4663)  acc1: 0.0000 (0.0000)  time: 0.5609  data: 0.5530  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2074 (0.7215)  acc1: 100.0000 (69.3069)  time: 0.0064  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2684 (0.6718)  acc1: 100.0000 (75.5000)  time: 0.0089  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.1948 s / it)
* Acc@1 75.500 loss 0.672 auroc 0.810 f1_score 0.536


Epoch: [47]  [  0/269]  eta: 0:02:32  lr: 0.000001  bag_loss: 1.7941 (1.7941)  instance_loss: 1.3075 (1.3075)  time: 0.5687  data: 0.5516  max mem: 337
Epoch: [47]  [100/269]  eta: 0:00:03  lr: 0.000001  bag_loss: 0.2190 (0.3861)  instance_loss: 1.4091 (1.3486)  time: 0.0160  data: 0.0012  max mem: 337
Epoch: [47]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.0893 (0.4483)  instance_loss: 1.3301 (1.3083)  time: 0.0170  data: 0.0012  max mem: 337
Epoch: [47]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1122 (0.4155)  instance_loss: 1.2300 (1.3144)  time: 0.0147  data: 0.0015  max mem: 337
Epoch: [47] Total time: 0:00:04 (4.4849 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2071 (0.2071)  acc1: 100.0000 (100.0000)  time: 0.5858  data: 0.5784  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1492 (0.6845)  acc1: 100.0000 (73.3333)  time: 0.0078  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9500 s / it)
* Acc@1 73.333 loss 0.685 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:51  loss: 1.4944 (1.4944)  acc1: 0.0000 (0.0000)  time: 0.5591  data: 0.5504  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2092 (0.7201)  acc1: 100.0000 (69.3069)  time: 0.0070  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2704 (0.6703)  acc1: 100.0000 (75.5000)  time: 0.0085  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1606 s / it)
* Acc@1 75.500 loss 0.670 auroc 0.811 f1_score 0.535


Epoch: [48]  [  0/269]  eta: 0:02:32  lr: 0.000000  bag_loss: 2.3819 (2.3819)  instance_loss: 1.5253 (1.5253)  time: 0.5679  data: 0.5523  max mem: 337
Epoch: [48]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.2435 (0.5698)  instance_loss: 1.2281 (1.3153)  time: 0.0160  data: 0.0012  max mem: 337
Epoch: [48]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1969 (0.4801)  instance_loss: 1.2377 (1.3094)  time: 0.0155  data: 0.0012  max mem: 337
Epoch: [48]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1518 (0.4346)  instance_loss: 1.3294 (1.3219)  time: 0.0143  data: 0.0014  max mem: 337
Epoch: [48] Total time: 0:00:04 (4.4690 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2082 (0.2082)  acc1: 100.0000 (100.0000)  time: 0.5589  data: 0.5517  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1510 (0.6848)  acc1: 100.0000 (73.3333)  time: 0.0072  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9168 s / it)
* Acc@1 73.333 loss 0.685 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:54  loss: 1.4993 (1.4993)  acc1: 0.0000 (0.0000)  time: 0.5703  data: 0.5612  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2114 (0.7201)  acc1: 100.0000 (68.3168)  time: 0.0067  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2727 (0.6708)  acc1: 100.0000 (75.0000)  time: 0.0095  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1937 s / it)
* Acc@1 75.000 loss 0.671 auroc 0.811 f1_score 0.532


Epoch: [49]  [  0/269]  eta: 0:02:33  lr: 0.000000  bag_loss: 0.0196 (0.0196)  instance_loss: 1.9728 (1.9728)  time: 0.5723  data: 0.5565  max mem: 337
Epoch: [49]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.1551 (0.4031)  instance_loss: 1.2469 (1.3134)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [49]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1426 (0.4345)  instance_loss: 1.2942 (1.3131)  time: 0.0109  data: 0.0009  max mem: 337
Epoch: [49]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1584 (0.4265)  instance_loss: 1.2583 (1.3098)  time: 0.0152  data: 0.0013  max mem: 337
Epoch: [49] Total time: 0:00:04 (4.4599 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2082 (0.2082)  acc1: 100.0000 (100.0000)  time: 0.5707  data: 0.5628  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1510 (0.6850)  acc1: 100.0000 (73.3333)  time: 0.0075  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9359 s / it)
* Acc@1 73.333 loss 0.685 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:56  loss: 1.5006 (1.5006)  acc1: 0.0000 (0.0000)  time: 0.5833  data: 0.5757  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2114 (0.7202)  acc1: 100.0000 (68.3168)  time: 0.0066  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2727 (0.6709)  acc1: 100.0000 (75.0000)  time: 0.0092  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.1959 s / it)
* Acc@1 75.000 loss 0.671 auroc 0.810 f1_score 0.532


Results on best epoch:
{'epoch': 44, 'val_acc': 73.33333333333333, 'val_auc': 0.8986614346504211, 'val_f1': 0.4476190507411957, 'test_acc': 77.0, 'test_auc': 0.8111384510993958, 'test_f1': 0.5447450876235962}
Wandb run dir: /fs2/comm/kpgrp/yelinfen/Documents/ACMIL/wandb/offline-run-20250807_133334-tab8y0o5/files
Used config:
{'B': 1,
 'D_feat': 512,
 'D_inner': 256,
 'arch': 'clam_sb',
 'augment_epoch': 1,
 'backbone': 'Resnet18',
 'config': 'config/patch_classification_camelyon17_config.yml',
 'data_dir': './Features/CAM17_res18',
 'dataset': 'camelyon17',
 'heatmap_arguments': {'alpha': 0.4,
                       'binarize': False,
                       'blank_canvas': False,
                       'blur': True,
                       'cmap': 'jet',
                       'custom_downsample': 1,
                       'vis_level': -1},
 'load_head_checkpoints': False,
 'lr': 0.0001,
 'min_lr': 0,
 'n_class': 4,
 'n_shot': -1,
 'n_token': 4,
 'n_worker': 8,
 'optim': 'sgd',
 'pin_memory': False,
 'pretrain': 'natural_supervsied',
 'seed': 2,
 'start_epoch': 0,
 'train_epoch': 50,
 'w_loss': 1.0,
 'wandb_mode': 'offline',
 'warmup_epoch': 5,
 'wd': 0.0005}
get dataset
Epoch: [0]  [  0/269]  eta: 0:04:47  lr: 0.000000  bag_loss: 2.9927 (2.9927)  instance_loss: 0.7672 (0.7672)  time: 1.0692  data: 0.5268  max mem: 223
Epoch: [0]  [100/269]  eta: 0:00:04  lr: 0.000007  bag_loss: 2.0378 (2.2173)  instance_loss: 1.2038 (1.1625)  time: 0.0148  data: 0.0011  max mem: 289
Epoch: [0]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.9525 (1.7506)  instance_loss: 1.3059 (1.2024)  time: 0.0126  data: 0.0009  max mem: 337
Epoch: [0]  [268/269]  eta: 0:00:00  lr: 0.000020  bag_loss: 0.7982 (1.5749)  instance_loss: 1.2451 (1.2512)  time: 0.0139  data: 0.0011  max mem: 337
Epoch: [0] Total time: 0:00:04 (4.9860 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3820 (0.3820)  acc1: 100.0000 (100.0000)  time: 0.5889  data: 0.5724  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.6647 (1.1268)  acc1: 100.0000 (63.3333)  time: 0.0060  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9099 s / it)
* Acc@1 63.333 loss 1.127 auroc 0.324 f1_score 0.194
Test  [  0/200]  eta: 0:01:51  loss: 1.7204 (1.7204)  acc1: 0.0000 (0.0000)  time: 0.5571  data: 0.5512  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5289 (1.1796)  acc1: 100.0000 (59.4059)  time: 0.0067  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.8261 (1.1322)  acc1: 100.0000 (60.5000)  time: 0.0087  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.1267 s / it)
* Acc@1 60.500 loss 1.132 auroc 0.455 f1_score 0.188


Epoch: [1]  [  0/269]  eta: 0:02:39  lr: 0.000020  bag_loss: 0.6039 (0.6039)  instance_loss: 1.5722 (1.5722)  time: 0.5920  data: 0.5755  max mem: 337
Epoch: [1]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.4281 (0.9744)  instance_loss: 1.4447 (1.4272)  time: 0.0143  data: 0.0011  max mem: 337
Epoch: [1]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.4087 (1.0347)  instance_loss: 1.4846 (1.4302)  time: 0.0108  data: 0.0010  max mem: 337
Epoch: [1]  [268/269]  eta: 0:00:00  lr: 0.000040  bag_loss: 0.5344 (1.0343)  instance_loss: 1.3817 (1.4185)  time: 0.0132  data: 0.0012  max mem: 337
Epoch: [1] Total time: 0:00:04 (4.5475 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.3796 (0.3796)  acc1: 100.0000 (100.0000)  time: 0.5599  data: 0.5522  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5746 (1.0908)  acc1: 100.0000 (63.3333)  time: 0.0062  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.8855 s / it)
* Acc@1 63.333 loss 1.091 auroc 0.415 f1_score 0.194
Test  [  0/200]  eta: 0:01:55  loss: 1.8019 (1.8019)  acc1: 0.0000 (0.0000)  time: 0.5755  data: 0.5679  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5147 (1.1558)  acc1: 100.0000 (59.4059)  time: 0.0061  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.7201 (1.1030)  acc1: 100.0000 (60.5000)  time: 0.0110  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.1743 s / it)
* Acc@1 60.500 loss 1.103 auroc 0.479 f1_score 0.188


Epoch: [2]  [  0/269]  eta: 0:02:38  lr: 0.000040  bag_loss: 0.5398 (0.5398)  instance_loss: 1.6444 (1.6444)  time: 0.5884  data: 0.5665  max mem: 337
Epoch: [2]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.3795 (1.0004)  instance_loss: 1.4176 (1.3372)  time: 0.0136  data: 0.0012  max mem: 337
Epoch: [2]  [200/269]  eta: 0:00:01  lr: 0.000055  bag_loss: 0.5057 (1.0299)  instance_loss: 1.3951 (1.3443)  time: 0.0150  data: 0.0012  max mem: 337
Epoch: [2]  [268/269]  eta: 0:00:00  lr: 0.000060  bag_loss: 0.4228 (1.0250)  instance_loss: 1.4306 (1.3496)  time: 0.0156  data: 0.0013  max mem: 337
Epoch: [2] Total time: 0:00:04 (4.6158 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3469 (0.3469)  acc1: 100.0000 (100.0000)  time: 0.5955  data: 0.5889  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4634 (1.0603)  acc1: 100.0000 (63.3333)  time: 0.0074  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9738 s / it)
* Acc@1 63.333 loss 1.060 auroc 0.485 f1_score 0.194
Test  [  0/200]  eta: 0:01:57  loss: 1.9151 (1.9151)  acc1: 0.0000 (0.0000)  time: 0.5857  data: 0.5749  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4138 (1.1166)  acc1: 100.0000 (59.4059)  time: 0.0067  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5542 (1.0637)  acc1: 100.0000 (60.5000)  time: 0.0095  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2604 s / it)
* Acc@1 60.500 loss 1.064 auroc 0.553 f1_score 0.188


Epoch: [3]  [  0/269]  eta: 0:02:41  lr: 0.000060  bag_loss: 0.3475 (0.3475)  instance_loss: 1.6341 (1.6341)  time: 0.5987  data: 0.5854  max mem: 337
Epoch: [3]  [100/269]  eta: 0:00:03  lr: 0.000067  bag_loss: 0.4890 (0.9604)  instance_loss: 1.2994 (1.3769)  time: 0.0154  data: 0.0011  max mem: 337
Epoch: [3]  [200/269]  eta: 0:00:01  lr: 0.000075  bag_loss: 0.3750 (1.0233)  instance_loss: 1.3701 (1.3577)  time: 0.0136  data: 0.0010  max mem: 337
Epoch: [3]  [268/269]  eta: 0:00:00  lr: 0.000080  bag_loss: 0.3313 (1.0274)  instance_loss: 1.2498 (1.3444)  time: 0.0118  data: 0.0010  max mem: 337
Epoch: [3] Total time: 0:00:04 (4.6299 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2011 (0.2011)  acc1: 100.0000 (100.0000)  time: 0.5552  data: 0.5399  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2560 (1.1211)  acc1: 100.0000 (63.3333)  time: 0.0068  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9071 s / it)
* Acc@1 63.333 loss 1.121 auroc 0.542 f1_score 0.194
Test  [  0/200]  eta: 0:01:53  loss: 2.6489 (2.6489)  acc1: 0.0000 (0.0000)  time: 0.5650  data: 0.5568  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2558 (1.1648)  acc1: 100.0000 (59.4059)  time: 0.0063  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3350 (1.0701)  acc1: 100.0000 (60.5000)  time: 0.0101  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.3177 s / it)
* Acc@1 60.500 loss 1.070 auroc 0.630 f1_score 0.188


Epoch: [4]  [  0/269]  eta: 0:02:40  lr: 0.000080  bag_loss: 0.2762 (0.2762)  instance_loss: 1.6542 (1.6542)  time: 0.5959  data: 0.5813  max mem: 337
Epoch: [4]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.7890 (0.9233)  instance_loss: 1.1061 (1.3550)  time: 0.0172  data: 0.0015  max mem: 337
Epoch: [4]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.5294 (0.9987)  instance_loss: 1.2242 (1.2973)  time: 0.0138  data: 0.0012  max mem: 337
Epoch: [4]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.3828 (0.9980)  instance_loss: 1.2871 (1.3014)  time: 0.0125  data: 0.0010  max mem: 337
Epoch: [4] Total time: 0:00:04 (4.9569 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3845 (0.3845)  acc1: 100.0000 (100.0000)  time: 0.5858  data: 0.5784  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5107 (1.0398)  acc1: 100.0000 (63.3333)  time: 0.0079  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9558 s / it)
* Acc@1 63.333 loss 1.040 auroc 0.653 f1_score 0.194
Test  [  0/200]  eta: 0:01:54  loss: 2.3682 (2.3682)  acc1: 0.0000 (0.0000)  time: 0.5747  data: 0.5592  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4706 (1.0078)  acc1: 100.0000 (68.3168)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.5837 (0.9518)  acc1: 100.0000 (68.5000)  time: 0.0110  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.3309 s / it)
* Acc@1 68.500 loss 0.952 auroc 0.722 f1_score 0.330


Epoch: [5]  [  0/269]  eta: 0:02:47  lr: 0.000100  bag_loss: 1.1961 (1.1961)  instance_loss: 1.1899 (1.1899)  time: 0.6223  data: 0.5893  max mem: 337
Epoch: [5]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.5263 (0.9755)  instance_loss: 1.2210 (1.2594)  time: 0.0148  data: 0.0011  max mem: 337
Epoch: [5]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.3412 (0.9759)  instance_loss: 1.3206 (1.2425)  time: 0.0118  data: 0.0011  max mem: 337
Epoch: [5]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.2070 (0.9278)  instance_loss: 1.3681 (1.2651)  time: 0.0161  data: 0.0012  max mem: 337
Epoch: [5] Total time: 0:00:04 (4.6519 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.1829 (0.1829)  acc1: 100.0000 (100.0000)  time: 0.5687  data: 0.5619  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1959 (0.9985)  acc1: 100.0000 (63.3333)  time: 0.0071  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9258 s / it)
* Acc@1 63.333 loss 0.999 auroc 0.801 f1_score 0.194
Test  [  0/200]  eta: 0:01:53  loss: 2.8632 (2.8632)  acc1: 0.0000 (0.0000)  time: 0.5694  data: 0.5613  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1879 (0.8883)  acc1: 100.0000 (75.2475)  time: 0.0071  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2849 (0.8116)  acc1: 100.0000 (76.0000)  time: 0.0099  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2624 s / it)
* Acc@1 76.000 loss 0.812 auroc 0.767 f1_score 0.409


Epoch: [6]  [  0/269]  eta: 0:02:39  lr: 0.000100  bag_loss: 0.1913 (0.1913)  instance_loss: 1.4755 (1.4755)  time: 0.5927  data: 0.5809  max mem: 337
Epoch: [6]  [100/269]  eta: 0:00:03  lr: 0.000100  bag_loss: 0.1602 (0.8225)  instance_loss: 1.1484 (1.2212)  time: 0.0144  data: 0.0012  max mem: 337
Epoch: [6]  [200/269]  eta: 0:00:01  lr: 0.000100  bag_loss: 0.6076 (0.8306)  instance_loss: 1.2395 (1.2179)  time: 0.0167  data: 0.0012  max mem: 337
Epoch: [6]  [268/269]  eta: 0:00:00  lr: 0.000100  bag_loss: 0.3434 (0.8391)  instance_loss: 1.2176 (1.2341)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [6] Total time: 0:00:04 (4.6660 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.4178 (0.4178)  acc1: 100.0000 (100.0000)  time: 0.5819  data: 0.5743  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3532 (0.7674)  acc1: 100.0000 (73.3333)  time: 0.0082  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9693 s / it)
* Acc@1 73.333 loss 0.767 auroc 0.830 f1_score 0.399
Test  [  0/200]  eta: 0:01:54  loss: 1.6502 (1.6502)  acc1: 0.0000 (0.0000)  time: 0.5737  data: 0.5660  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3124 (0.7317)  acc1: 100.0000 (77.2277)  time: 0.0069  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3379 (0.6982)  acc1: 100.0000 (80.5000)  time: 0.0102  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2529 s / it)
* Acc@1 80.500 loss 0.698 auroc 0.786 f1_score 0.445


Epoch: [7]  [  0/269]  eta: 0:02:35  lr: 0.000100  bag_loss: 0.3153 (0.3153)  instance_loss: 1.4781 (1.4781)  time: 0.5767  data: 0.5647  max mem: 337
Epoch: [7]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.2652 (0.7636)  instance_loss: 1.3200 (1.3192)  time: 0.0191  data: 0.0013  max mem: 337
Epoch: [7]  [200/269]  eta: 0:00:01  lr: 0.000099  bag_loss: 0.2828 (0.7743)  instance_loss: 1.0885 (1.2571)  time: 0.0152  data: 0.0013  max mem: 337
Epoch: [7]  [268/269]  eta: 0:00:00  lr: 0.000099  bag_loss: 0.2625 (0.7719)  instance_loss: 1.2078 (1.2512)  time: 0.0151  data: 0.0012  max mem: 337
Epoch: [7] Total time: 0:00:04 (4.7465 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2887 (0.2887)  acc1: 100.0000 (100.0000)  time: 0.5932  data: 0.5859  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1941 (0.8215)  acc1: 100.0000 (70.0000)  time: 0.0070  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9430 s / it)
* Acc@1 70.000 loss 0.822 auroc 0.820 f1_score 0.369
Test  [  0/200]  eta: 0:01:58  loss: 1.5455 (1.5455)  acc1: 0.0000 (0.0000)  time: 0.5929  data: 0.5845  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2157 (0.7255)  acc1: 100.0000 (76.2376)  time: 0.0067  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2514 (0.7156)  acc1: 100.0000 (77.0000)  time: 0.0105  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.3249 s / it)
* Acc@1 77.000 loss 0.716 auroc 0.781 f1_score 0.418


Epoch: [8]  [  0/269]  eta: 0:02:41  lr: 0.000099  bag_loss: 0.1800 (0.1800)  instance_loss: 1.5222 (1.5222)  time: 0.5988  data: 0.5769  max mem: 337
Epoch: [8]  [100/269]  eta: 0:00:03  lr: 0.000099  bag_loss: 0.2270 (0.7728)  instance_loss: 1.2241 (1.2011)  time: 0.0151  data: 0.0011  max mem: 337
Epoch: [8]  [200/269]  eta: 0:00:01  lr: 0.000098  bag_loss: 0.3617 (0.7952)  instance_loss: 1.2712 (1.2247)  time: 0.0177  data: 0.0012  max mem: 337
Epoch: [8]  [268/269]  eta: 0:00:00  lr: 0.000098  bag_loss: 0.3457 (0.7738)  instance_loss: 1.1815 (1.2127)  time: 0.0116  data: 0.0010  max mem: 337
Epoch: [8] Total time: 0:00:04 (4.6735 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3101 (0.3101)  acc1: 100.0000 (100.0000)  time: 0.5714  data: 0.5634  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2336 (0.8179)  acc1: 100.0000 (66.6667)  time: 0.0070  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9264 s / it)
* Acc@1 66.667 loss 0.818 auroc 0.820 f1_score 0.285
Test  [  0/200]  eta: 0:02:05  loss: 1.6571 (1.6571)  acc1: 0.0000 (0.0000)  time: 0.6273  data: 0.6176  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2113 (0.6913)  acc1: 100.0000 (76.2376)  time: 0.0063  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2561 (0.6664)  acc1: 100.0000 (78.5000)  time: 0.0109  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.3308 s / it)
* Acc@1 78.500 loss 0.666 auroc 0.789 f1_score 0.431


Epoch: [9]  [  0/269]  eta: 0:02:38  lr: 0.000098  bag_loss: 2.4300 (2.4300)  instance_loss: 1.3974 (1.3974)  time: 0.5883  data: 0.5687  max mem: 337
Epoch: [9]  [100/269]  eta: 0:00:03  lr: 0.000098  bag_loss: 0.5066 (0.7808)  instance_loss: 1.2418 (1.2472)  time: 0.0159  data: 0.0010  max mem: 337
Epoch: [9]  [200/269]  eta: 0:00:01  lr: 0.000097  bag_loss: 0.2374 (0.7407)  instance_loss: 1.2300 (1.2364)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [9]  [268/269]  eta: 0:00:00  lr: 0.000097  bag_loss: 0.2974 (0.7280)  instance_loss: 1.1584 (1.2318)  time: 0.0154  data: 0.0013  max mem: 337
Epoch: [9] Total time: 0:00:04 (4.6809 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2811 (0.2811)  acc1: 100.0000 (100.0000)  time: 0.5996  data: 0.5877  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2044 (0.8689)  acc1: 100.0000 (66.6667)  time: 0.0075  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9694 s / it)
* Acc@1 66.667 loss 0.869 auroc 0.791 f1_score 0.285
Test  [  0/200]  eta: 0:01:54  loss: 1.9639 (1.9639)  acc1: 0.0000 (0.0000)  time: 0.5715  data: 0.5624  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1671 (0.7033)  acc1: 100.0000 (76.2376)  time: 0.0068  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2294 (0.6748)  acc1: 100.0000 (78.0000)  time: 0.0103  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2879 s / it)
* Acc@1 78.000 loss 0.675 auroc 0.783 f1_score 0.426


Epoch: [10]  [  0/269]  eta: 0:02:39  lr: 0.000097  bag_loss: 0.2047 (0.2047)  instance_loss: 1.1015 (1.1015)  time: 0.5942  data: 0.5820  max mem: 337
Epoch: [10]  [100/269]  eta: 0:00:03  lr: 0.000097  bag_loss: 0.1441 (0.5076)  instance_loss: 1.2293 (1.2059)  time: 0.0187  data: 0.0013  max mem: 337
Epoch: [10]  [200/269]  eta: 0:00:01  lr: 0.000096  bag_loss: 0.2658 (0.6337)  instance_loss: 1.2976 (1.2546)  time: 0.0150  data: 0.0010  max mem: 337
Epoch: [10]  [268/269]  eta: 0:00:00  lr: 0.000096  bag_loss: 0.3068 (0.7125)  instance_loss: 1.2744 (1.2743)  time: 0.0134  data: 0.0012  max mem: 337
Epoch: [10] Total time: 0:00:04 (4.7092 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.4619 (0.4619)  acc1: 100.0000 (100.0000)  time: 0.5871  data: 0.5797  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3333 (0.7895)  acc1: 100.0000 (70.0000)  time: 0.0073  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9476 s / it)
* Acc@1 70.000 loss 0.789 auroc 0.795 f1_score 0.359
Test  [  0/200]  eta: 0:01:57  loss: 2.2000 (2.2000)  acc1: 0.0000 (0.0000)  time: 0.5862  data: 0.5784  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2848 (0.6709)  acc1: 100.0000 (80.1980)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2942 (0.6409)  acc1: 100.0000 (83.0000)  time: 0.0101  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.3007 s / it)
* Acc@1 83.000 loss 0.641 auroc 0.797 f1_score 0.521


Epoch: [11]  [  0/269]  eta: 0:02:44  lr: 0.000096  bag_loss: 0.5881 (0.5881)  instance_loss: 1.5163 (1.5163)  time: 0.6099  data: 0.5798  max mem: 337
Epoch: [11]  [100/269]  eta: 0:00:03  lr: 0.000095  bag_loss: 0.2667 (0.6707)  instance_loss: 1.3612 (1.3594)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [11]  [200/269]  eta: 0:00:01  lr: 0.000095  bag_loss: 0.1320 (0.5795)  instance_loss: 1.4215 (1.3686)  time: 0.0180  data: 0.0014  max mem: 337
Epoch: [11]  [268/269]  eta: 0:00:00  lr: 0.000094  bag_loss: 0.8822 (0.6950)  instance_loss: 1.2554 (1.3782)  time: 0.0171  data: 0.0013  max mem: 337
Epoch: [11] Total time: 0:00:04 (4.6906 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.4389 (0.4389)  acc1: 100.0000 (100.0000)  time: 0.5787  data: 0.5706  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5399 (0.7307)  acc1: 100.0000 (73.3333)  time: 0.0077  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9574 s / it)
* Acc@1 73.333 loss 0.731 auroc 0.868 f1_score 0.459
Test  [  0/200]  eta: 0:01:57  loss: 1.1452 (1.1452)  acc1: 0.0000 (0.0000)  time: 0.5855  data: 0.5759  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.5242 (0.6744)  acc1: 100.0000 (80.1980)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.6099 (0.7066)  acc1: 100.0000 (82.5000)  time: 0.0109  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2795 s / it)
* Acc@1 82.500 loss 0.707 auroc 0.812 f1_score 0.558


Epoch: [12]  [  0/269]  eta: 0:02:38  lr: 0.000094  bag_loss: 0.5299 (0.5299)  instance_loss: 1.5846 (1.5846)  time: 0.5895  data: 0.5755  max mem: 337
Epoch: [12]  [100/269]  eta: 0:00:03  lr: 0.000094  bag_loss: 0.3103 (0.6234)  instance_loss: 1.2589 (1.3283)  time: 0.0153  data: 0.0012  max mem: 337
Epoch: [12]  [200/269]  eta: 0:00:01  lr: 0.000093  bag_loss: 0.2247 (0.6731)  instance_loss: 1.4015 (1.3547)  time: 0.0125  data: 0.0010  max mem: 337
Epoch: [12]  [268/269]  eta: 0:00:00  lr: 0.000092  bag_loss: 0.4899 (0.6936)  instance_loss: 1.3399 (1.3550)  time: 0.0158  data: 0.0012  max mem: 337
Epoch: [12] Total time: 0:00:04 (4.6735 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3335 (0.3335)  acc1: 100.0000 (100.0000)  time: 0.5829  data: 0.5696  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3933 (0.7059)  acc1: 100.0000 (76.6667)  time: 0.0072  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9341 s / it)
* Acc@1 76.667 loss 0.706 auroc 0.835 f1_score 0.487
Test  [  0/200]  eta: 0:01:54  loss: 0.8282 (0.8282)  acc1: 100.0000 (100.0000)  time: 0.5706  data: 0.5617  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2865 (0.6345)  acc1: 100.0000 (82.1782)  time: 0.0070  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3946 (0.6793)  acc1: 100.0000 (81.0000)  time: 0.0108  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.3101 s / it)
* Acc@1 81.000 loss 0.679 auroc 0.827 f1_score 0.524


Epoch: [13]  [  0/269]  eta: 0:02:32  lr: 0.000092  bag_loss: 0.2528 (0.2528)  instance_loss: 1.3856 (1.3856)  time: 0.5675  data: 0.5524  max mem: 337
Epoch: [13]  [100/269]  eta: 0:00:03  lr: 0.000092  bag_loss: 0.2794 (0.5920)  instance_loss: 1.2496 (1.4066)  time: 0.0141  data: 0.0012  max mem: 337
Epoch: [13]  [200/269]  eta: 0:00:01  lr: 0.000091  bag_loss: 0.4303 (0.7182)  instance_loss: 1.2856 (1.3888)  time: 0.0148  data: 0.0012  max mem: 337
Epoch: [13]  [268/269]  eta: 0:00:00  lr: 0.000090  bag_loss: 0.2378 (0.6780)  instance_loss: 1.4923 (1.3893)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [13] Total time: 0:00:04 (4.7145 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2123 (0.2123)  acc1: 100.0000 (100.0000)  time: 0.5637  data: 0.5552  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1547 (0.7627)  acc1: 100.0000 (76.6667)  time: 0.0073  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9305 s / it)
* Acc@1 76.667 loss 0.763 auroc 0.811 f1_score 0.487
Test  [  0/200]  eta: 0:01:52  loss: 1.3290 (1.3290)  acc1: 0.0000 (0.0000)  time: 0.5634  data: 0.5519  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1084 (0.6900)  acc1: 100.0000 (77.2277)  time: 0.0063  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1486 (0.6874)  acc1: 100.0000 (78.5000)  time: 0.0101  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2916 s / it)
* Acc@1 78.500 loss 0.687 auroc 0.813 f1_score 0.454


Epoch: [14]  [  0/269]  eta: 0:02:37  lr: 0.000090  bag_loss: 0.0634 (0.0634)  instance_loss: 1.1682 (1.1682)  time: 0.5842  data: 0.5725  max mem: 337
Epoch: [14]  [100/269]  eta: 0:00:03  lr: 0.000090  bag_loss: 0.5249 (0.7343)  instance_loss: 1.2894 (1.2912)  time: 0.0193  data: 0.0014  max mem: 337
Epoch: [14]  [200/269]  eta: 0:00:01  lr: 0.000089  bag_loss: 0.2682 (0.6605)  instance_loss: 1.4043 (1.3655)  time: 0.0142  data: 0.0013  max mem: 337
Epoch: [14]  [268/269]  eta: 0:00:00  lr: 0.000088  bag_loss: 0.3172 (0.6438)  instance_loss: 1.4557 (1.4030)  time: 0.0161  data: 0.0011  max mem: 337
Epoch: [14] Total time: 0:00:04 (4.7616 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2561 (0.2561)  acc1: 100.0000 (100.0000)  time: 0.5686  data: 0.5600  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2275 (0.8545)  acc1: 100.0000 (73.3333)  time: 0.0078  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.9434 s / it)
* Acc@1 73.333 loss 0.854 auroc 0.803 f1_score 0.396
Test  [  0/200]  eta: 0:01:57  loss: 3.1798 (3.1798)  acc1: 0.0000 (0.0000)  time: 0.5857  data: 0.5759  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2149 (0.7081)  acc1: 100.0000 (76.2376)  time: 0.0062  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2040 (0.6230)  acc1: 100.0000 (81.0000)  time: 0.0115  data: 0.0013  max mem: 337
Test Total time: 0:00:02 (2.3642 s / it)
* Acc@1 81.000 loss 0.623 auroc 0.812 f1_score 0.442


Epoch: [15]  [  0/269]  eta: 0:02:38  lr: 0.000088  bag_loss: 0.0404 (0.0404)  instance_loss: 1.6882 (1.6882)  time: 0.5878  data: 0.5674  max mem: 337
Epoch: [15]  [100/269]  eta: 0:00:03  lr: 0.000087  bag_loss: 0.2528 (0.6727)  instance_loss: 1.3612 (1.4064)  time: 0.0177  data: 0.0013  max mem: 337
Epoch: [15]  [200/269]  eta: 0:00:01  lr: 0.000087  bag_loss: 0.2554 (0.6024)  instance_loss: 1.6598 (1.4591)  time: 0.0162  data: 0.0011  max mem: 337
Epoch: [15]  [268/269]  eta: 0:00:00  lr: 0.000086  bag_loss: 0.4074 (0.6480)  instance_loss: 1.4731 (1.4452)  time: 0.0129  data: 0.0010  max mem: 337
Epoch: [15] Total time: 0:00:04 (4.7418 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3222 (0.3222)  acc1: 100.0000 (100.0000)  time: 0.5852  data: 0.5782  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3025 (0.7246)  acc1: 100.0000 (70.0000)  time: 0.0065  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9249 s / it)
* Acc@1 70.000 loss 0.725 auroc 0.837 f1_score 0.359
Test  [  0/200]  eta: 0:01:56  loss: 1.1109 (1.1109)  acc1: 0.0000 (0.0000)  time: 0.5827  data: 0.5717  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2792 (0.6347)  acc1: 100.0000 (77.2277)  time: 0.0062  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2818 (0.6292)  acc1: 100.0000 (79.5000)  time: 0.0105  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2758 s / it)
* Acc@1 79.500 loss 0.629 auroc 0.826 f1_score 0.505


Epoch: [16]  [  0/269]  eta: 0:02:37  lr: 0.000086  bag_loss: 0.6999 (0.6999)  instance_loss: 1.5511 (1.5511)  time: 0.5872  data: 0.5722  max mem: 337
Epoch: [16]  [100/269]  eta: 0:00:03  lr: 0.000085  bag_loss: 0.1842 (0.6113)  instance_loss: 1.3895 (1.3702)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [16]  [200/269]  eta: 0:00:01  lr: 0.000084  bag_loss: 0.3906 (0.6269)  instance_loss: 1.3849 (1.4097)  time: 0.0136  data: 0.0011  max mem: 337
Epoch: [16]  [268/269]  eta: 0:00:00  lr: 0.000083  bag_loss: 0.2811 (0.6379)  instance_loss: 1.2866 (1.4006)  time: 0.0118  data: 0.0010  max mem: 337
Epoch: [16] Total time: 0:00:04 (4.7599 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2279 (0.2279)  acc1: 100.0000 (100.0000)  time: 0.5865  data: 0.5785  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3129 (0.6840)  acc1: 100.0000 (73.3333)  time: 0.0070  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9436 s / it)
* Acc@1 73.333 loss 0.684 auroc 0.841 f1_score 0.396
Test  [  0/200]  eta: 0:01:52  loss: 1.7442 (1.7442)  acc1: 0.0000 (0.0000)  time: 0.5624  data: 0.5527  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2052 (0.6130)  acc1: 100.0000 (80.1980)  time: 0.0068  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2409 (0.5975)  acc1: 100.0000 (82.5000)  time: 0.0106  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2865 s / it)
* Acc@1 82.500 loss 0.597 auroc 0.849 f1_score 0.533


Epoch: [17]  [  0/269]  eta: 0:02:35  lr: 0.000083  bag_loss: 0.2954 (0.2954)  instance_loss: 2.1616 (2.1616)  time: 0.5776  data: 0.5594  max mem: 337
Epoch: [17]  [100/269]  eta: 0:00:03  lr: 0.000082  bag_loss: 0.2030 (0.7485)  instance_loss: 1.1257 (1.4786)  time: 0.0124  data: 0.0012  max mem: 337
Epoch: [17]  [200/269]  eta: 0:00:01  lr: 0.000081  bag_loss: 0.2619 (0.6586)  instance_loss: 1.3283 (1.4677)  time: 0.0111  data: 0.0012  max mem: 337
Epoch: [17]  [268/269]  eta: 0:00:00  lr: 0.000081  bag_loss: 0.1892 (0.6374)  instance_loss: 1.4373 (1.4686)  time: 0.0197  data: 0.0012  max mem: 337
Epoch: [17] Total time: 0:00:04 (4.7778 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2449 (0.2449)  acc1: 100.0000 (100.0000)  time: 0.5872  data: 0.5804  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3258 (0.7669)  acc1: 100.0000 (70.0000)  time: 0.0066  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9484 s / it)
* Acc@1 70.000 loss 0.767 auroc 0.834 f1_score 0.359
Test  [  0/200]  eta: 0:01:55  loss: 2.5387 (2.5387)  acc1: 0.0000 (0.0000)  time: 0.5779  data: 0.5684  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2478 (0.6685)  acc1: 100.0000 (76.2376)  time: 0.0062  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2522 (0.6068)  acc1: 100.0000 (80.0000)  time: 0.0104  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2728 s / it)
* Acc@1 80.000 loss 0.607 auroc 0.840 f1_score 0.516


Epoch: [18]  [  0/269]  eta: 0:02:36  lr: 0.000081  bag_loss: 0.3158 (0.3158)  instance_loss: 1.2547 (1.2547)  time: 0.5827  data: 0.5715  max mem: 337
Epoch: [18]  [100/269]  eta: 0:00:03  lr: 0.000080  bag_loss: 0.2312 (0.4686)  instance_loss: 1.4425 (1.5054)  time: 0.0157  data: 0.0012  max mem: 337
Epoch: [18]  [200/269]  eta: 0:00:01  lr: 0.000079  bag_loss: 0.2346 (0.5891)  instance_loss: 1.4168 (1.4426)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [18]  [268/269]  eta: 0:00:00  lr: 0.000078  bag_loss: 0.2457 (0.6141)  instance_loss: 1.3338 (1.4184)  time: 0.0177  data: 0.0014  max mem: 337
Epoch: [18] Total time: 0:00:04 (4.7283 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3550 (0.3550)  acc1: 100.0000 (100.0000)  time: 0.5944  data: 0.5834  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.5127 (0.7017)  acc1: 100.0000 (73.3333)  time: 0.0075  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9632 s / it)
* Acc@1 73.333 loss 0.702 auroc 0.854 f1_score 0.441
Test  [  0/200]  eta: 0:01:56  loss: 1.2588 (1.2588)  acc1: 0.0000 (0.0000)  time: 0.5825  data: 0.5725  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.4352 (0.6347)  acc1: 100.0000 (75.2475)  time: 0.0066  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.4305 (0.6505)  acc1: 100.0000 (80.0000)  time: 0.0101  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.3158 s / it)
* Acc@1 80.000 loss 0.651 auroc 0.850 f1_score 0.565


Epoch: [19]  [  0/269]  eta: 0:02:36  lr: 0.000078  bag_loss: 0.4271 (0.4271)  instance_loss: 1.5041 (1.5041)  time: 0.5815  data: 0.5632  max mem: 337
Epoch: [19]  [100/269]  eta: 0:00:03  lr: 0.000077  bag_loss: 0.3233 (0.6624)  instance_loss: 1.2237 (1.2968)  time: 0.0107  data: 0.0010  max mem: 337
Epoch: [19]  [200/269]  eta: 0:00:01  lr: 0.000076  bag_loss: 0.1273 (0.6216)  instance_loss: 1.3651 (1.3446)  time: 0.0132  data: 0.0013  max mem: 337
Epoch: [19]  [268/269]  eta: 0:00:00  lr: 0.000075  bag_loss: 0.4618 (0.6211)  instance_loss: 1.1627 (1.3512)  time: 0.0131  data: 0.0013  max mem: 337
Epoch: [19] Total time: 0:00:04 (4.7154 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2751 (0.2751)  acc1: 100.0000 (100.0000)  time: 0.5801  data: 0.5732  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3742 (0.7291)  acc1: 100.0000 (66.6667)  time: 0.0073  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9376 s / it)
* Acc@1 66.667 loss 0.729 auroc 0.848 f1_score 0.352
Test  [  0/200]  eta: 0:01:58  loss: 1.6117 (1.6117)  acc1: 0.0000 (0.0000)  time: 0.5925  data: 0.5844  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2762 (0.7296)  acc1: 100.0000 (63.3663)  time: 0.0075  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3220 (0.6929)  acc1: 100.0000 (73.5000)  time: 0.0108  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.2931 s / it)
* Acc@1 73.500 loss 0.693 auroc 0.823 f1_score 0.490


Epoch: [20]  [  0/269]  eta: 0:02:33  lr: 0.000075  bag_loss: 0.1569 (0.1569)  instance_loss: 1.6325 (1.6325)  time: 0.5705  data: 0.5560  max mem: 337
Epoch: [20]  [100/269]  eta: 0:00:03  lr: 0.000074  bag_loss: 0.2992 (0.5331)  instance_loss: 1.4682 (1.3791)  time: 0.0123  data: 0.0013  max mem: 337
Epoch: [20]  [200/269]  eta: 0:00:01  lr: 0.000073  bag_loss: 0.1689 (0.5433)  instance_loss: 1.2433 (1.3442)  time: 0.0131  data: 0.0010  max mem: 337
Epoch: [20]  [268/269]  eta: 0:00:00  lr: 0.000072  bag_loss: 0.1872 (0.5899)  instance_loss: 1.3196 (1.3483)  time: 0.0163  data: 0.0012  max mem: 337
Epoch: [20] Total time: 0:00:04 (4.6336 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2367 (0.2367)  acc1: 100.0000 (100.0000)  time: 0.5720  data: 0.5648  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1926 (0.8111)  acc1: 100.0000 (70.0000)  time: 0.0069  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9265 s / it)
* Acc@1 70.000 loss 0.811 auroc 0.809 f1_score 0.359
Test  [  0/200]  eta: 0:01:53  loss: 2.1975 (2.1975)  acc1: 0.0000 (0.0000)  time: 0.5669  data: 0.5579  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1622 (0.7419)  acc1: 100.0000 (69.3069)  time: 0.0075  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1687 (0.6656)  acc1: 100.0000 (75.0000)  time: 0.0108  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2678 s / it)
* Acc@1 75.000 loss 0.666 auroc 0.813 f1_score 0.441


Epoch: [21]  [  0/269]  eta: 0:02:44  lr: 0.000072  bag_loss: 0.3148 (0.3148)  instance_loss: 1.3470 (1.3470)  time: 0.6128  data: 0.5930  max mem: 337
Epoch: [21]  [100/269]  eta: 0:00:03  lr: 0.000071  bag_loss: 0.0796 (0.5833)  instance_loss: 1.6120 (1.3916)  time: 0.0165  data: 0.0012  max mem: 337
Epoch: [21]  [200/269]  eta: 0:00:01  lr: 0.000070  bag_loss: 0.3093 (0.5873)  instance_loss: 1.1707 (1.3676)  time: 0.0144  data: 0.0013  max mem: 337
Epoch: [21]  [268/269]  eta: 0:00:00  lr: 0.000069  bag_loss: 0.0901 (0.5927)  instance_loss: 1.4078 (1.3562)  time: 0.0174  data: 0.0012  max mem: 337
Epoch: [21] Total time: 0:00:04 (4.7644 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.1277 (0.1277)  acc1: 100.0000 (100.0000)  time: 0.5777  data: 0.5706  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1810 (0.8055)  acc1: 100.0000 (70.0000)  time: 0.0074  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9326 s / it)
* Acc@1 70.000 loss 0.806 auroc 0.831 f1_score 0.371
Test  [  0/200]  eta: 0:01:52  loss: 1.7877 (1.7877)  acc1: 0.0000 (0.0000)  time: 0.5607  data: 0.5511  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1315 (0.7796)  acc1: 100.0000 (75.2475)  time: 0.0064  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2141 (0.7106)  acc1: 100.0000 (77.0000)  time: 0.0098  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2922 s / it)
* Acc@1 77.000 loss 0.711 auroc 0.779 f1_score 0.421


Epoch: [22]  [  0/269]  eta: 0:02:35  lr: 0.000069  bag_loss: 3.6474 (3.6474)  instance_loss: 1.4856 (1.4856)  time: 0.5792  data: 0.5661  max mem: 337
Epoch: [22]  [100/269]  eta: 0:00:03  lr: 0.000068  bag_loss: 0.2981 (0.6070)  instance_loss: 1.1219 (1.3238)  time: 0.0149  data: 0.0012  max mem: 337
Epoch: [22]  [200/269]  eta: 0:00:01  lr: 0.000066  bag_loss: 0.1153 (0.5491)  instance_loss: 1.1854 (1.3464)  time: 0.0145  data: 0.0012  max mem: 337
Epoch: [22]  [268/269]  eta: 0:00:00  lr: 0.000065  bag_loss: 0.3808 (0.5834)  instance_loss: 1.3110 (1.3415)  time: 0.0132  data: 0.0011  max mem: 337
Epoch: [22] Total time: 0:00:04 (4.6435 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3252 (0.3252)  acc1: 100.0000 (100.0000)  time: 0.5709  data: 0.5641  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.4955 (0.7906)  acc1: 100.0000 (70.0000)  time: 0.0076  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9332 s / it)
* Acc@1 70.000 loss 0.791 auroc 0.837 f1_score 0.359
Test  [  0/200]  eta: 0:01:56  loss: 1.3627 (1.3627)  acc1: 0.0000 (0.0000)  time: 0.5825  data: 0.5738  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3258 (0.7101)  acc1: 100.0000 (67.3267)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3703 (0.6829)  acc1: 100.0000 (76.0000)  time: 0.0111  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.2933 s / it)
* Acc@1 76.000 loss 0.683 auroc 0.815 f1_score 0.512


Epoch: [23]  [  0/269]  eta: 0:02:38  lr: 0.000065  bag_loss: 0.2643 (0.2643)  instance_loss: 1.0862 (1.0862)  time: 0.5888  data: 0.5737  max mem: 337
Epoch: [23]  [100/269]  eta: 0:00:03  lr: 0.000064  bag_loss: 0.1799 (0.4972)  instance_loss: 1.2042 (1.3000)  time: 0.0141  data: 0.0010  max mem: 337
Epoch: [23]  [200/269]  eta: 0:00:01  lr: 0.000063  bag_loss: 0.3532 (0.5510)  instance_loss: 1.3202 (1.2828)  time: 0.0121  data: 0.0010  max mem: 337
Epoch: [23]  [268/269]  eta: 0:00:00  lr: 0.000062  bag_loss: 0.2115 (0.5674)  instance_loss: 1.1523 (1.2799)  time: 0.0142  data: 0.0012  max mem: 337
Epoch: [23] Total time: 0:00:04 (4.5613 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2402 (0.2402)  acc1: 100.0000 (100.0000)  time: 0.5717  data: 0.5643  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2033 (0.6860)  acc1: 100.0000 (70.0000)  time: 0.0071  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9152 s / it)
* Acc@1 70.000 loss 0.686 auroc 0.887 f1_score 0.359
Test  [  0/200]  eta: 0:01:53  loss: 1.8220 (1.8220)  acc1: 0.0000 (0.0000)  time: 0.5693  data: 0.5619  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1805 (0.6600)  acc1: 100.0000 (74.2574)  time: 0.0061  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2015 (0.6100)  acc1: 100.0000 (79.5000)  time: 0.0110  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2666 s / it)
* Acc@1 79.500 loss 0.610 auroc 0.839 f1_score 0.513


Epoch: [24]  [  0/269]  eta: 0:02:36  lr: 0.000062  bag_loss: 0.2862 (0.2862)  instance_loss: 0.9094 (0.9094)  time: 0.5825  data: 0.5713  max mem: 337
Epoch: [24]  [100/269]  eta: 0:00:03  lr: 0.000061  bag_loss: 0.2664 (0.5320)  instance_loss: 1.3568 (1.3289)  time: 0.0173  data: 0.0013  max mem: 337
Epoch: [24]  [200/269]  eta: 0:00:01  lr: 0.000060  bag_loss: 0.3265 (0.5779)  instance_loss: 1.1008 (1.2836)  time: 0.0130  data: 0.0014  max mem: 337
Epoch: [24]  [268/269]  eta: 0:00:00  lr: 0.000059  bag_loss: 0.1881 (0.5561)  instance_loss: 1.2419 (1.2768)  time: 0.0149  data: 0.0010  max mem: 337
Epoch: [24] Total time: 0:00:04 (4.7614 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.1533 (0.1533)  acc1: 100.0000 (100.0000)  time: 0.5668  data: 0.5600  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1210 (0.7566)  acc1: 100.0000 (70.0000)  time: 0.0073  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9151 s / it)
* Acc@1 70.000 loss 0.757 auroc 0.856 f1_score 0.359
Test  [  0/200]  eta: 0:01:55  loss: 2.4235 (2.4235)  acc1: 0.0000 (0.0000)  time: 0.5772  data: 0.5664  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.0952 (0.6648)  acc1: 100.0000 (78.2178)  time: 0.0066  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1265 (0.6155)  acc1: 100.0000 (81.5000)  time: 0.0102  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2839 s / it)
* Acc@1 81.500 loss 0.616 auroc 0.842 f1_score 0.496


Epoch: [25]  [  0/269]  eta: 0:02:34  lr: 0.000059  bag_loss: 2.0700 (2.0700)  instance_loss: 1.4772 (1.4772)  time: 0.5726  data: 0.5548  max mem: 337
Epoch: [25]  [100/269]  eta: 0:00:03  lr: 0.000057  bag_loss: 0.1901 (0.5252)  instance_loss: 1.2947 (1.3356)  time: 0.0138  data: 0.0010  max mem: 337
Epoch: [25]  [200/269]  eta: 0:00:01  lr: 0.000056  bag_loss: 0.2203 (0.4852)  instance_loss: 1.1188 (1.3391)  time: 0.0143  data: 0.0011  max mem: 337
Epoch: [25]  [268/269]  eta: 0:00:00  lr: 0.000055  bag_loss: 0.4609 (0.5530)  instance_loss: 1.1288 (1.3164)  time: 0.0146  data: 0.0011  max mem: 337
Epoch: [25] Total time: 0:00:04 (4.6719 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.3155 (0.3155)  acc1: 100.0000 (100.0000)  time: 0.5850  data: 0.5770  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.3519 (0.6807)  acc1: 100.0000 (70.0000)  time: 0.0070  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9436 s / it)
* Acc@1 70.000 loss 0.681 auroc 0.872 f1_score 0.359
Test  [  0/200]  eta: 0:01:54  loss: 1.1348 (1.1348)  acc1: 0.0000 (0.0000)  time: 0.5746  data: 0.5591  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3003 (0.6880)  acc1: 100.0000 (68.3168)  time: 0.0062  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3156 (0.6876)  acc1: 100.0000 (75.5000)  time: 0.0102  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2969 s / it)
* Acc@1 75.500 loss 0.688 auroc 0.826 f1_score 0.548


Epoch: [26]  [  0/269]  eta: 0:02:37  lr: 0.000055  bag_loss: 0.4749 (0.4749)  instance_loss: 0.7880 (0.7880)  time: 0.5843  data: 0.5652  max mem: 337
Epoch: [26]  [100/269]  eta: 0:00:03  lr: 0.000054  bag_loss: 0.2389 (0.5664)  instance_loss: 1.0948 (1.2889)  time: 0.0152  data: 0.0010  max mem: 337
Epoch: [26]  [200/269]  eta: 0:00:01  lr: 0.000053  bag_loss: 0.3032 (0.5550)  instance_loss: 1.2369 (1.3245)  time: 0.0112  data: 0.0010  max mem: 337
Epoch: [26]  [268/269]  eta: 0:00:00  lr: 0.000052  bag_loss: 0.2720 (0.5427)  instance_loss: 1.0958 (1.3242)  time: 0.0160  data: 0.0013  max mem: 337
Epoch: [26] Total time: 0:00:04 (4.6669 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2337 (0.2337)  acc1: 100.0000 (100.0000)  time: 0.5560  data: 0.5476  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2551 (0.6923)  acc1: 100.0000 (70.0000)  time: 0.0079  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9370 s / it)
* Acc@1 70.000 loss 0.692 auroc 0.869 f1_score 0.359
Test  [  0/200]  eta: 0:01:55  loss: 1.1196 (1.1196)  acc1: 0.0000 (0.0000)  time: 0.5789  data: 0.5713  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2339 (0.7154)  acc1: 100.0000 (69.3069)  time: 0.0063  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2631 (0.7022)  acc1: 100.0000 (74.5000)  time: 0.0099  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2248 s / it)
* Acc@1 74.500 loss 0.702 auroc 0.803 f1_score 0.509


Epoch: [27]  [  0/269]  eta: 0:02:34  lr: 0.000052  bag_loss: 0.1109 (0.1109)  instance_loss: 1.7060 (1.7060)  time: 0.5745  data: 0.5598  max mem: 337
Epoch: [27]  [100/269]  eta: 0:00:03  lr: 0.000050  bag_loss: 0.1126 (0.5053)  instance_loss: 1.1019 (1.2784)  time: 0.0147  data: 0.0012  max mem: 337
Epoch: [27]  [200/269]  eta: 0:00:01  lr: 0.000049  bag_loss: 0.2462 (0.5037)  instance_loss: 1.2816 (1.2946)  time: 0.0140  data: 0.0011  max mem: 337
Epoch: [27]  [268/269]  eta: 0:00:00  lr: 0.000048  bag_loss: 0.3028 (0.5176)  instance_loss: 1.2355 (1.2929)  time: 0.0129  data: 0.0011  max mem: 337
Epoch: [27] Total time: 0:00:04 (4.6526 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2156 (0.2156)  acc1: 100.0000 (100.0000)  time: 0.5751  data: 0.5653  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2377 (0.7003)  acc1: 100.0000 (70.0000)  time: 0.0077  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9474 s / it)
* Acc@1 70.000 loss 0.700 auroc 0.872 f1_score 0.359
Test  [  0/200]  eta: 0:01:53  loss: 1.1568 (1.1568)  acc1: 0.0000 (0.0000)  time: 0.5664  data: 0.5575  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2784 (0.7576)  acc1: 100.0000 (60.3960)  time: 0.0069  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2907 (0.7366)  acc1: 100.0000 (69.5000)  time: 0.0104  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2838 s / it)
* Acc@1 69.500 loss 0.737 auroc 0.800 f1_score 0.465


Epoch: [28]  [  0/269]  eta: 0:02:35  lr: 0.000048  bag_loss: 2.4959 (2.4959)  instance_loss: 1.5277 (1.5277)  time: 0.5790  data: 0.5637  max mem: 337
Epoch: [28]  [100/269]  eta: 0:00:03  lr: 0.000047  bag_loss: 0.1449 (0.4601)  instance_loss: 1.1394 (1.3766)  time: 0.0137  data: 0.0011  max mem: 337
Epoch: [28]  [200/269]  eta: 0:00:01  lr: 0.000046  bag_loss: 0.3614 (0.5029)  instance_loss: 1.3236 (1.3534)  time: 0.0164  data: 0.0013  max mem: 337
Epoch: [28]  [268/269]  eta: 0:00:00  lr: 0.000045  bag_loss: 0.1655 (0.5190)  instance_loss: 1.3197 (1.3550)  time: 0.0148  data: 0.0013  max mem: 337
Epoch: [28] Total time: 0:00:04 (4.7103 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2546 (0.2546)  acc1: 100.0000 (100.0000)  time: 0.5767  data: 0.5692  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1847 (0.6764)  acc1: 100.0000 (70.0000)  time: 0.0069  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9354 s / it)
* Acc@1 70.000 loss 0.676 auroc 0.881 f1_score 0.359
Test  [  0/200]  eta: 0:01:55  loss: 1.6503 (1.6503)  acc1: 0.0000 (0.0000)  time: 0.5750  data: 0.5663  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2058 (0.6769)  acc1: 100.0000 (70.2970)  time: 0.0063  data: 0.0009  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2363 (0.6465)  acc1: 100.0000 (77.0000)  time: 0.0109  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.2560 s / it)
* Acc@1 77.000 loss 0.647 auroc 0.826 f1_score 0.533


Epoch: [29]  [  0/269]  eta: 0:02:34  lr: 0.000045  bag_loss: 0.0903 (0.0903)  instance_loss: 1.1903 (1.1903)  time: 0.5754  data: 0.5583  max mem: 337
Epoch: [29]  [100/269]  eta: 0:00:03  lr: 0.000043  bag_loss: 0.1768 (0.5437)  instance_loss: 1.0867 (1.3088)  time: 0.0133  data: 0.0011  max mem: 337
Epoch: [29]  [200/269]  eta: 0:00:01  lr: 0.000042  bag_loss: 0.1611 (0.5647)  instance_loss: 1.1126 (1.3154)  time: 0.0156  data: 0.0013  max mem: 337
Epoch: [29]  [268/269]  eta: 0:00:00  lr: 0.000041  bag_loss: 0.1317 (0.5287)  instance_loss: 1.2120 (1.3148)  time: 0.0125  data: 0.0010  max mem: 337
Epoch: [29] Total time: 0:00:04 (4.7670 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2014 (0.2014)  acc1: 100.0000 (100.0000)  time: 0.5734  data: 0.5659  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1934 (0.6660)  acc1: 100.0000 (70.0000)  time: 0.0068  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9200 s / it)
* Acc@1 70.000 loss 0.666 auroc 0.883 f1_score 0.359
Test  [  0/200]  eta: 0:01:58  loss: 1.5459 (1.5459)  acc1: 0.0000 (0.0000)  time: 0.5918  data: 0.5844  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1349 (0.6559)  acc1: 100.0000 (78.2178)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.1635 (0.6342)  acc1: 100.0000 (80.5000)  time: 0.0105  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.3212 s / it)
* Acc@1 80.500 loss 0.634 auroc 0.828 f1_score 0.530


Epoch: [30]  [  0/269]  eta: 0:02:36  lr: 0.000041  bag_loss: 0.2525 (0.2525)  instance_loss: 1.1670 (1.1670)  time: 0.5811  data: 0.5614  max mem: 337
Epoch: [30]  [100/269]  eta: 0:00:03  lr: 0.000040  bag_loss: 0.3898 (0.5330)  instance_loss: 1.3189 (1.3224)  time: 0.0153  data: 0.0013  max mem: 337
Epoch: [30]  [200/269]  eta: 0:00:01  lr: 0.000039  bag_loss: 0.2119 (0.4638)  instance_loss: 1.2314 (1.3119)  time: 0.0158  data: 0.0012  max mem: 337
Epoch: [30]  [268/269]  eta: 0:00:00  lr: 0.000038  bag_loss: 0.1578 (0.4967)  instance_loss: 1.3536 (1.2968)  time: 0.0175  data: 0.0012  max mem: 337
Epoch: [30] Total time: 0:00:04 (4.7730 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2774 (0.2774)  acc1: 100.0000 (100.0000)  time: 0.5681  data: 0.5591  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2776 (0.7316)  acc1: 100.0000 (70.0000)  time: 0.0068  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9265 s / it)
* Acc@1 70.000 loss 0.732 auroc 0.871 f1_score 0.359
Test  [  0/200]  eta: 0:01:58  loss: 2.1417 (2.1417)  acc1: 0.0000 (0.0000)  time: 0.5939  data: 0.5862  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2700 (0.7233)  acc1: 100.0000 (62.3762)  time: 0.0062  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3237 (0.6889)  acc1: 100.0000 (72.0000)  time: 0.0102  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2623 s / it)
* Acc@1 72.000 loss 0.689 auroc 0.814 f1_score 0.521


Epoch: [31]  [  0/269]  eta: 0:02:34  lr: 0.000038  bag_loss: 0.2421 (0.2421)  instance_loss: 1.9754 (1.9754)  time: 0.5755  data: 0.5558  max mem: 337
Epoch: [31]  [100/269]  eta: 0:00:03  lr: 0.000037  bag_loss: 0.3140 (0.5364)  instance_loss: 1.2191 (1.2435)  time: 0.0159  data: 0.0013  max mem: 337
Epoch: [31]  [200/269]  eta: 0:00:01  lr: 0.000035  bag_loss: 0.1489 (0.4777)  instance_loss: 1.2936 (1.2543)  time: 0.0138  data: 0.0010  max mem: 337
Epoch: [31]  [268/269]  eta: 0:00:00  lr: 0.000035  bag_loss: 0.2416 (0.4965)  instance_loss: 1.1427 (1.2623)  time: 0.0142  data: 0.0012  max mem: 337
Epoch: [31] Total time: 0:00:04 (4.6321 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2302 (0.2302)  acc1: 100.0000 (100.0000)  time: 0.5680  data: 0.5598  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1983 (0.6450)  acc1: 100.0000 (70.0000)  time: 0.0070  data: 0.0006  max mem: 337
Val Total time: 0:00:00 (0.9149 s / it)
* Acc@1 70.000 loss 0.645 auroc 0.879 f1_score 0.359
Test  [  0/200]  eta: 0:01:51  loss: 1.3610 (1.3610)  acc1: 0.0000 (0.0000)  time: 0.5598  data: 0.5466  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2355 (0.6935)  acc1: 100.0000 (69.3069)  time: 0.0072  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2673 (0.6774)  acc1: 100.0000 (75.5000)  time: 0.0111  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.2689 s / it)
* Acc@1 75.500 loss 0.677 auroc 0.817 f1_score 0.536


Epoch: [32]  [  0/269]  eta: 0:02:33  lr: 0.000035  bag_loss: 0.0506 (0.0506)  instance_loss: 1.1255 (1.1255)  time: 0.5702  data: 0.5580  max mem: 337
Epoch: [32]  [100/269]  eta: 0:00:03  lr: 0.000033  bag_loss: 0.0787 (0.4677)  instance_loss: 1.4454 (1.2617)  time: 0.0167  data: 0.0011  max mem: 337
Epoch: [32]  [200/269]  eta: 0:00:01  lr: 0.000032  bag_loss: 0.1576 (0.4576)  instance_loss: 1.1806 (1.2994)  time: 0.0160  data: 0.0010  max mem: 337
Epoch: [32]  [268/269]  eta: 0:00:00  lr: 0.000031  bag_loss: 0.2583 (0.4806)  instance_loss: 1.1114 (1.2932)  time: 0.0142  data: 0.0010  max mem: 337
Epoch: [32] Total time: 0:00:04 (4.6547 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2551 (0.2551)  acc1: 100.0000 (100.0000)  time: 0.5765  data: 0.5678  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.2750 (0.6836)  acc1: 100.0000 (70.0000)  time: 0.0072  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9339 s / it)
* Acc@1 70.000 loss 0.684 auroc 0.874 f1_score 0.359
Test  [  0/200]  eta: 0:02:29  loss: 1.3696 (1.3696)  acc1: 0.0000 (0.0000)  time: 0.7467  data: 0.7339  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.3027 (0.7406)  acc1: 100.0000 (62.3762)  time: 0.0061  data: 0.0008  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.3886 (0.7392)  acc1: 100.0000 (68.0000)  time: 0.0104  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.8231 s / it)
* Acc@1 68.000 loss 0.739 auroc 0.809 f1_score 0.519


Epoch: [33]  [  0/269]  eta: 0:02:37  lr: 0.000031  bag_loss: 1.4994 (1.4994)  instance_loss: 1.2039 (1.2039)  time: 0.5869  data: 0.5697  max mem: 337
Epoch: [33]  [100/269]  eta: 0:00:03  lr: 0.000030  bag_loss: 0.1962 (0.5285)  instance_loss: 1.1529 (1.2982)  time: 0.0154  data: 0.0012  max mem: 337
Epoch: [33]  [200/269]  eta: 0:00:01  lr: 0.000029  bag_loss: 0.2128 (0.4776)  instance_loss: 1.2023 (1.2865)  time: 0.0160  data: 0.0013  max mem: 337
Epoch: [33]  [268/269]  eta: 0:00:00  lr: 0.000028  bag_loss: 0.4000 (0.4968)  instance_loss: 1.2225 (1.2901)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [33] Total time: 0:00:04 (4.7450 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2112 (0.2112)  acc1: 100.0000 (100.0000)  time: 0.5902  data: 0.5829  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1747 (0.6267)  acc1: 100.0000 (70.0000)  time: 0.0075  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9543 s / it)
* Acc@1 70.000 loss 0.627 auroc 0.894 f1_score 0.359
Test  [  0/200]  eta: 0:01:55  loss: 0.9235 (0.9235)  acc1: 0.0000 (0.0000)  time: 0.5786  data: 0.5710  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1823 (0.6921)  acc1: 100.0000 (72.2772)  time: 0.0067  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2653 (0.6818)  acc1: 100.0000 (76.5000)  time: 0.0106  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.3630 s / it)
* Acc@1 76.500 loss 0.682 auroc 0.817 f1_score 0.521


Epoch: [34]  [  0/269]  eta: 0:02:39  lr: 0.000028  bag_loss: 0.9290 (0.9290)  instance_loss: 1.1614 (1.1614)  time: 0.5921  data: 0.5758  max mem: 337
Epoch: [34]  [100/269]  eta: 0:00:03  lr: 0.000027  bag_loss: 0.1732 (0.4550)  instance_loss: 1.2603 (1.2640)  time: 0.0131  data: 0.0011  max mem: 337
Epoch: [34]  [200/269]  eta: 0:00:01  lr: 0.000026  bag_loss: 0.1226 (0.4552)  instance_loss: 1.1442 (1.2976)  time: 0.0122  data: 0.0011  max mem: 337
Epoch: [34]  [268/269]  eta: 0:00:00  lr: 0.000025  bag_loss: 0.1897 (0.4655)  instance_loss: 1.2433 (1.2968)  time: 0.0143  data: 0.0011  max mem: 337
Epoch: [34] Total time: 0:00:04 (4.7262 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2379 (0.2379)  acc1: 100.0000 (100.0000)  time: 0.5882  data: 0.5812  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1411 (0.6679)  acc1: 100.0000 (70.0000)  time: 0.0074  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9409 s / it)
* Acc@1 70.000 loss 0.668 auroc 0.888 f1_score 0.359
Test  [  0/200]  eta: 0:01:56  loss: 1.2612 (1.2612)  acc1: 0.0000 (0.0000)  time: 0.5832  data: 0.5749  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1689 (0.7182)  acc1: 100.0000 (67.3267)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2309 (0.6819)  acc1: 100.0000 (75.0000)  time: 0.0110  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.3411 s / it)
* Acc@1 75.000 loss 0.682 auroc 0.810 f1_score 0.498


Epoch: [35]  [  0/269]  eta: 0:02:32  lr: 0.000025  bag_loss: 0.1974 (0.1974)  instance_loss: 1.2809 (1.2809)  time: 0.5680  data: 0.5548  max mem: 337
Epoch: [35]  [100/269]  eta: 0:00:03  lr: 0.000024  bag_loss: 0.2353 (0.5309)  instance_loss: 1.3292 (1.3247)  time: 0.0152  data: 0.0013  max mem: 337
Epoch: [35]  [200/269]  eta: 0:00:01  lr: 0.000023  bag_loss: 0.3283 (0.5060)  instance_loss: 1.2430 (1.2938)  time: 0.0153  data: 0.0012  max mem: 337
Epoch: [35]  [268/269]  eta: 0:00:00  lr: 0.000022  bag_loss: 0.0790 (0.4748)  instance_loss: 1.3525 (1.3017)  time: 0.0160  data: 0.0013  max mem: 337
Epoch: [35] Total time: 0:00:04 (4.6439 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.1951 (0.1951)  acc1: 100.0000 (100.0000)  time: 0.5973  data: 0.5902  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1515 (0.6712)  acc1: 100.0000 (70.0000)  time: 0.0071  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9640 s / it)
* Acc@1 70.000 loss 0.671 auroc 0.899 f1_score 0.359
Test  [  0/200]  eta: 0:01:56  loss: 1.4548 (1.4548)  acc1: 0.0000 (0.0000)  time: 0.5849  data: 0.5760  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1747 (0.7170)  acc1: 100.0000 (69.3069)  time: 0.0067  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2627 (0.6746)  acc1: 100.0000 (75.5000)  time: 0.0101  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.3319 s / it)
* Acc@1 75.500 loss 0.675 auroc 0.809 f1_score 0.536


Epoch: [36]  [  0/269]  eta: 0:02:41  lr: 0.000022  bag_loss: 0.0998 (0.0998)  instance_loss: 1.4061 (1.4061)  time: 0.5996  data: 0.5807  max mem: 337
Epoch: [36]  [100/269]  eta: 0:00:03  lr: 0.000021  bag_loss: 0.3585 (0.4956)  instance_loss: 1.3816 (1.3296)  time: 0.0158  data: 0.0011  max mem: 337
Epoch: [36]  [200/269]  eta: 0:00:01  lr: 0.000020  bag_loss: 0.1148 (0.4314)  instance_loss: 1.1406 (1.3198)  time: 0.0134  data: 0.0012  max mem: 337
Epoch: [36]  [268/269]  eta: 0:00:00  lr: 0.000019  bag_loss: 0.5581 (0.4592)  instance_loss: 1.1386 (1.3080)  time: 0.0151  data: 0.0011  max mem: 337
Epoch: [36] Total time: 0:00:04 (4.6808 s / it)
Val  [ 0/30]  eta: 0:00:18  loss: 0.2295 (0.2295)  acc1: 100.0000 (100.0000)  time: 0.6001  data: 0.5918  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1596 (0.7305)  acc1: 100.0000 (70.0000)  time: 0.0075  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9632 s / it)
* Acc@1 70.000 loss 0.731 auroc 0.876 f1_score 0.359
Test  [  0/200]  eta: 0:01:53  loss: 2.0108 (2.0108)  acc1: 0.0000 (0.0000)  time: 0.5672  data: 0.5571  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1761 (0.7698)  acc1: 100.0000 (65.3465)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2643 (0.6981)  acc1: 100.0000 (74.0000)  time: 0.0113  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.3012 s / it)
* Acc@1 74.000 loss 0.698 auroc 0.800 f1_score 0.493


Epoch: [37]  [  0/269]  eta: 0:02:41  lr: 0.000019  bag_loss: 0.0465 (0.0465)  instance_loss: 1.5677 (1.5677)  time: 0.6021  data: 0.5780  max mem: 337
Epoch: [37]  [100/269]  eta: 0:00:03  lr: 0.000018  bag_loss: 0.2408 (0.4020)  instance_loss: 1.2103 (1.3043)  time: 0.0164  data: 0.0014  max mem: 337
Epoch: [37]  [200/269]  eta: 0:00:01  lr: 0.000017  bag_loss: 0.2833 (0.4321)  instance_loss: 1.0965 (1.2904)  time: 0.0150  data: 0.0011  max mem: 337
Epoch: [37]  [268/269]  eta: 0:00:00  lr: 0.000017  bag_loss: 0.2270 (0.4430)  instance_loss: 1.1395 (1.2875)  time: 0.0145  data: 0.0012  max mem: 337
Epoch: [37] Total time: 0:00:04 (4.8372 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2222 (0.2222)  acc1: 100.0000 (100.0000)  time: 0.5916  data: 0.5774  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1441 (0.6801)  acc1: 100.0000 (70.0000)  time: 0.0069  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9481 s / it)
* Acc@1 70.000 loss 0.680 auroc 0.895 f1_score 0.359
Test  [  0/200]  eta: 0:01:57  loss: 1.6278 (1.6278)  acc1: 0.0000 (0.0000)  time: 0.5892  data: 0.5807  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1823 (0.7037)  acc1: 100.0000 (72.2772)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2539 (0.6577)  acc1: 100.0000 (77.5000)  time: 0.0104  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.3077 s / it)
* Acc@1 77.500 loss 0.658 auroc 0.813 f1_score 0.536


Epoch: [38]  [  0/269]  eta: 0:02:40  lr: 0.000017  bag_loss: 2.4305 (2.4305)  instance_loss: 1.0473 (1.0473)  time: 0.5949  data: 0.5811  max mem: 337
Epoch: [38]  [100/269]  eta: 0:00:03  lr: 0.000016  bag_loss: 0.2256 (0.4967)  instance_loss: 1.3491 (1.2918)  time: 0.0172  data: 0.0012  max mem: 337
Epoch: [38]  [200/269]  eta: 0:00:01  lr: 0.000015  bag_loss: 0.2418 (0.4385)  instance_loss: 1.3906 (1.3157)  time: 0.0146  data: 0.0011  max mem: 337
Epoch: [38]  [268/269]  eta: 0:00:00  lr: 0.000014  bag_loss: 0.0890 (0.4527)  instance_loss: 1.3371 (1.3265)  time: 0.0156  data: 0.0012  max mem: 337
Epoch: [38] Total time: 0:00:04 (4.7422 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2162 (0.2162)  acc1: 100.0000 (100.0000)  time: 0.5795  data: 0.5729  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1463 (0.6807)  acc1: 100.0000 (70.0000)  time: 0.0079  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9435 s / it)
* Acc@1 70.000 loss 0.681 auroc 0.894 f1_score 0.359
Test  [  0/200]  eta: 0:02:00  loss: 1.5378 (1.5378)  acc1: 0.0000 (0.0000)  time: 0.6045  data: 0.5920  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1735 (0.7076)  acc1: 100.0000 (72.2772)  time: 0.0063  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2378 (0.6569)  acc1: 100.0000 (77.5000)  time: 0.0108  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2656 s / it)
* Acc@1 77.500 loss 0.657 auroc 0.813 f1_score 0.536


Epoch: [39]  [  0/269]  eta: 0:02:37  lr: 0.000014  bag_loss: 0.3696 (0.3696)  instance_loss: 0.9290 (0.9290)  time: 0.5867  data: 0.5681  max mem: 337
Epoch: [39]  [100/269]  eta: 0:00:03  lr: 0.000013  bag_loss: 0.1368 (0.3975)  instance_loss: 1.3140 (1.3431)  time: 0.0196  data: 0.0012  max mem: 337
Epoch: [39]  [200/269]  eta: 0:00:01  lr: 0.000012  bag_loss: 0.2907 (0.4574)  instance_loss: 1.2019 (1.3268)  time: 0.0135  data: 0.0010  max mem: 337
Epoch: [39]  [268/269]  eta: 0:00:00  lr: 0.000012  bag_loss: 0.1381 (0.4522)  instance_loss: 1.1244 (1.3211)  time: 0.0143  data: 0.0011  max mem: 337
Epoch: [39] Total time: 0:00:04 (4.5371 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2145 (0.2145)  acc1: 100.0000 (100.0000)  time: 0.5773  data: 0.5700  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1702 (0.7037)  acc1: 100.0000 (73.3333)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9344 s / it)
* Acc@1 73.333 loss 0.704 auroc 0.886 f1_score 0.448
Test  [  0/200]  eta: 0:01:53  loss: 1.6634 (1.6634)  acc1: 0.0000 (0.0000)  time: 0.5650  data: 0.5566  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2080 (0.7164)  acc1: 100.0000 (71.2871)  time: 0.0074  data: 0.0012  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2638 (0.6615)  acc1: 100.0000 (77.5000)  time: 0.0115  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.3206 s / it)
* Acc@1 77.500 loss 0.662 auroc 0.812 f1_score 0.551


Epoch: [40]  [  0/269]  eta: 0:02:34  lr: 0.000012  bag_loss: 0.2259 (0.2259)  instance_loss: 1.2277 (1.2277)  time: 0.5734  data: 0.5600  max mem: 337
Epoch: [40]  [100/269]  eta: 0:00:03  lr: 0.000011  bag_loss: 0.2141 (0.4386)  instance_loss: 1.3858 (1.3415)  time: 0.0135  data: 0.0011  max mem: 337
Epoch: [40]  [200/269]  eta: 0:00:01  lr: 0.000010  bag_loss: 0.2437 (0.4779)  instance_loss: 1.0707 (1.3349)  time: 0.0147  data: 0.0010  max mem: 337
Epoch: [40]  [268/269]  eta: 0:00:00  lr: 0.000010  bag_loss: 0.1144 (0.4487)  instance_loss: 1.3480 (1.3208)  time: 0.0160  data: 0.0013  max mem: 337
Epoch: [40] Total time: 0:00:04 (4.7048 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2160 (0.2160)  acc1: 100.0000 (100.0000)  time: 0.5789  data: 0.5716  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1707 (0.6690)  acc1: 100.0000 (70.0000)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9441 s / it)
* Acc@1 70.000 loss 0.669 auroc 0.896 f1_score 0.359
Test  [  0/200]  eta: 0:01:53  loss: 1.1534 (1.1534)  acc1: 0.0000 (0.0000)  time: 0.5681  data: 0.5600  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1789 (0.7575)  acc1: 100.0000 (66.3366)  time: 0.0068  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2728 (0.7058)  acc1: 100.0000 (74.0000)  time: 0.0110  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.3348 s / it)
* Acc@1 74.000 loss 0.706 auroc 0.798 f1_score 0.492


Epoch: [41]  [  0/269]  eta: 0:02:37  lr: 0.000010  bag_loss: 0.0240 (0.0240)  instance_loss: 1.4808 (1.4808)  time: 0.5869  data: 0.5667  max mem: 337
Epoch: [41]  [100/269]  eta: 0:00:03  lr: 0.000009  bag_loss: 0.1131 (0.3874)  instance_loss: 1.2485 (1.3316)  time: 0.0149  data: 0.0011  max mem: 337
Epoch: [41]  [200/269]  eta: 0:00:01  lr: 0.000008  bag_loss: 0.1543 (0.4533)  instance_loss: 1.3143 (1.3113)  time: 0.0159  data: 0.0012  max mem: 337
Epoch: [41]  [268/269]  eta: 0:00:00  lr: 0.000008  bag_loss: 0.1819 (0.4327)  instance_loss: 1.2231 (1.2925)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [41] Total time: 0:00:04 (4.6492 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2150 (0.2150)  acc1: 100.0000 (100.0000)  time: 0.5774  data: 0.5698  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1639 (0.6902)  acc1: 100.0000 (70.0000)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9390 s / it)
* Acc@1 70.000 loss 0.690 auroc 0.894 f1_score 0.359
Test  [  0/200]  eta: 0:01:55  loss: 1.4264 (1.4264)  acc1: 0.0000 (0.0000)  time: 0.5784  data: 0.5684  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1815 (0.7372)  acc1: 100.0000 (67.3267)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2682 (0.6815)  acc1: 100.0000 (74.5000)  time: 0.0099  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2742 s / it)
* Acc@1 74.500 loss 0.681 auroc 0.805 f1_score 0.494


Epoch: [42]  [  0/269]  eta: 0:02:36  lr: 0.000008  bag_loss: 0.0145 (0.0145)  instance_loss: 1.6528 (1.6528)  time: 0.5826  data: 0.5637  max mem: 337
Epoch: [42]  [100/269]  eta: 0:00:03  lr: 0.000007  bag_loss: 0.1085 (0.3965)  instance_loss: 1.3544 (1.3015)  time: 0.0149  data: 0.0011  max mem: 337
Epoch: [42]  [200/269]  eta: 0:00:01  lr: 0.000006  bag_loss: 0.1498 (0.4331)  instance_loss: 1.2766 (1.2965)  time: 0.0139  data: 0.0013  max mem: 337
Epoch: [42]  [268/269]  eta: 0:00:00  lr: 0.000006  bag_loss: 0.1600 (0.4357)  instance_loss: 1.2259 (1.2997)  time: 0.0161  data: 0.0012  max mem: 337
Epoch: [42] Total time: 0:00:04 (4.6784 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2147 (0.2147)  acc1: 100.0000 (100.0000)  time: 0.5919  data: 0.5848  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1505 (0.6882)  acc1: 100.0000 (70.0000)  time: 0.0072  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9549 s / it)
* Acc@1 70.000 loss 0.688 auroc 0.897 f1_score 0.359
Test  [  0/200]  eta: 0:02:00  loss: 1.4663 (1.4663)  acc1: 0.0000 (0.0000)  time: 0.6048  data: 0.5949  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1821 (0.7329)  acc1: 100.0000 (67.3267)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2610 (0.6746)  acc1: 100.0000 (75.0000)  time: 0.0109  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.3472 s / it)
* Acc@1 75.000 loss 0.675 auroc 0.807 f1_score 0.499


Epoch: [43]  [  0/269]  eta: 0:02:34  lr: 0.000006  bag_loss: 0.2501 (0.2501)  instance_loss: 0.7337 (0.7337)  time: 0.5745  data: 0.5522  max mem: 337
Epoch: [43]  [100/269]  eta: 0:00:03  lr: 0.000005  bag_loss: 0.3006 (0.5222)  instance_loss: 1.1682 (1.3155)  time: 0.0183  data: 0.0013  max mem: 337
Epoch: [43]  [200/269]  eta: 0:00:01  lr: 0.000005  bag_loss: 0.1459 (0.4630)  instance_loss: 1.2943 (1.3003)  time: 0.0158  data: 0.0011  max mem: 337
Epoch: [43]  [268/269]  eta: 0:00:00  lr: 0.000004  bag_loss: 0.1435 (0.4385)  instance_loss: 1.3663 (1.3125)  time: 0.0141  data: 0.0011  max mem: 337
Epoch: [43] Total time: 0:00:04 (4.7335 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2045 (0.2045)  acc1: 100.0000 (100.0000)  time: 0.5980  data: 0.5911  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1483 (0.6852)  acc1: 100.0000 (70.0000)  time: 0.0079  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9845 s / it)
* Acc@1 70.000 loss 0.685 auroc 0.899 f1_score 0.359
Test  [  0/200]  eta: 0:01:53  loss: 1.4436 (1.4436)  acc1: 0.0000 (0.0000)  time: 0.5688  data: 0.5595  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1949 (0.7237)  acc1: 100.0000 (70.2970)  time: 0.0065  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2606 (0.6708)  acc1: 100.0000 (76.5000)  time: 0.0109  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2832 s / it)
* Acc@1 76.500 loss 0.671 auroc 0.809 f1_score 0.542


Epoch: [44]  [  0/269]  eta: 0:02:41  lr: 0.000004  bag_loss: 0.1517 (0.1517)  instance_loss: 1.0493 (1.0493)  time: 0.5987  data: 0.5829  max mem: 337
Epoch: [44]  [100/269]  eta: 0:00:03  lr: 0.000004  bag_loss: 0.1573 (0.4502)  instance_loss: 1.1765 (1.3210)  time: 0.0129  data: 0.0010  max mem: 337
Epoch: [44]  [200/269]  eta: 0:00:01  lr: 0.000003  bag_loss: 0.1600 (0.4118)  instance_loss: 1.3105 (1.3417)  time: 0.0163  data: 0.0013  max mem: 337
Epoch: [44]  [268/269]  eta: 0:00:00  lr: 0.000003  bag_loss: 0.2171 (0.4257)  instance_loss: 1.1182 (1.3261)  time: 0.0164  data: 0.0012  max mem: 337
Epoch: [44] Total time: 0:00:04 (4.7228 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2061 (0.2061)  acc1: 100.0000 (100.0000)  time: 0.5923  data: 0.5740  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1469 (0.6830)  acc1: 100.0000 (73.3333)  time: 0.0069  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9444 s / it)
* Acc@1 73.333 loss 0.683 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:56  loss: 1.4532 (1.4532)  acc1: 0.0000 (0.0000)  time: 0.5837  data: 0.5750  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.1996 (0.7187)  acc1: 100.0000 (71.2871)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2608 (0.6674)  acc1: 100.0000 (77.0000)  time: 0.0106  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2917 s / it)
* Acc@1 77.000 loss 0.667 auroc 0.811 f1_score 0.545


Epoch: [45]  [  0/269]  eta: 0:02:38  lr: 0.000003  bag_loss: 0.2656 (0.2656)  instance_loss: 1.3134 (1.3134)  time: 0.5881  data: 0.5760  max mem: 337
Epoch: [45]  [100/269]  eta: 0:00:03  lr: 0.000003  bag_loss: 0.1488 (0.3767)  instance_loss: 1.2380 (1.2633)  time: 0.0152  data: 0.0011  max mem: 337
Epoch: [45]  [200/269]  eta: 0:00:01  lr: 0.000002  bag_loss: 0.1509 (0.4424)  instance_loss: 1.2588 (1.2933)  time: 0.0142  data: 0.0011  max mem: 337
Epoch: [45]  [268/269]  eta: 0:00:00  lr: 0.000002  bag_loss: 0.0975 (0.4125)  instance_loss: 1.3224 (1.3105)  time: 0.0150  data: 0.0011  max mem: 337
Epoch: [45] Total time: 0:00:04 (4.6818 s / it)
Val  [ 0/30]  eta: 0:00:16  loss: 0.2090 (0.2090)  acc1: 100.0000 (100.0000)  time: 0.5663  data: 0.5564  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1523 (0.6842)  acc1: 100.0000 (73.3333)  time: 0.0090  data: 0.0011  max mem: 337
Val Total time: 0:00:00 (0.9835 s / it)
* Acc@1 73.333 loss 0.684 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:57  loss: 1.4715 (1.4715)  acc1: 0.0000 (0.0000)  time: 0.5859  data: 0.5747  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2078 (0.7219)  acc1: 100.0000 (69.3069)  time: 0.0066  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2691 (0.6715)  acc1: 100.0000 (75.5000)  time: 0.0115  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.3603 s / it)
* Acc@1 75.500 loss 0.671 auroc 0.810 f1_score 0.536


Epoch: [46]  [  0/269]  eta: 0:02:38  lr: 0.000002  bag_loss: 0.0517 (0.0517)  instance_loss: 1.0823 (1.0823)  time: 0.5879  data: 0.5728  max mem: 337
Epoch: [46]  [100/269]  eta: 0:00:03  lr: 0.000002  bag_loss: 0.1355 (0.4732)  instance_loss: 1.1982 (1.2493)  time: 0.0166  data: 0.0011  max mem: 337
Epoch: [46]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.2359 (0.4457)  instance_loss: 1.2912 (1.2964)  time: 0.0122  data: 0.0012  max mem: 337
Epoch: [46]  [268/269]  eta: 0:00:00  lr: 0.000001  bag_loss: 0.1110 (0.4303)  instance_loss: 1.2705 (1.3139)  time: 0.0192  data: 0.0012  max mem: 337
Epoch: [46] Total time: 0:00:04 (4.7272 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2062 (0.2062)  acc1: 100.0000 (100.0000)  time: 0.5787  data: 0.5706  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1489 (0.6826)  acc1: 100.0000 (73.3333)  time: 0.0074  data: 0.0009  max mem: 337
Val Total time: 0:00:00 (0.9476 s / it)
* Acc@1 73.333 loss 0.683 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:56  loss: 1.4663 (1.4663)  acc1: 0.0000 (0.0000)  time: 0.5817  data: 0.5723  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2074 (0.7215)  acc1: 100.0000 (69.3069)  time: 0.0075  data: 0.0013  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2684 (0.6718)  acc1: 100.0000 (75.5000)  time: 0.0111  data: 0.0012  max mem: 337
Test Total time: 0:00:02 (2.3617 s / it)
* Acc@1 75.500 loss 0.672 auroc 0.810 f1_score 0.536


Epoch: [47]  [  0/269]  eta: 0:02:42  lr: 0.000001  bag_loss: 1.7941 (1.7941)  instance_loss: 1.3075 (1.3075)  time: 0.6029  data: 0.5848  max mem: 337
Epoch: [47]  [100/269]  eta: 0:00:03  lr: 0.000001  bag_loss: 0.2190 (0.3861)  instance_loss: 1.4091 (1.3486)  time: 0.0167  data: 0.0012  max mem: 337
Epoch: [47]  [200/269]  eta: 0:00:01  lr: 0.000001  bag_loss: 0.0893 (0.4483)  instance_loss: 1.3301 (1.3083)  time: 0.0175  data: 0.0012  max mem: 337
Epoch: [47]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1122 (0.4155)  instance_loss: 1.2300 (1.3144)  time: 0.0141  data: 0.0013  max mem: 337
Epoch: [47] Total time: 0:00:04 (4.7764 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2071 (0.2071)  acc1: 100.0000 (100.0000)  time: 0.5883  data: 0.5814  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1492 (0.6845)  acc1: 100.0000 (73.3333)  time: 0.0073  data: 0.0007  max mem: 337
Val Total time: 0:00:00 (0.9460 s / it)
* Acc@1 73.333 loss 0.685 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:52  loss: 1.4944 (1.4944)  acc1: 0.0000 (0.0000)  time: 0.5606  data: 0.5496  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2092 (0.7201)  acc1: 100.0000 (69.3069)  time: 0.0064  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2704 (0.6703)  acc1: 100.0000 (75.5000)  time: 0.0106  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.3038 s / it)
* Acc@1 75.500 loss 0.670 auroc 0.811 f1_score 0.535


Epoch: [48]  [  0/269]  eta: 0:02:44  lr: 0.000000  bag_loss: 2.3819 (2.3819)  instance_loss: 1.5253 (1.5253)  time: 0.6118  data: 0.5809  max mem: 337
Epoch: [48]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.2435 (0.5698)  instance_loss: 1.2281 (1.3153)  time: 0.0171  data: 0.0012  max mem: 337
Epoch: [48]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1969 (0.4801)  instance_loss: 1.2377 (1.3094)  time: 0.0168  data: 0.0013  max mem: 337
Epoch: [48]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1518 (0.4346)  instance_loss: 1.3294 (1.3219)  time: 0.0136  data: 0.0012  max mem: 337
Epoch: [48] Total time: 0:00:04 (4.7243 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2082 (0.2082)  acc1: 100.0000 (100.0000)  time: 0.5814  data: 0.5652  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1510 (0.6848)  acc1: 100.0000 (73.3333)  time: 0.0081  data: 0.0010  max mem: 337
Val Total time: 0:00:00 (0.9661 s / it)
* Acc@1 73.333 loss 0.685 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:55  loss: 1.4993 (1.4993)  acc1: 0.0000 (0.0000)  time: 0.5777  data: 0.5697  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2114 (0.7201)  acc1: 100.0000 (68.3168)  time: 0.0064  data: 0.0010  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2727 (0.6708)  acc1: 100.0000 (75.0000)  time: 0.0107  data: 0.0011  max mem: 337
Test Total time: 0:00:02 (2.2778 s / it)
* Acc@1 75.000 loss 0.671 auroc 0.811 f1_score 0.532


Epoch: [49]  [  0/269]  eta: 0:02:38  lr: 0.000000  bag_loss: 0.0196 (0.0196)  instance_loss: 1.9728 (1.9728)  time: 0.5897  data: 0.5714  max mem: 337
Epoch: [49]  [100/269]  eta: 0:00:03  lr: 0.000000  bag_loss: 0.1551 (0.4031)  instance_loss: 1.2469 (1.3134)  time: 0.0141  data: 0.0011  max mem: 337
Epoch: [49]  [200/269]  eta: 0:00:01  lr: 0.000000  bag_loss: 0.1426 (0.4345)  instance_loss: 1.2942 (1.3131)  time: 0.0125  data: 0.0012  max mem: 337
Epoch: [49]  [268/269]  eta: 0:00:00  lr: 0.000000  bag_loss: 0.1584 (0.4265)  instance_loss: 1.2583 (1.3098)  time: 0.0170  data: 0.0014  max mem: 337
Epoch: [49] Total time: 0:00:04 (4.6869 s / it)
Val  [ 0/30]  eta: 0:00:17  loss: 0.2082 (0.2082)  acc1: 100.0000 (100.0000)  time: 0.5905  data: 0.5793  max mem: 337
Val  [29/30]  eta: 0:00:00  loss: 0.1510 (0.6850)  acc1: 100.0000 (73.3333)  time: 0.0076  data: 0.0008  max mem: 337
Val Total time: 0:00:00 (0.9633 s / it)
* Acc@1 73.333 loss 0.685 auroc 0.899 f1_score 0.448
Test  [  0/200]  eta: 0:01:58  loss: 1.5006 (1.5006)  acc1: 0.0000 (0.0000)  time: 0.5935  data: 0.5852  max mem: 337
Test  [100/200]  eta: 0:00:01  loss: 0.2114 (0.7202)  acc1: 100.0000 (68.3168)  time: 0.0070  data: 0.0011  max mem: 337
Test  [199/200]  eta: 0:00:00  loss: 0.2727 (0.6709)  acc1: 100.0000 (75.0000)  time: 0.0100  data: 0.0010  max mem: 337
Test Total time: 0:00:02 (2.2983 s / it)
* Acc@1 75.000 loss 0.671 auroc 0.810 f1_score 0.532


Results on best epoch:
{'epoch': 44, 'val_acc': 73.33333333333333, 'val_auc': 0.8986614346504211, 'val_f1': 0.4476190507411957, 'test_acc': 77.0, 'test_auc': 0.8111384510993958, 'test_f1': 0.5447450876235962}
